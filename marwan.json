{
  "main_code": "IyBlbmNvZGluZzogVVRGLTgKcmVxdWlyZSAnc2tldGNodXAucmInCnJlcXVpcmUgJ25ldC9odHRwJwpyZXF1aXJlICd1cmknCnJlcXVpcmUgJ2pzb24nCnJlcXVpcmUgJ3NlY3VyZXJhbmRvbScKcmVxdWlyZSAnb3Blbi11cmknCnJlcXVpcmUgJ3RtcGRpcicKcmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICd0ZW1wZmlsZScKcmVxdWlyZSAnZGlnZXN0JwpyZXF1aXJlICdmaWxldXRpbHMnCnJlcXVpcmUgJ3psaWInICMKCm1vZHVsZSBNSERFU0lHTgogIFBMVUdJTl9OQU1FID0gIk1IREVTSUdOIgogICMg2LHYp9io2LcgR2l0SHViINmE2YTYqtit2YLZggogIEdJVEhVQl9BQ0NPVU5UU19VUkwgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL21hcndhbmFkZWxlbHRhaGFuLXN1ZG8vQVBJMTIzL3JlZnMvaGVhZHMvbWFpbi9lbWFpbC5qc29uIgogIAogIE9QRU5fVElNRU9VVCA9IDgKICBSRUFEX1RJTUVPVVQgPSAxMgoKICAjIOKckyBGSVggMTogZXZhbCBfX0ZJTEVfXyA9IChldmFsKSA9PiBGaWxlLmRpcm5hbWUoX19GSUxFX18pINin2LXZhNin2K0KICAjINit2YHYuCBQTFVHSU5fRElSINmF2LPYp9ixIG1haW4ucmIg2KfZhNmF2YTZgQogIFBMVUdJTl9ESVIgPQogICAgYmVnaW4KICAgICAgaWYgT2JqZWN0LmNvbnN0X2RlZmluZWQ/KDpQTFVHSU5fRElSKSAmJiA6OlBMVUdJTl9ESVIgJiYgITo6UExVR0lOX0RJUi50b19zLnN0cmlwLmVtcHR5PwogICAgICAgIDo6UExVR0lOX0RJUgogICAgICBlbHNlCiAgICAgICAgRmlsZS5leHBhbmRfcGF0aChGaWxlLmRpcm5hbWUoX19GSUxFX18pKQogICAgICBlbmQKICAgIHJlc2N1ZQogICAgICBuaWwKICAgIGVuZAoKICBDT01QT05FTlRTID0gYmVnaW4KICAgIHVybCA9ICJodHRwczovL21haG1vdWRkZXNpZ24uY29tL1NLRVRDSFVQL2NvbXBvbmVudHMtVjQuanNvbiIKICAgIGpzb25fcmF3ID0gVVJJLm9wZW4odXJsKS5yZWFkCiAgICBqc29uX2RhdGEgPSBKU09OLnBhcnNlKGpzb25fcmF3KQogICAgZGVjb2RlZF9qc29uID0gQmFzZTY0LmRlY29kZTY0KGpzb25fZGF0YVsiZGF0YSJdKQogICAgSlNPTi5wYXJzZShkZWNvZGVkX2pzb24sIHN5bWJvbGl6ZV9uYW1lczogdHJ1ZSkKICByZXNjdWUgPT4gZQogICAgVUkubWVzc2FnZWJveCgi4pqgINiu2LfYoyDZgdmKINiq2K3ZhdmK2YQg2KfZhNmF2YPYqtio2Kk6ICN7ZS5tZXNzYWdlfSIpCiAgICBbXQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g2KzZhNioINin2YTYrdiz2KfYqNin2Kog2YXZhiBHaXRIdWIgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLmZldGNoX2FjY291bnRzX2Zyb21fZ2l0aHViCiAgICBiZWdpbgogICAgICB1cmkgPSBVUkkucGFyc2UoR0lUSFVCX0FDQ09VTlRTX1VSTCkKICAgICAgcmVzcG9uc2UgPSBOZXQ6OkhUVFAuZ2V0X3Jlc3BvbnNlKHVyaSkKICAgICAgCiAgICAgIGlmIHJlc3BvbnNlLmNvZGUudG9faSA9PSAyMDAKICAgICAgICBhY2NvdW50cyA9IEpTT04ucGFyc2UocmVzcG9uc2UuYm9keSkKICAgICAgICByZXR1cm4gYWNjb3VudHMgaWYgYWNjb3VudHMuaXNfYT8oQXJyYXkpCiAgICAgIGVuZAogICAgcmVzY3VlID0+IGUKICAgICAgcHV0cyAiRXJyb3IgZmV0Y2hpbmcgYWNjb3VudHMgZnJvbSBHaXRIdWI6ICN7ZS5tZXNzYWdlfSIKICAgIGVuZAogICAgW10KICBlbmQKCiAgZGVmIHNlbGYudmFsaWRhdGVfd2l0aF9naXRodWIoZW1haWwsIGxpY2Vuc2UpCiAgICAjINis2YTYqCDYp9mE2K3Ys9in2KjYp9iqINmF2YYgR2l0SHViCiAgICBhY2NvdW50cyA9IGZldGNoX2FjY291bnRzX2Zyb21fZ2l0aHViCiAgICAKICAgICMg2KfZhNio2K3YqyDYudmGINin2YTYqNix2YrYryDZiNin2YTYsdmC2YUg2KfZhNiz2LHZigogICAgYWNjb3VudCA9IGFjY291bnRzLmZpbmQgZG8gfGFjY3wKICAgICAgYWNjWydlbWFpbCddLnRvX3MuZG93bmNhc2UgPT0gZW1haWwudG9fcy5kb3duY2FzZSAmJiAKICAgICAgYWNjWydwYXNzd29yZCddID09IGxpY2Vuc2UKICAgIGVuZAogICAgCiAgICBpZiBhY2NvdW50CiAgICAgICMg2K3Zgdi4INil2LbYp9mB2Yog2YTYqNmK2KfZhtin2Kog2KfZhNit2LPYp9ioICjYp9iu2KrZitin2LHZiikKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImdpdGh1Yl92YWxpZGF0ZWQiLCB0cnVlKQogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGFzdF92YWxpZGF0aW9uIiwgVGltZS5ub3cudG9faSkKICAgICAgCiAgICAgIHJldHVybiB7CiAgICAgICAgJ3ZhbGlkJyA9PiB0cnVlLAogICAgICAgICdzdGF0dXMnID0+ICdhY3RpdmUnLAogICAgICAgICdzb3VyY2UnID0+ICdnaXRodWInCiAgICAgIH0KICAgIGVuZAogICAgCiAgICByZXR1cm4geyAndmFsaWQnID0+IGZhbHNlLCAncmVhc29uJyA9PiAnaW52YWxpZF9jcmVkZW50aWFscycgfQogIGVuZAoKICBkZWYgc2VsZi5nZXRfZGV2aWNlX2lkCiAgICBwcmVmcyA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImRldmljZV9pZCIpCiAgICByZXR1cm4gcHJlZnMgdW5sZXNzIHByZWZzLm5pbD8gfHwgcHJlZnMuZW1wdHk/CiAgICBpZCA9IFNlY3VyZVJhbmRvbS51dWlkCiAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZGV2aWNlX2lkIiwgaWQpCiAgICBpZAogIGVuZAoKICBkZWYgc2VsZi5odW1hbml6ZV9zZWNvbmRzKHRvdGFsKQogICAgdG90YWwgPSB0b3RhbC50b19pCiAgICBtLCBzID0gdG90YWwuZGl2bW9kKDYwKQogICAgaCwgbSA9IG0uZGl2bW9kKDYwKQogICAgcGFydHMgPSBbXQogICAgcGFydHMgPDwgIiN7aH0g2LPYp9i52KkiICAgaWYgaCA+IDAKICAgIHBhcnRzIDw8ICIje219INiv2YLZitmC2KkiICBpZiBtID4gMAogICAgcGFydHMgPDwgIiN7c30g2KvYp9mG2YrYqSIgIGlmIHMgPiAwIHx8IHBhcnRzLmVtcHR5PwogICAgcGFydHMuam9pbignINmIICcpCiAgZW5kCgogICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBBUEkgQWN0aXZhdGUgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICBkZWYgc2VsZi5hY3RpdmF0ZShmb3JjZV9wcm9tcHQgPSB0cnVlKQogICAgZW1haWwgICA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImVtYWlsIikgICB8fCAiIgogICAgbGljZW5zZSA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiKSB8fCAiIgoKICAgIGlmIGZvcmNlX3Byb21wdCB8fCBlbWFpbC5lbXB0eT8gfHwgbGljZW5zZS5lbXB0eT8KICAgICAgaW5wdXQgPSBVSS5pbnB1dGJveChbItij2K/YrtmEINin2YTYqNix2YrYryDYp9mE2KXZhNmD2KrYsdmI2YbZiiIsICLYo9iv2K7ZhCDZhdmB2KrYp9itINin2YTYqtix2K7Ziti1Il0sIFtlbWFpbCwgbGljZW5zZV0sICLYqtmB2LnZitmEIE1IREVTSUdOIikKICAgICAgcmV0dXJuIGZhbHNlIHVubGVzcyBpbnB1dAogICAgICBlbWFpbCwgbGljZW5zZSA9IGlucHV0CiAgICBlbmQKCiAgICAjINin2YTYqtit2YLZgiDZhdmGIEdpdEh1YiDYo9mI2YTYp9mLCiAgICBnaXRodWJfcmVzdWx0ID0gdmFsaWRhdGVfd2l0aF9naXRodWIoZW1haWwsIGxpY2Vuc2UpCiAgICAKICAgIGlmIGdpdGh1Yl9yZXN1bHRbJ3ZhbGlkJ10KICAgICAgIyDYrdmB2Lgg2KfZhNio2YrYp9mG2KfYqiDZhdit2YTZitin2YsKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImVtYWlsIiwgZW1haWwpCiAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJsaWNlbnNlIiwgbGljZW5zZSkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImFjdGl2YXRlZF9vbmNlIiwgdHJ1ZSkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImdpdGh1Yl9hY3RpdmF0ZWQiLCB0cnVlKQogICAgICAKICAgICAgVUkubWVzc2FnZWJveCgi4pyFINiq2YUg2KfZhNiq2YHYudmK2YQg2KjZhtis2KfYrSDYudio2LEgR2l0SHViIikgaWYgZm9yY2VfcHJvbXB0CiAgICAgIHJldHVybiB0cnVlCiAgICBlbmQKCiAgICAjINil2LDYpyDZgdi02YQg2KfZhNiq2K3ZgtmCINmF2YYgR2l0SHVi2Iwg2KzYsdioINin2YTYt9ix2YrZgtipINin2YTYo9i12YTZitipICjYp9iu2KrZitin2LHZiikKICAgIGJlZ2luCiAgICAgIGRldmljZSA9IGdldF9kZXZpY2VfaWQKICAgICAgdXJpICAgID0gVVJJLnBhcnNlKCJodHRwczovL21haG1vdWRkZXNpZ24uY29tL3dwLWpzb24vbWhkZXNpZ24vVjQvdmFsaWRhdGUiKQoKICAgICAgaHR0cCA9IE5ldDo6SFRUUC5uZXcodXJpLmhvc3QsIHVyaS5wb3J0KQogICAgICBodHRwLnVzZV9zc2wgICAgID0gKHVyaS5zY2hlbWUgPT0gJ2h0dHBzJykKICAgICAgaHR0cC5vcGVuX3RpbWVvdXQgPSBPUEVOX1RJTUVPVVQKICAgICAgaHR0cC5yZWFkX3RpbWVvdXQgPSBSRUFEX1RJTUVPVVQKCiAgICAgIHJlcSA9IE5ldDo6SFRUUDo6UG9zdC5uZXcodXJpLnJlcXVlc3RfdXJpKQogICAgICByZXFbJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgIHJlcVsnVXNlci1BZ2VudCddICAgID0gIlNrZXRjaFVwLyN7U2tldGNodXAudmVyc2lvbn0gUnVieS8je1JVQllfVkVSU0lPTn0gI3tQTFVHSU5fTkFNRX0iCiAgICAgIHJlcS5ib2R5ID0geyBlbWFpbDogZW1haWwsIGxpY2Vuc2U6IGxpY2Vuc2UsIGRldmljZV9pZDogZGV2aWNlIH0udG9fanNvbgoKICAgICAgcmVzICA9IGh0dHAucmVxdWVzdChyZXEpCiAgICAgIGNvZGUgPSByZXMuY29kZS50b19pCiAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlcy5ib2R5KSByZXNjdWUge30KCiAgICAgIGlmIGNvZGUgPT0gMjAwICYmIGRhdGFbJ3ZhbGlkJ10KICAgICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiLCAgICAgICAgICBlbWFpbCkKICAgICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGljZW5zZSIsICAgICAgICBsaWNlbnNlKQogICAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJhY3RpdmF0ZWRfb25jZSIsIHRydWUpCgogICAgICAgIGlmIGRhdGEua2V5PygnZW5kc19hdCcpICYmICFkYXRhWydlbmRzX2F0J10udG9fcy5zdHJpcC5lbXB0eT8KICAgICAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbmRzX2F0IiwgZGF0YVsnZW5kc19hdCddLnRvX3MpCiAgICAgICAgZW5kCgogICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINin2YTYqtmB2LnZitmEINio2YbYrNin2K0iKSBpZiBmb3JjZV9wcm9tcHQKICAgICAgICByZXR1cm4gdHJ1ZQogICAgICBlbmQKCiAgICAgIGlmIGNvZGUgPT0gNDI5IHx8IGRhdGFbJ3JlYXNvbiddID09ICdyYXRlX2xpbWl0ZWQnCiAgICAgICAgcmV0cnlfYWZ0ZXIgPSAocmVzWydSZXRyeS1BZnRlciddIHx8IGRhdGFbJ3JldHJ5X2FmdGVyJ10pLnRvX2kKICAgICAgICBtc2cgPSByZXRyeV9hZnRlciA+IDAgPyAi2KrZhSDYqtis2KfZiNiyINin2YTYrdivINin2YTZhdiz2YXZiNit2Iwg2YrYsdis2Ykg2KfZhNmF2K3Yp9mI2YTYqSDYqNi52K8gI3todW1hbml6ZV9zZWNvbmRzKHJldHJ5X2FmdGVyKX0uIiA6ICLYqtmFINiq2KzYp9mI2LIg2KfZhNit2K8g2KfZhNmF2LPZhdmI2K0uLi4iCiAgICAgICAgVUkubWVzc2FnZWJveChtc2cpIGlmIGZvcmNlX3Byb21wdAogICAgICAgIHJldHVybiBmYWxzZQogICAgICBlbmQKCiAgICAgIHJlYXNvbiA9IChkYXRhWydyZWFzb24nXSB8fCAnZGVuaWVkJykudG9fcwogICAgICBtc2cgPQogICAgICAgIGNhc2UgcmVhc29uCiAgICAgICAgd2hlbiAnbm90X3N0YXJ0ZWQnIHRoZW4gItin2YTYqtix2K7Ziti1INmE2YUg2YrYqNiv2KMg2KjYudivLlxuI3tkYXRhWydzdGFydHNfYXQnXX0iCiAgICAgICAgd2hlbiAnZXhwaXJlZCcgICAgIHRoZW4gItin2YbYqtmH2Kog2LXZhNin2K3ZitipINin2YTYqtix2K7Ziti1OlxuI3tkYXRhWydlbmRzX2F0J119XG7Zitix2KzZiSDYqtis2K/ZitivINin2YTYp9i02KrYsdin2YMuIgogICAgICAgIHdoZW4gJ21pc21hdGNoJyAgICB0aGVuICLYp9mE2KjZitin2YbYp9iqINi62YrYsSDZhdiq2LfYp9io2YLYqSAo2KjYsdmK2K8v2YXZgdiq2KfYrS/YrNmH2KfYsikuIgogICAgICAgIHdoZW4gJ2Rpc2FibGVkJyAgICB0aGVuICLYp9mE2KrYsdiu2YrYtSDZhdi52LfZhCDZhdmGINmC2KjZhCDYp9mE2YXYtNix2YEuIgogICAgICAgIHdoZW4gJ25vdF9mb3VuZCcgICB0aGVuICLZhNmFINmK2KrZhSDYp9mE2LnYq9mI2LEg2LnZhNmJINin2YTYqtix2K7Ziti1LiIKICAgICAgICBlbHNlICAgICAgICAgICAgICAgICAgICAgIuKaoCDYrdiv2Ksg2K7Yt9ijINij2KvZhtin2KEg2KfZhNiq2K3ZgtmCIC0gI3tkYXRhWydyZWFzb24nXSB8fCByZWFzb259IgogICAgICAgIGVuZAogICAgICBVSS5tZXNzYWdlYm94KG1zZykgaWYgZm9yY2VfcHJvbXB0CiAgICAgIGZhbHNlCgogICAgcmVzY3VlID0+IGUKICAgICAgaWYgU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiYWN0aXZhdGVkX29uY2UiKQogICAgICAgIHRydWUKICAgICAgZWxzZQogICAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDYrdiv2Ksg2K7Yt9ijINij2KvZhtin2KEg2KfZhNiq2YHYudmK2YQ6ICN7ZS5tZXNzYWdlfSIpIGlmIGZvcmNlX3Byb21wdAogICAgICAgIGZhbHNlCiAgICAgIGVuZAogICAgZW5kCiAgZW5kCgogICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBVc2VyIEluZm8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLnNob3dfdXNlcl9pbmZvCiAgICBlbWFpbCAgID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiKS50b19zCiAgICBsaWNlbnNlID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGljZW5zZSIpLnRvX3MKICAgIGVuZHNfYXQgPSBTa2V0Y2h1cC5yZWFkX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbmRzX2F0IikudG9fcwogICAgZ2l0aHViX2FjdGl2YXRlZCA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImdpdGh1Yl9hY3RpdmF0ZWQiKQoKICAgIGlmIGVtYWlsLmVtcHR5PyB8fCBsaWNlbnNlLmVtcHR5PwogICAgICBVSS5tZXNzYWdlYm94KCLinYwg2YTZhSDZitiq2YUg2KrZgdi52YrZhCDYp9mE2YXZg9iq2KjYqSDYqNi52K8uXG7Yp9mG2KrZgtmEINil2YTZiTogUGx1Z2lucyA+IE1IREVTSUdOIC0g2KrZgdi52YrZhCIpCiAgICAgIHJldHVybgogICAgZW5kCgogICAgZW5kc190eHQgPSBlbmRzX2F0LnN0cmlwLmVtcHR5PyA/ICLYqtmB2LnZitmEINiv2KfYptmFIiA6IGVuZHNfYXQKICAgIHNvdXJjZSA9IGdpdGh1Yl9hY3RpdmF0ZWQgPyAiR2l0SHViIiA6ICLYp9mE2LPZitix2YHYsSDYp9mE2KPYtdmE2YoiCgogICAgVUkubWVzc2FnZWJveCgKICAgICAgIvCfkaQg2YXYudmE2YjZhdin2Kog2KfZhNmF2LTYqtix2YMgKE1IREVTSUdOKVxuXG4iIFwKICAgICAgIvCfk6cg2KfZhNio2LHZitivINin2YTYpdmE2YPYqtix2YjZhtmKOlxuI3tlbWFpbH1cblxuIiBcCiAgICAgICLwn5SRINmF2YHYqtin2K0g2KfZhNiq2LHYrtmK2LU6XG4je2xpY2Vuc2V9XG5cbiIgXAogICAgICAi4o+zINmK2YbYqtmH2Yog2KfZhNiq2YHYudmK2YQ6XG4je2VuZHNfdHh0fVxuXG4iIFwKICAgICAgIvCfjJAg2YXYtdiv2LEg2KfZhNiq2YHYudmK2YQ6XG4je3NvdXJjZX1cblxuIiBcCiAgICAgICLwn5al77iPINix2YLZhSDYp9mE2KzZh9in2LI6XG4je2dldF9kZXZpY2VfaWR9IgogICAgKQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQ2FjaGUgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLmNsZWFyX2NhY2hlCiAgICBjYWNoZV9kaXIgPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZGVzaWduX2NhY2hlXzEiKQogICAgRmlsZVV0aWxzLnJtX3JmKGNhY2hlX2RpcikgaWYgRmlsZS5kaXJlY3Rvcnk/KGNhY2hlX2RpcikKICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINmF2LPYrSDYsNin2YPYsdipINin2YTYqtiu2LLZitmGINin2YTZhdik2YLYqi4iKQogIHJlc2N1ZSA9PiBlCiAgICBVSS5tZXNzYWdlYm94KCLimqAg2K3Yr9irINiu2LfYoyDYo9ir2YbYp9ihINmF2LPYrSDYp9mE2KrYrtiy2YrZhiDYp9mE2YXYpNmC2Ko6ICN7ZS5tZXNzYWdlfSIpCiAgZW5kCgogICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBEeW5hbWljIGhlbHBlcnMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLmR5bmFtaWM/KGluc3RhbmNlKQogICAgcmV0dXJuIGZhbHNlIHVubGVzcyBpbnN0YW5jZS5pc19hPyhTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCiAgICAhIWluc3RhbmNlLmF0dHJpYnV0ZV9kaWN0aW9uYXJ5KCJkeW5hbWljX2F0dHJpYnV0ZXMiLCBmYWxzZSkKICByZXNjdWUKICAgIGZhbHNlCiAgZW5kCgogIGRlZiBzZWxmLnVud3JhcF90b19keW5hbWljIShpbnN0YW5jZSkKICAgIHJldHVybiBpbnN0YW5jZSBpZiBkeW5hbWljPyhpbnN0YW5jZSkKCiAgICBlbnRzID0gaW5zdGFuY2UuZGVmaW5pdGlvbi5lbnRpdGllcy50b19hCiAgICBjaGlsZHJlbiA9IGVudHMuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCiAgICBkeW5fY2hpbGRyZW4gPSBjaGlsZHJlbi5zZWxlY3Qge3xjfCBkeW5hbWljPyhjKSB9CiAgICByZXR1cm4gaW5zdGFuY2UgaWYgZHluX2NoaWxkcmVuLmVtcHR5PwoKICAgIG1vZGVsID0gU2tldGNodXAuYWN0aXZlX21vZGVsCiAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oIlVud3JhcCBEeW5hbWljIENvbXBvbmVudCIsIHRydWUpCiAgICBiZWdpbgogICAgICBwYXJlbnRfZW50cyA9IGluc3RhbmNlLnBhcmVudC5lbnRpdGllcwogICAgICBiZWZvcmVfaWRzID0gcGFyZW50X2VudHMudG9fYS5tYXAoJjplbnRpdHlJRCkKCiAgICAgIGluc3RhbmNlLmV4cGxvZGUKCiAgICAgIGFmdGVyID0gcGFyZW50X2VudHMudG9fYS5yZWplY3QgeyB8ZXwgYmVmb3JlX2lkcy5pbmNsdWRlPyhlLmVudGl0eUlEKSB9CiAgICAgIGFmdGVyX2luc3RzID0gYWZ0ZXIuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCgogICAgICBkeW4gPSBhZnRlcl9pbnN0cy5maW5kIHsgfHh8IGR5bmFtaWM/KHgpIH0gfHwgYWZ0ZXJfaW5zdHMuZmlyc3QKICAgICAgbW9kZWwuc2VsZWN0aW9uLmNsZWFyCiAgICAgIG1vZGVsLnNlbGVjdGlvbi5hZGQoZHluKSBpZiBkeW4KICAgICAgbW9kZWwuY29tbWl0X29wZXJhdGlvbgogICAgICBkeW4gfHwgaW5zdGFuY2UKICAgIHJlc2N1ZQogICAgICBtb2RlbC5hYm9ydF9vcGVyYXRpb24gcmVzY3VlIG5pbAogICAgICBpbnN0YW5jZQogICAgZW5kCiAgZW5kCgogIGNsYXNzIFBsYWNlQW5kVW53cmFwT2JzZXJ2ZXIgPCBTa2V0Y2h1cDo6RW50aXRpZXNPYnNlcnZlcgogICAgZGVmIGluaXRpYWxpemUodGFyZ2V0X2RlZikKICAgICAgQHRhcmdldF9kZWYgPSB0YXJnZXRfZGVmCiAgICAgIEBkb25lID0gZmFsc2UKICAgIGVuZAoKICAgIGRlZiBvbkVsZW1lbnRBZGRlZChlbnRpdGllcywgZW50aXR5KQogICAgICByZXR1cm4gaWYgQGRvbmUKICAgICAgcmV0dXJuIHVubGVzcyBlbnRpdHkuaXNfYT8oU2tldGNodXA6OkNvbXBvbmVudEluc3RhbmNlKQogICAgICByZXR1cm4gdW5sZXNzIGVudGl0eS5kZWZpbml0aW9uID09IEB0YXJnZXRfZGVmCgogICAgICBAZG9uZSA9IHRydWUKICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKCiAgICAgIFVJLnN0YXJ0X3RpbWVyKDAuMCwgZmFsc2UpIGRvCiAgICAgICAgYmVnaW4KICAgICAgICAgIGluc3QyID0gTUhERVNJR04udW53cmFwX3RvX2R5bmFtaWMhKGVudGl0eSkKICAgICAgICAgIG1vZGVsLnNlbGVjdGlvbi5jbGVhcgogICAgICAgICAgbW9kZWwuc2VsZWN0aW9uLmFkZChpbnN0MikgaWYgaW5zdDIKICAgICAgICByZXNjdWUKICAgICAgICBlbnN1cmUKICAgICAgICAgIGJlZ2luCiAgICAgICAgICAgIGVudGl0aWVzLnJlbW92ZV9vYnNlcnZlcihzZWxmKQogICAgICAgICAgcmVzY3VlCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuaW5zdGFsbF9wbGFjZV9vYnNlcnZlcl9mb3IoZGVmaW5pdGlvbikKICAgIGVudHMgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZW50aXRpZXMKICAgIG9icyA9IFBsYWNlQW5kVW53cmFwT2JzZXJ2ZXIubmV3KGRlZmluaXRpb24pCiAgICBlbnRzLmFkZF9vYnNlcnZlcihvYnMpCgogICAgVUkuc3RhcnRfdGltZXIoMjAuMCwgZmFsc2UpIGRvCiAgICAgIGJlZ2luCiAgICAgICAgZW50cy5yZW1vdmVfb2JzZXJ2ZXIob2JzKQogICAgICByZXNjdWUKICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IERvd25sb2FkIGRlZmluaXRpb24gKyBwcm9ncmVzcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgZGVmIHNlbGYuZmV0Y2hfZGVmaW5pdGlvbl9hc3luYyhjb21wLCAmYmxvY2spCiAgICBiZWdpbgogICAgICB1cmwgPSBVUkkucGFyc2UoY29tcFs6dXJsXS50b19zKQogICAgICBjYWNoZV9kaXIgPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZGVzaWduX2NhY2hlXzEiKQogICAgICBGaWxlVXRpbHMubWtkaXJfcChjYWNoZV9kaXIpCgogICAgICBoYXNoX25hbWUgID0gRGlnZXN0OjpTSEEyNTYuaGV4ZGlnZXN0KHVybC50b19zKVswLi4xNl0gKyAiLnNrcCIKICAgICAgbG9jYWxfcGF0aCA9IEZpbGUuam9pbihjYWNoZV9kaXIsIGhhc2hfbmFtZSkKICAgICAgbW9kZWwgICAgICA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbAoKICAgICAgaWYgRmlsZS5leGlzdD8obG9jYWxfcGF0aCkgJiYgRmlsZS5zaXplKGxvY2FsX3BhdGgpID4gMAogICAgICAgIGRlZmluaXRpb24gPSBtb2RlbC5kZWZpbml0aW9ucy5sb2FkKGxvY2FsX3BhdGgsIGFsbG93X25ld2VyOiB0cnVlKQogICAgICAgIGJsb2NrLmNhbGwoZGVmaW5pdGlvbikgaWYgYmxvY2sKICAgICAgICByZXR1cm4KICAgICAgZW5kCgogICAgICBwcm9ncmVzcyA9IFVJOjpIdG1sRGlhbG9nLm5ldyh7CiAgICAgICAgOmRpYWxvZ190aXRsZSA9PiAi2KzYp9ixINin2YTYqtit2YXZitmELi4uIiwKICAgICAgICA6cHJlZmVyZW5jZXNfa2V5ID0+ICJtaGRlc2lnbl9wcm9ncmVzcyIsCiAgICAgICAgOnNjcm9sbGFibGUgPT4gZmFsc2UsCiAgICAgICAgOnJlc2l6YWJsZSA9PiBmYWxzZSwKICAgICAgICA6d2lkdGggPT4gMzAwLAogICAgICAgIDpoZWlnaHQgPT4gMTUwCiAgICAgIH0pCgogICAgICBwcm9ncmVzcy5zZXRfaHRtbCA8PC1IVE1MCiAgICAgICAgPGh0bWw+PGhlYWQ+CiAgICAgICAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICAgICAgICA8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVRhamF3YWw6d2dodEA0MDA7NzAwJmRpc3BsYXk9c3dhcCIgcmVsPSJzdHlsZXNoZWV0Ij4KICAgICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OidUYWphd2FsJyxzYW5zLXNlcmlmOyB0ZXh0LWFsaWduOmNlbnRlcjsgbWFyZ2luOjA7IHBhZGRpbmc6MjBweDsgZGlyZWN0aW9uOnJ0bDsgfQogICAgICAgICAgICBoMyB7IG1hcmdpbjogMTBweCAwOyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1iYXIgeyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAyMHB4OyBiYWNrZ3JvdW5kOiAjZGRkOyBib3JkZXItcmFkaXVzOiAxMHB4OyBvdmVyZmxvdzogaGlkZGVuOyBtYXJnaW4tdG9wOiAxMHB4OyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1maWxsIHsgaGVpZ2h0OiAxMDAlOyB3aWR0aDogMCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IHRyYW5zaXRpb246IHdpZHRoIDAuMnMgZWFzZTsgfQogICAgICAgICAgICAjcGVyY2VudCB7IG1hcmdpbi10b3A6IDhweDsgZm9udC1zaXplOiAxNHB4OyB9CiAgICAgICAgICA8L3N0eWxlPgogICAgICAgIDwvaGVhZD48Ym9keT4KICAgICAgICAgIDxoMz7YrNin2LEg2KrYrdmF2YrZhCDYp9mE2LnZhti12LEuLi48L2gzPgogICAgICAgICAgPGRpdiBpZD0icHJvZ3Jlc3MtYmFyIj48ZGl2IGlkPSJwcm9ncmVzcy1maWxsIj48L2Rpdj48L2Rpdj4KICAgICAgICAgIDxkaXYgaWQ9InBlcmNlbnQiPjAlPC9kaXY+CiAgICAgICAgPC9ib2R5PjwvaHRtbD4KICAgICAgSFRNTAoKICAgICAgcHJvZ3Jlc3Muc2hvdwoKICAgICAgVUkuc3RhcnRfdGltZXIoMC4xLCBmYWxzZSkgZG8KICAgICAgICB0ZW1wZmlsZSA9IG5pbAogICAgICAgIGJlZ2luCiAgICAgICAgICBjb250ZW50X2xlbmd0aCA9IG5pbAogICAgICAgICAgdGVtcGZpbGUgPSBUZW1wZmlsZS5uZXcoIm1oY29tcG9uZW50IikKCiAgICAgICAgICBVUkkub3Blbih1cmwsCiAgICAgICAgICAgIGNvbnRlbnRfbGVuZ3RoX3Byb2M6IC0+KGxlbikgeyBjb250ZW50X2xlbmd0aCA9IGxlbiB9LAogICAgICAgICAgICBwcm9ncmVzc19wcm9jOiAtPihieXRlcykgewogICAgICAgICAgICAgIHBlcmNlbnQgPSBjb250ZW50X2xlbmd0aCA/ICgoYnl0ZXMudG9fZiAvIGNvbnRlbnRfbGVuZ3RoKSAqIDEwMCkudG9faSA6IDAKICAgICAgICAgICAgICBwcm9ncmVzcy5leGVjdXRlX3NjcmlwdCgiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzLWZpbGwnKS5zdHlsZS53aWR0aCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICAgIHByb2dyZXNzLmV4ZWN1dGVfc2NyaXB0KCJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyY2VudCcpLmlubmVyVGV4dCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICB9CiAgICAgICAgICApIGRvIHxyZW1vdGVfZmlsZXwKICAgICAgICAgICAgSU8uY29weV9zdHJlYW0ocmVtb3RlX2ZpbGUsIHRlbXBmaWxlKQogICAgICAgICAgZW5kCgogICAgICAgICAgdGVtcGZpbGUuY2xvc2UKICAgICAgICAgIEZpbGVVdGlscy5tdih0ZW1wZmlsZS5wYXRoLCBsb2NhbF9wYXRoKQogICAgICAgICAgcHJvZ3Jlc3MuY2xvc2UgaWYgcHJvZ3Jlc3MudmlzaWJsZT8KCiAgICAgICAgICBpZiBGaWxlLmV4aXN0Pyhsb2NhbF9wYXRoKSAmJiBGaWxlLnNpemUobG9jYWxfcGF0aCkgPiAwCiAgICAgICAgICAgIGRlZmluaXRpb24gPSBtb2RlbC5kZWZpbml0aW9ucy5sb2FkKGxvY2FsX3BhdGgsIGFsbG93X25ld2VyOiB0cnVlKQogICAgICAgICAgICBibG9jay5jYWxsKGRlZmluaXRpb24pIGlmIGJsb2NrCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDZgdi02YQg2KrYrdmF2YrZhCDYp9mE2YXZhNmBINmF2YYg2KfZhNiz2YrYsdmB2LEuIikKICAgICAgICAgICAgYmxvY2suY2FsbChuaWwpIGlmIGJsb2NrCiAgICAgICAgICBlbmQKCiAgICAgICAgcmVzY3VlID0+IGUKICAgICAgICAgIGJlZ2luCiAgICAgICAgICAgIHRlbXBmaWxlLmNsb3NlIGlmIHRlbXBmaWxlCiAgICAgICAgICAgIHRlbXBmaWxlLnVubGluayBpZiB0ZW1wZmlsZQogICAgICAgICAgcmVzY3VlCiAgICAgICAgICBlbmQKICAgICAgICAgIHByb2dyZXNzLmNsb3NlIGlmIHByb2dyZXNzLnZpc2libGU/CiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqAg2K3Yr9irINiu2LfYoyDYo9ir2YbYp9ihINiq2K3ZhdmK2YQg2KfZhNi52YbYtdixOiAje2UubWVzc2FnZX0iKQogICAgICAgICAgYmxvY2suY2FsbChuaWwpIGlmIGJsb2NrCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgIHJlc2N1ZSA9PiBlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKaoCDYrdiv2Ksg2K7Yt9ijOiAje2UubWVzc2FnZX0iKQogICAgICBibG9jay5jYWxsKG5pbCkgaWYgYmxvY2sKICAgIGVuZAogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUGx1Z2lucyBsb2FkZXIgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLnNhZmVfbG9hZF9sb2NhbChmaWxlX25hbWUpCiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIFBMVUdJTl9ESVIgJiYgRmlsZS5kaXJlY3Rvcnk/KFBMVUdJTl9ESVIpCiAgICBwYXRoID0gRmlsZS5qb2luKFBMVUdJTl9ESVIsIGZpbGVfbmFtZSkKICAgIHJldHVybiBmYWxzZSB1bmxlc3MgRmlsZS5leGlzdD8ocGF0aCkKICAgIGJlZ2luCiAgICAgIGxvYWQgcGF0aAogICAgICB0cnVlCiAgICByZXNjdWUgPT4gZQogICAgICBVSS5tZXNzYWdlYm94KCLimqAg2K7Yt9ijINmB2Yog2KrYrdmF2YrZhCAje2ZpbGVfbmFtZX06XG4je2UubWVzc2FnZX0iKQogICAgICBmYWxzZQogICAgZW5kCiAgZW5kCgogIGRlZiBzZWxmLmNhbGxfaW52b2ljZV9wbHVnaW4KICAgIHVubGVzcyBzYWZlX2xvYWRfbG9jYWwoImludm9pY2UucmIiKQogICAgICBVSS5tZXNzYWdlYm94KCLinYwg2YXZhNmBIGludm9pY2UucmIg2LrZitixINmF2YjYrNmI2K8g2KPZiCDYqNmHINiu2LfYoy4iKQogICAgICByZXR1cm4KICAgIGVuZAogICAgaWYgZGVmaW5lZD8oTUhEZXNpZ24pICYmIE1IRGVzaWduLmNvbnN0X2RlZmluZWQ/KDpNSEludm9pY2UpCiAgICAgIG1vZCA9IE1IRGVzaWduLmNvbnN0X2dldCg6TUhJbnZvaWNlKQogICAgICBpZiBtb2QucmVzcG9uZF90bz8oOm9wZW5faW52b2ljZV9kaWFsb2cpCiAgICAgICAgbW9kLm9wZW5faW52b2ljZV9kaWFsb2cKICAgICAgZWxzZQogICAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCBpbnZvaWNlLnJiINmE2Kcg2YrYrdiq2YjZiiDYudmE2Ykgb3Blbl9pbnZvaWNlX2RpYWxvZyDZgdmKIE1IRGVzaWduOjpNSEludm9pY2UuIikKICAgICAgZW5kCiAgICBlbHNlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCBpbnZvaWNlLnJiINmE2Kcg2YrYrdiq2YjZiiDYudmE2YkgTUhEZXNpZ246Ok1ISW52b2ljZS4iKQogICAgZW5kCiAgZW5kCgogIGRlZiBzZWxmLmNhbGxfcmVwb3J0c19wbHVnaW4KICAgIHVubGVzcyBzYWZlX2xvYWRfbG9jYWwoInJlcG9ydF91bml0cy5yYiIpCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDZhdmE2YEgcmVwb3J0X3VuaXRzLnJiINi62YrYsSDZhdmI2KzZiNivINij2Ygg2KjZhyDYrti32KMuIikKICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIGRlZmluZWQ/KE1IREVTSUdOKSAmJiBNSERFU0lHTi5jb25zdF9kZWZpbmVkPyg6UmVwb3J0VW5pdHMpCiAgICAgIG1vZCA9IE1IREVTSUdOLmNvbnN0X2dldCg6UmVwb3J0VW5pdHMpCiAgICAgIFs6cnVuLCA6c3RhcnQsIDpvcGVuX2RpYWxvZywgOnNob3dfZGlhbG9nLCA6b3BlbiwgOnNob3csIDptYWluLCA6Z2VuZXJhdGVdLmVhY2ggZG8gfG18CiAgICAgICAgYmVnaW4KICAgICAgICAgIGlmIG1vZC5yZXNwb25kX3RvPyhtKQogICAgICAgICAgICBtb2Quc2VuZChtKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIGVuZAogICAgICAgIHJlc2N1ZQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgbGlzdCA9IChtb2QubWV0aG9kcyhmYWxzZSkubWFwKCY6dG9fcykuc29ydCByZXNjdWUgW10pCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCByZXBvcnRfdW5pdHMucmIg2YTYpyDZitit2KrZiNmKINi52YTZiSDYp9mE2YjYuNin2KbZgSDYp9mE2YXYqtmI2YLYudipLlxu2KfZhNmI2LjYp9im2YEg2KfZhNmF2YjYrNmI2K/YqSDZgdmKIE1IREVTSUdOOjpSZXBvcnRVbml0czpcbi0gIiArIGxpc3QuZmlyc3QoNDApLmpvaW4oIlxuLSAiKSkKICAgIGVsc2UKICAgICAgVUkubWVzc2FnZWJveCgi4p2MIHJlcG9ydF91bml0cy5yYiDZhNinINmK2K3YqtmI2Yog2LnZhNmJIE1IREVTSUdOOjpSZXBvcnRVbml0cy4iKQogICAgZW5kCiAgZW5kCgogICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBNYWtlIFVuaXF1ZSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgbW9kdWxlIE1IREVTSUdOX1VOSVFVSUZZCiAgICBkZWYgc2VsZi5tYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShlbnRpdGllcykKICAgICAgZW50aXRpZXMuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpLmVhY2ggZG8gfGluc3RhbmNlfAogICAgICAgIGluc3RhbmNlLm1ha2VfdW5pcXVlCiAgICAgICAgbWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUoaW5zdGFuY2UuZGVmaW5pdGlvbi5lbnRpdGllcykKICAgICAgZW5kCiAgICBlbmQKICAgIGRlZiBzZWxmLm1ha2VfZGVmaW5pdGlvbnNfdW5pcXVlCiAgICAgIG1vZGVsID0gU2tldGNodXAuYWN0aXZlX21vZGVsCiAgICAgIG1vZGVsLmRlZmluaXRpb25zLmVhY2ggZG8gfGRlZmluaXRpb258CiAgICAgICAgbmV4dCBpZiBkZWZpbml0aW9uLmdyb3VwPyB8fCBkZWZpbml0aW9uLmltYWdlPwogICAgICAgIGRlZmluaXRpb24uaW5zdGFuY2VzLmVhY2ggZG8gfGluc3RhbmNlfAogICAgICAgICAgaW5zdGFuY2UubWFrZV91bmlxdWUKICAgICAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKGluc3RhbmNlLmRlZmluaXRpb24uZW50aXRpZXMpCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgZW5kCiAgICBkZWYgc2VsZi5ydW5fdW5pcXVpZnkKICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgbW9kZWwuc3RhcnRfb3BlcmF0aW9uKCLYrNi52YQg2KzZhdmK2Lkg2KfZhNi52YbYp9i12LEg2YHYsdmK2K/YqSIsIHRydWUpCiAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKG1vZGVsLmVudGl0aWVzKQogICAgICBtYWtlX2RlZmluaXRpb25zX3VuaXF1ZQogICAgICBtb2RlbC5jb21taXRfb3BlcmF0aW9uCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINis2LnZhCDYrNmF2YrYuSDYp9mE2LnZhtin2LXYsSDZgdix2YrYr9ipLiIpCiAgICBlbmQKICBlbmQKCiAgIyDinJMgQURERUQ6IFdpbmRvd3MgLkNVUiBnZW5lcmF0b3IgKHdvcmtzIGV2ZW4gd2hlbiBQTkcgY3Vyc29yIGZhaWxzKSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgZGVmIHNlbGYuX2JsYW5rX3JnYmEodywgaCkKICAgIEFycmF5Lm5ldyh3ICogaCAqIDQsIDApCiAgZW5kCgogIGRlZiBzZWxmLl9zZXRfcHgocGl4ZWxzLCB3LCB4LCB5LCByPTAsIGc9MCwgYj0wLCBhPTI1NSkKICAgIHJldHVybiBpZiB4IDwgMCB8fCB5IDwgMCB8fCB4ID49IHcKICAgIGlkeCA9ICh5ICogdyArIHgpICogNAogICAgcGl4ZWxzW2lkeF0gICAgID0gcgogICAgcGl4ZWxzW2lkeCArIDFdID0gZwogICAgcGl4ZWxzW2lkeCArIDJdID0gYgogICAgcGl4ZWxzW2lkeCArIDNdID0gYQogIGVuZAoKICBkZWYgc2VsZi5fZHJhd19saW5lKHBpeGVscywgdywgeDAsIHkwLCB4MSwgeTEsIHI9MCwgZz0wLCBiPTAsIGE9MjU1KQogICAgZHggPSAoeDEgLSB4MCkuYWJzCiAgICBzeCA9IHgwIDwgeDEgPyAxIDogLTEKICAgIGR5ID0gLSh5MSAtIHkwKS5hYnMKICAgIHN5ID0geTAgPCB5MSA/IDEgOiAtMQogICAgZXJyID0gZHggKyBkeQogICAgbG9vcCBkbwogICAgICBfc2V0X3B4KHBpeGVscywgdywgeDAsIHkwLCByLCBnLCBiLCBhKQogICAgICBicmVhayBpZiB4MCA9PSB4MSAmJiB5MCA9PSB5MQogICAgICBlMiA9IDIgKiBlcnIKICAgICAgaWYgZTIgPj0gZHkKICAgICAgICBlcnIgKz0gZHkKICAgICAgICB4MCArPSBzeAogICAgICBlbmQKICAgICAgaWYgZTIgPD0gZHgKICAgICAgICBlcnIgKz0gZHgKICAgICAgICB5MCArPSBzeQogICAgICBlbmQKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5fZHJhd19hcnJvd19oZWFkKHBpeGVscywgdywgdGlweCwgdGlweSwgZGlyKQogICAgY2FzZSBkaXIKICAgIHdoZW4gOmxlZnQKICAgICAgX2RyYXdfbGluZShwaXhlbHMsIHcsIHRpcHgsIHRpcHksIHRpcHggKyA2LCB0aXB5IC0gNCkKICAgICAgX2RyYXdfbGluZShwaXhlbHMsIHcsIHRpcHgsIHRpcHksIHRpcHggKyA2LCB0aXB5ICsgNCkKICAgIHdoZW4gOnJpZ2h0CiAgICAgIF9kcmF3X2xpbmUocGl4ZWxzLCB3LCB0aXB4LCB0aXB5LCB0aXB4IC0gNiwgdGlweSAtIDQpCiAgICAgIF9kcmF3X2xpbmUocGl4ZWxzLCB3LCB0aXB4LCB0aXB5LCB0aXB4IC0gNiwgdGlweSArIDQpCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuX3dyaXRlX2N1cihwYXRoLCB3LCBoLCBob3R4LCBob3R5LCBwaXhlbHNfcmdiYSkKICAgIHJhaXNlICJiYWQgc2l6ZSIgdW5sZXNzIHcgPiAwICYmIGggPiAwCiAgICB4b3Jfcm93X2J5dGVzID0gdyAqIDQKICAgIHhvcl9ieXRlcyA9IHhvcl9yb3dfYnl0ZXMgKiBoCgogICAgbWFza19yb3dfYnl0ZXMgPSAoKHcgKyAzMSkgLyAzMikgKiA0CiAgICBtYXNrX2J5dGVzID0gbWFza19yb3dfYnl0ZXMgKiBoCgogICAgYmlfc2l6ZSA9IDQwCiAgICBiaV93aWR0aCA9IHcKICAgIGJpX2hlaWdodCA9IGggKiAyCiAgICBiaV9wbGFuZXMgPSAxCiAgICBiaV9iaXRjb3VudCA9IDMyCiAgICBiaV9jb21wcmVzc2lvbiA9IDAKICAgIGJpX3NpemVpbWFnZSA9IHhvcl9ieXRlcyArIG1hc2tfYnl0ZXMKICAgIGJpX3hwcG0gPSAwCiAgICBiaV95cHBtID0gMAogICAgYmlfY2xydXNlZCA9IDAKICAgIGJpX2NscmltcA=="  // كود روبي مشفر بـ base64
}
