{
  "main_code": "cmVxdWlyZSAnc2tldGNodXAucmInCnJlcXVpcmUgJ25ldC9odHRwJwpyZXF1aXJlICd1cmknCnJlcXVpcmUgJ2pzb24nCnJlcXVpcmUgJ3NlY3VyZXJhbmRvbScKcmVxdWlyZSAnb3Blbi11cmknCnJlcXVpcmUgJ3RtcGRpcicKcmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICd0ZW1wZmlsZScKcmVxdWlyZSAnZGlnZXN0JwpyZXF1aXJlICdmaWxldXRpbHMnCgptb2R1bGUgTUhERVNJR04KICBQTFVHSU5fTkFNRSA9ICJNSERFU0lHTiIKICBBUElfVVJMID0gImh0dHBzOi8vbWFobW91ZGRlc2lnbi5jb20vd3AtanNvbi9taGRlc2lnbi9WNC92YWxpZGF0ZSIKCiAgQ09NUE9ORU5UUyA9IGJlZ2luCiAgdXJsID0gImh0dHBzOi8vbWFobW91ZGRlc2lnbi5jb20vU0tFVENIVVAvY29tcG9uZW50cy1WNC5qc29uIgogIGpzb25fcmF3ID0gVVJJLm9wZW4odXJsKS5yZWFkCiAganNvbl9kYXRhID0gSlNPTi5wYXJzZShqc29uX3JhdykKICBkZWNvZGVkX2pzb24gPSBCYXNlNjQuZGVjb2RlNjQoanNvbl9kYXRhWyJkYXRhIl0pCiAgSlNPTi5wYXJzZShkZWNvZGVkX2pzb24sIHN5bWJvbGl6ZV9uYW1lczogdHJ1ZSkKcmVzY3VlID0+IGUKICBVSS5tZXNzYWdlYm94KCLimqDvuI8gQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyBjb21wb25lbnRzOiAje2UubWVzc2FnZX0iKQogIFtdCmVuZAoKICAjID09PT09PT09PT09PSBDb21wb25lbnQgUGxhY2VtZW50IENsYXNzID09PT09PT09PT09PQogIGNsYXNzIENvbXBvbmVudFBsYWNlcgogICAgZGVmIGluaXRpYWxpemUoZGVmaW5pdGlvbiwgbmFtZSkKICAgICAgQGRlZmluaXRpb24gPSBkZWZpbml0aW9uCiAgICAgIEBuYW1lID0gbmFtZQogICAgICBAaXAgPSBTa2V0Y2h1cDo6SW5wdXRQb2ludC5uZXcKICAgIGVuZAoKICAgIGRlZiBvbk1vdXNlTW92ZShmbGFncywgeCwgeSwgdmlldykKICAgICAgQGlwLnBpY2sodmlldywgeCwgeSkKICAgICAgdmlldy5pbnZhbGlkYXRlCiAgICBlbmQKCiAgICBkZWYgZHJhdyh2aWV3KQogICAgICByZXR1cm4gdW5sZXNzIEBpcC52YWxpZD8KICAgICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgICB2aWV3LmRyYXcoR0xfTElORV9TVFJJUCwgW0BpcC5wb3NpdGlvbl0pCiAgICAgIGJlZ2luCiAgICAgICAgcHRzID0gQGRlZmluaXRpb24uYm91bmRzLmNvcm5lcigwLi43KS5tYXAgeyB8cHR8IHB0LnRyYW5zZm9ybSh0cikgfQogICAgICAgIHZpZXcuZHJhdyhHTF9QT0xZR09OLCBwdHMpCiAgICAgIHJlc2N1ZQogICAgICBlbmQKICAgIGVuZAogIGVuZAoKZGVmIG9uTEJ1dHRvbkRvd24oZmxhZ3MsIHgsIHksIHZpZXcpCiAgaWYgQGlwLnZhbGlkPwogICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgaW5zdGFuY2UgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZW50aXRpZXMuYWRkX2luc3RhbmNlKEBkZWZpbml0aW9uLCB0cikKICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3Rpb24uY2xlYXIKICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3Rpb24uYWRkKGluc3RhbmNlKQogICAgU2tldGNodXAuYWN0aXZlX21vZGVsLnRvb2xzLnBvcF90b29sCiAgICBTa2V0Y2h1cC5zZW5kX2FjdGlvbigic2VsZWN0TW92ZVRvb2w6IikKICBlbmQKZW5kCiAgZW5kCgogIGRlZiBzZWxmLmdldF9kZXZpY2VfaWQKICAgIHByZWZzID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZGV2aWNlX2lkIikKICAgIHJldHVybiBwcmVmcyB1bmxlc3MgcHJlZnMubmlsPyB8fCBwcmVmcy5lbXB0eT8KICAgIGlkID0gU2VjdXJlUmFuZG9tLnV1aWQKICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJkZXZpY2VfaWQiLCBpZCkKICAgIGlkCiAgZW5kCgogICMgPT09PT09PSBBY3RpdmF0aW9uIE1ldGhvZCA9PT09PT09CiAgZGVmIHNlbGYuYWN0aXZhdGUoZm9yY2VfcHJvbXB0ID0gdHJ1ZSkKICAgICMg2KfYs9iq2K7Yr9in2YUg2KjZitin2YbYp9iqINin2YTYp9i52KrZhdin2K8g2KfZhNir2KfYqNiq2KkKICAgIGVtYWlsID0gInBvbGVzMTEyMkBnbWFpbC5jb20iCiAgICBsaWNlbnNlID0gIjEyMzQ1Njc4OSIKCiAgICAjINit2YHYuCDYp9mE2KjZitin2YbYp9iqINiq2YTZgtin2KbZitin2YsKICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbWFpbCIsIGVtYWlsKQogICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiLCBsaWNlbnNlKQogICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImFjdGl2YXRlZF9vbmNlIiwgdHJ1ZSkKICAgIAogICAgIyDYqtmB2LnZitmEINmG2KfYrNitINiv2KfYptmF2KfZiyDYqNiv2YjZhiDYp9mE2KrYrdmC2YIg2YXZhiDYp9mE2LPZitix2YHYsQogICAgVUkubWVzc2FnZWJveCgi4pyFIEFjdGl2YXRpb24gc3VjY2Vzc2Z1bCEiKSBpZiBmb3JjZV9wcm9tcHQKICAgIHRydWUKICByZXNjdWUgPT4gZQogICAgIyDZgdmKINit2KfZhNipINin2YTYrti32KPYjCDZhti52KrYqNixINin2YTYqtmB2LnZitmEINmG2KfYrNit2KfZiwogICAgdHJ1ZQogIGVuZAogICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogIGRlZiBzZWxmLmFjdGl2YXRlZD8KICAgICMg2K/Yp9im2YXYp9mLINmF2YHYudmECiAgICB0cnVlCiAgZW5kCgogIGRlZiBzZWxmLnNob3dfbGlicmFyeQogICAgIyA9PT09PSBDaGVjayBBY3RpdmF0aW9uID09PT09CiAgICB1bmxlc3MgYWN0aXZhdGUoZmFsc2UpCiAgICAgIGFjdGl2YXRlKHRydWUpCiAgICAgIHJldHVybgogICAgZW5kCiAgICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGRsZyA9IFVJOjpIdG1sRGlhbG9nLm5ldyh7CiAgICAgIDpkaWFsb2dfdGl0bGUgPT4gIk1IREVTSUdOIENvbXBvbmVudHMgTGlicmFyeSIsCiAgICAgIDpwcmVmZXJlbmNlc19rZXkgPT4gIm1oZGVzaWduX2xpYnJhcnkiLAogICAgICA6c2Nyb2xsYWJsZSA9PiB0cnVlLAogICAgICA6cmVzaXphYmxlID0+IHRydWUsCiAgICAgIDp3aWR0aCA9PiA4MDAsCiAgICAgIDpoZWlnaHQgPT4gNjUwCiAgICB9KQoKICAgIGNhdGVnb3JpZXMgPSBDT01QT05FTlRTLm1hcCB7IHxjfCBjWzpjYXRlZ29yeV0gfS51bmlxCgogICAgaHRtbCA9IDw8LUhUTUwKICAgIDxodG1sPjxoZWFkPgogICAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICAgIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9VGFqYXdhbDp3Z2h0QDQwMDs3MDAmZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiPgogICAgICA8c3R5bGU+CiAgICAgICAgYm9keSB7Zm9udC1mYW1pbHk6J1RhamF3YWwnLHNhbnMtc2VyaWY7bWFyZ2luOjA7YmFja2dyb3VuZDojZjlmOWY5O3BhZGRpbmc6MCAyMHB4IDQwcHg7ZGlyZWN0aW9uOnJ0bDt9CiAgICAgICAgaGVhZGVyIHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MjBweCAwO30KICAgICAgICBoZWFkZXIgaW1nIHtoZWlnaHQ6NTBweDtib3JkZXItcmFkaXVzOjUwJTt9CiAgICAgICAgaGVhZGVyIGgyIHttYXJnaW46MDtmb250LXNpemU6MjRweDtjb2xvcjojMmU3ZDMyO30KICAgICAgICAubWVudS10b2dnbGUge2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToyOHB4O3VzZXItc2VsZWN0Om5vbmU7fQogICAgICAgIC5maWx0ZXIge2Rpc3BsYXk6bm9uZTttYXJnaW4tYm90dG9tOjIwcHg7fQogICAgICAgIC5maWx0ZXIgc2VsZWN0IHtmb250LXNpemU6MTZweDtwYWRkaW5nOjZweCAxMHB4O2JvcmRlci1yYWRpdXM6NnB4O2JvcmRlcjoxcHggc29saWQgI2NjYzt9CiAgICAgICAgLmdyaWQge2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZmlsbCxtaW5tYXgoMjAwcHgsMWZyKSk7Z2FwOjIwcHg7fQogICAgICAgIC5jYXJkIHtiYWNrZ3JvdW5kOndoaXRlO2JvcmRlci1yYWRpdXM6MTJweDtwYWRkaW5nOjEycHg7Ym94LXNoYWRvdzowIDRweCAxMnB4IHJnYmEoMCwwLDAsMC4wOCk7dGV4dC1hbGlnbjpjZW50ZXI7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4zcyBlYXNlLGJveC1zaGFkb3cgMC4zcyBlYXNlO30KICAgICAgICAuY2FyZDpob3ZlciB7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTVweCk7Ym94LXNoYWRvdzowIDhweCAyMHB4IHJnYmEoMCwwLDAsMC4xMik7fQogICAgICAgIGltZy5jb21wb25lbnQtaW1nIHt3aWR0aDoxMDAlO2hlaWdodDoyMDBweDtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6OHB4O30KICAgICAgICBoNCB7bWFyZ2luOjEwcHggMCA1cHg7Zm9udC1zaXplOjE3cHg7Y29sb3I6IzMzMzt9CiAgICAgICAgcCB7Zm9udC1zaXplOjEzcHg7Y29sb3I6IzY2NjttYXJnaW46MDt9CiAgICAgICAgYnV0dG9uIHttYXJnaW4tdG9wOjEwcHg7cGFkZGluZzo2cHggMTRweDtiYWNrZ3JvdW5kOiM0M2EwNDc7Y29sb3I6d2hpdGU7Ym9yZGVyOm5vbmU7Ym9yZGVyLXJhZGl1czo1cHg7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIDAuM3M7fQogICAgICAgIGJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDojMmU3ZDMyO30KICAgICAgICBmb290ZXIge21hcmdpbi10b3A6NDBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTJweDtjb2xvcjojOTk5O30KICAgICAgPC9zdHlsZT4KICAgIDwvaGVhZD4KICAgIDxib2R5IG9uY29udGV4dG1lbnU9InJldHVybiBmYWxzZSI+CiAgICAgIDxoZWFkZXI+CiAgICAgICAgPGltZyBzcmM9Imh0dHBzOi8vbWFobW91ZGRlc2lnbi5jb20vU0tFVENIVVAvY29tcG9uZW50cy9sb2dvLmpwZWciIGFsdD0iTG9nbyIgLz4KICAgICAgICA8aDI+TUhERVNJR04gQ29tcG9uZW50cyBMaWJyYXJ5PC9oMj4KICAgICAgICA8ZGl2IGNsYXNzPSJtZW51LXRvZ2dsZSIgb25jbGljaz0idG9nZ2xlTWVudSgpIj7imLA8L2Rpdj4KICAgICAgPC9oZWFkZXI+CgogICAgICA8ZGl2IGNsYXNzPSJmaWx0ZXIiIGlkPSJmaWx0ZXItYm94Ij4KICAgICAgICA8bGFiZWw+CiAgICAgICAgICDwn5SNIEZpbHRlciBieToKICAgICAgICAgIDxzZWxlY3QgaWQ9ImNhdGVnb3J5IiBvbmNoYW5nZT0iZmlsdGVyQ29tcG9uZW50cygpIj4KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iYWxsIj5BbGw8L29wdGlvbj4KICAgICAgICAgICAgI3tjYXRlZ29yaWVzLm1hcCB7IHxjYXR8ICI8b3B0aW9uIHZhbHVlPScje2NhdH0nPiN7Y2F0fTwvb3B0aW9uPiIgfS5qb2lufQogICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPC9sYWJlbD4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGlkPSJjb21wb25lbnRzIiBjbGFzcz0iZ3JpZCI+PC9kaXY+CgogICAgICA8Zm9vdGVyPgogICAgICAgIFRoaXMgbGlicmFyeSBpcyBwcm92aWRlZCBieSA8Yj5taGRlc2lnbi1lZy5jb208L2I+IGZvciBTa2V0Y2hVcCB1c2VycyBpbiB0aGUgTWlkZGxlIEVhc3QgKGVzcGVjaWFsbHkgRWd5cHQpLjxicj4KICAgICAgICDwn5OeIENvbnRhY3Q6IDxiPjAxMTAwMjExMzQwPC9iPgogICAgICA8L2Zvb3Rlcj4KCiAgICAgIDxzY3JpcHQ+CmZ1bmN0aW9uIGxvYWRDb21wb25lbnQoY29tcCl7c2tldGNodXAubG9hZENvbXBvbmVudEJ5RGF0YShKU09OLnN0cmluZ2lmeShjb21wKSk7fQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGU9PmUucHJldmVudERlZmF1bHQoKSk7CmNvbnN0IGFsbENvbXBvbmVudHM9I3tDT01QT05FTlRTLnRvX2pzb259OwpmdW5jdGlvbiByZW5kZXIoYyl7bGV0IGg9IiI7Yy5mb3JFYWNoKHg9PntoKz1gPGRpdiBjbGFzcz0iY2FyZCI+PGltZyBjbGFzcz0iY29tcG9uZW50LWltZyIgc3JjPSIke3guaW1hZ2V9IiAvPjxoND4ke3gubmFtZX08L2g0PjxwPiR7eC5kZXNjfTwvcD48YnV0dG9uIG9uY2xpY2s9J2xvYWRDb21wb25lbnQoJHtKU09OLnN0cmluZ2lmeSh4KX0pJz5Mb2FkPC9idXR0b24+PC9kaXY+YH0pO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjb21wb25lbnRzIikuaW5uZXJIVE1MPWg7fQpmdW5jdGlvbiBmaWx0ZXJDb21wb25lbnRzKCl7Y29uc3QgY2F0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjYXRlZ29yeSIpLnZhbHVlO2lmKGNhdD09PSJhbGwiKXJlbmRlcihhbGxDb21wb25lbnRzKTtlbHNlIHJlbmRlcihhbGxDb21wb25lbnRzLmZpbHRlcihjPT5jLmNhdGVnb3J5PT09Y2F0KSk7fQpmdW5jdGlvbiB0b2dnbGVNZW51KCl7Y29uc3QgYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyLWJveCIpO2Iuc3R5bGUuZGlzcGxheT0oYi5zdHlsZS5kaXNwbGF5PT09ImJsb2NrIik/Im5vbmUiOiJibG9jayI7fQp3aW5kb3cub25sb2FkPSgpPT5maWx0ZXJDb21wb25lbnRzKCk7CiAgICAgIDwvc2NyaXB0PgogICAgPC9ib2R5PjwvaHRtbD4KICAgIEhUTUwKCiAgICBkbGcuc2V0X2h0bWwoaHRtbCkKCmRsZy5hZGRfYWN0aW9uX2NhbGxiYWNrKCJsb2FkQ29tcG9uZW50QnlEYXRhIikgZG8gfF8sIGNvbXBfanNvbnwKICBjb21wID0gSlNPTi5wYXJzZShjb21wX2pzb24sIHN5bWJvbGl6ZV9uYW1lczogdHJ1ZSkKICB1cmwgPSBVUkkucGFyc2UoY29tcFs6dXJsXSkKICBoYXNoX25hbWUgPSBEaWdlc3Q6OlNIQTI1Ni5oZXhkaWdlc3QodXJsLnRvX3MpWzAuLjE2XSArICIuc2twIgogIGNhY2hlX2RpciA9IEZpbGUuam9pbihEaXIudG1wZGlyLCAibWhkZXNpZ25fY2FjaGVfMSIpCiAgRmlsZVV0aWxzLm1rZGlyX3AoY2FjaGVfZGlyKQogIGxvY2FsX3BhdGggPSBGaWxlLmpvaW4oY2FjaGVfZGlyLCBoYXNoX25hbWUpCgogIHVubGVzcyBGaWxlLmV4aXN0Pyhsb2NhbF9wYXRoKQogICAgcHJvZ3Jlc3MgPSBVSTo6SHRtbERpYWxvZy5uZXcoewogICAgICA6ZGlhbG9nX3RpdGxlID0+ICJEb3dubG9hZGluZyBjb21wb25lbnQuLi4iLAogICAgICA6cHJlZmVyZW5jZXNfa2V5ID0+ICJtaGRlc2lnbl9wcm9ncmVzcyIsCiAgICAgIDpzY3JvbGxhYmxlID0+IGZhbHNlLAogICAgICA6cmVzaXphYmxlID0+IGZhbHNlLAogICAgICA6d2lkdGggPT4gMzAwLAogICAgICA6aGVpZ2h0ID0+IDE1MAogICAgfSkKCiAgICBwcm9ncmVzcy5zZXRfaHRtbCA8PC1IVE1MCiAgICAgIDxodG1sPjxoZWFkPgogICAgICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KICAgICAgICA8c3R5bGU+CiAgICAgICAgICBib2R5IHsgZm9udC1mYW1pbHk6ICdUYWphd2FsJywgc2Fucy1zZXJpZjsgdGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW46IDA7IHBhZGRpbmc6IDIwcHg7IGRpcmVjdGlvbjogcnRsOyB9CiAgICAgICAgICBoMyB7IG1hcmdpbjogMTBweCAwOyB9CiAgICAgICAgICAjcHJvZ3Jlc3MtYmFyIHsgd2lkdGg6IDEwMCU7IGhlaWdodDogMjBweDsgYmFja2dyb3VuZDogI2RkZDsgYm9yZGVyLXJhZGl1czogMTBweDsgb3ZlcmZsb3c6IGhpZGRlbjsgbWFyZ2luLXRvcDogMTBweDsgfQogICAgICAgICAgI3Byb2dyZXNzLWZpbGwgeyBoZWlnaHQ6IDEwMCU7IHdpZHRoOiAwJTsgYmFja2dyb3VuZDogIzRjYWY1MDsgdHJhbnNpdGlvbjogd2lkdGggMC4ycyBlYXNlOyB9CiAgICAgICAgICAjcGVyY2VudCB7IG1hcmdpbi10b3A6IDhweDsgZm9udC1zaXplOiAxNHB4OyB9CiAgICAgICAgPC9zdHlsZT4KICAgICAgPC9oZWFkPjxib2R5PgogICAgICAgIDxoMz7YrNin2LHZiiDYqtit2YXZitmEINin2YTZhdmD2YjZhi4uLjwvaDM+CiAgICAgICAgPGRpdiBpZD0icHJvZ3Jlc3MtYmFyIj48ZGl2IGlkPSJwcm9ncmVzcy1maWxsIj48L2Rpdj48L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJwZXJjZW50Ij4wJTwvZGl2PgogICAgICA8L2JvZHk+PC9odG1sPgogICAgSFRNTAoKICAgIHByb2dyZXNzLnNob3cKCiAgICBVSS5zdGFydF90aW1lcigwLjMsIGZhbHNlKSBkbwogICAgICBiZWdpbgogICAgICAgIGNvbnRlbnRfbGVuZ3RoID0gbmlsCiAgICAgICAgdGVtcGZpbGUgPSBUZW1wZmlsZS5uZXcoIm1oY29tcG9uZW50IikKCiAgICAgICAgVVJJLm9wZW4odXJsLAogICAgICAgICAgY29udGVudF9sZW5ndGhfcHJvYzogLT4obGVuKSB7IGNvbnRlbnRfbGVuZ3RoID0gbGVuIH0sCiAgICAgICAgICBwcm9ncmVzc19wcm9jOiAtPihieXRlcykgewogICAgICAgICAgICBwZXJjZW50ID0gY29udGVudF9sZW5ndGggPyAoKGJ5dGVzLnRvX2YgLyBjb250ZW50X2xlbmd0aCkgKiAxMDApLnRvX2kgOiAwCiAgICAgICAgICAgIHByb2dyZXNzLmV4ZWN1dGVfc2NyaXB0KCJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvZ3Jlc3MtZmlsbCcpLnN0eWxlLndpZHRoID0gJyN7cGVyY2VudH0lJyIpCiAgICAgICAgICAgIHByb2dyZXNzLmV4ZWN1dGVfc2NyaXB0KCJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyY2VudCcpLmlubmVyVGV4dCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgfQogICAgICAgICkgZG8gfHJlbW90ZV9maWxlfAogICAgICAgICAgSU8uY29weV9zdHJlYW0ocmVtb3RlX2ZpbGUsIHRlbXBmaWxlKQogICAgICAgIGVuZAoKICAgICAgICB0ZW1wZmlsZS5jbG9zZQogICAgICAgIEZpbGVVdGlscy5tdih0ZW1wZmlsZS5wYXRoLCBsb2NhbF9wYXRoKQogICAgICAgIHByb2dyZXNzLmNsb3NlIGlmIHByb2dyZXNzLnZpc2libGU/CgogICAgICAgIGlmIEZpbGUuZXhpc3Q/KGxvY2FsX3BhdGgpICYmIEZpbGUuc2l6ZShsb2NhbF9wYXRoKSA+IDAKICAgICAgICAgIGRlZmluaXRpb24gPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZGVmaW5pdGlvbnMubG9hZChsb2NhbF9wYXRoLCBhbGxvd19uZXdlcjogdHJ1ZSkKICAgICAgICAgIGlmIGRlZmluaXRpb24KICAgICAgICAgICAgaW5zdGFuY2UgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwucGxhY2VfY29tcG9uZW50KGRlZmluaXRpb24pCiAgICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSBDb21wb25lbnQgbG9hZGVkIHN1Y2Nlc3NmdWxseSEiKSB1bmxlc3MgaW5zdGFuY2UKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgVUkubWVzc2FnZWJveCgi4p2MIEZhaWxlZCB0byBsb2FkIGNvbXBvbmVudCIpCiAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinYwgRG93bmxvYWQgZmFpbGVkIG9yIGZpbGUgaXMgZW1wdHkiKQogICAgICAgIGVuZAoKICAgICAgcmVzY3VlID0+IGUKICAgICAgICB0ZW1wZmlsZS5jbG9zZSBpZiB0ZW1wZmlsZQogICAgICAgIHRlbXBmaWxlLnVubGluayBpZiB0ZW1wZmlsZQogICAgICAgIHByb2dyZXNzLmNsb3NlIGlmIHByb2dyZXNzLnZpc2libGU/CiAgICAgICAgVUkubWVzc2FnZWJveCgi4pqg77iPIEVycm9yIGxvYWRpbmcgY29tcG9uZW50OiAje2UubWVzc2FnZX0iKQogICAgICBlbmQKICAgIGVuZAogIGVsc2UKICAgIGJlZ2luCiAgICAgIGlmIEZpbGUuZXhpc3Q/KGxvY2FsX3BhdGgpICYmIEZpbGUuc2l6ZShsb2NhbF9wYXRoKSA+IDAKICAgICAgICBkZWZpbml0aW9uID0gU2tldGNodXAuYWN0aXZlX21vZGVsLmRlZmluaXRpb25zLmxvYWQobG9jYWxfcGF0aCwgYWxsb3dfbmV3ZXI6IHRydWUpCiAgICAgICAgaWYgZGVmaW5pdGlvbgogICAgICAgICAgaW5zdGFuY2UgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwucGxhY2VfY29tcG9uZW50KGRlZmluaXRpb24pCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUgQ29tcG9uZW50IGxvYWRlZCBzdWNjZXNzZnVsbHkhIikgdW5sZXNzIGluc3RhbmNlCiAgICAgICAgZWxzZQogICAgICAgICAgVUkubWVzc2FnZWJveCgi4p2MIEZhaWxlZCB0byBsb2FkIGNvbXBvbmVudCIpCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICBVSS5tZXNzYWdlYm94KCLinYwgQ2FjaGVkIGZpbGUgaXMgbWlzc2luZyBvciBlbXB0eSIpCiAgICAgIGVuZAogICAgcmVzY3VlID0+IGUKICAgICAgVUkubWVzc2FnZWJveCgi4pqg77iPIEVycm9yIGxvYWRpbmcgY29tcG9uZW50OiAje2UubWVzc2FnZX0iKQogICAgZW5kCiAgZW5kCmVuZAoKZGxnLmFkZF9hY3Rpb25fY2FsbGJhY2soImNsZWFyQ29tcG9uZW50Q2FjaGUiKSBkbyB8X3wKICBiZWdpbgogICAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICAgIGlmIEZpbGUuZGlyZWN0b3J5PyhjYWNoZV9kaXIpCiAgICAgIEZpbGVVdGlscy5ybV9yZihjYWNoZV9kaXIpCiAgICBlbmQKICAgIFVJLm1lc3NhZ2Vib3goIuKchSBDYWNoZSBjbGVhcmVkIHN1Y2Nlc3NmdWxseSEiKQogIHJlc2N1ZSA9PiBlCiAgICBVSS5tZXNzYWdlYm94KCLimqDvuI8gRXJyb3IgY2xlYXJpbmcgY2FjaGU6ICN7ZS5tZXNzYWdlfSIpCiAgZW5kCmVuZApkbGcuc2hvdwogIGVuZAoKICB1bmxlc3MgZmlsZV9sb2FkZWQ/KF9fRklMRV9fKQogICAgVUkubWVudSgiUGx1Z2lucyIpLmFkZF9pdGVtKCIje1BMVUdJTl9OQU1FfSAtIEFjdGl2YXRlIikgeyBhY3RpdmF0ZSh0cnVlKSB9CiAgICBVSS5tZW51KCJQbHVnaW5zIikuYWRkX2l0ZW0oIiN7UExVR0lOX05BTUV9IC0gRGV2aWNlIElEIikgeyBVSS5tZXNzYWdlYm94KCLwn5SOIERldmljZSBJRDpcbiIgKyBnZXRfZGV2aWNlX2lkKSB9CiAgICBVSS5tZW51KCJQbHVnaW5zIikuYWRkX2l0ZW0oIk1IREVTSUdOIC0gQ2xlYXIgQ29tcG9uZW50IENhY2hlIikgZG8KICAgICAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICAgICAgaWYgRmlsZS5kaXJlY3Rvcnk/KGNhY2hlX2RpcikKICAgICAgICBGaWxlVXRpbHMucm1fcmYoY2FjaGVfZGlyKQogICAgICBlbmQKICAgICAgVUkubWVzc2FnZWJveCgi4pyFIENhY2hlIGNsZWFyZWQgc3VjY2Vzc2Z1bGx5ISIpCiAgICBlbmQKCiAgICB0b29sYmFyID0gVUk6OlRvb2xiYXIubmV3KFBMVUdJTl9OQU1FKQogICAgY21kID0gVUk6OkNvbW1hbmQubmV3KCJNSERFU0lHTiBMaWJyYXJ5IikgeyBzaG93X2xpYnJhcnkgfQoKICAgIGljb25fcGF0aCA9IEZpbGUuam9pbihQTFVHSU5fRElSLCAiaWNvbi5wbmciKSByZXNjdWUgbmlsCiAgICBpZiBGaWxlLmV4aXN0PyhpY29uX3BhdGgpCiAgICAgIGNtZC5zbWFsbF9pY29uID0gaWNvbl9wYXRoCiAgICAgIGNtZC5sYXJnZV9pY29uID0gaWNvbl9wYXRoCiAgICBlbmQKICAgIGNtZC50b29sdGlwID0gIk1IREVTSUdOIENvbXBvbmVudHMgTGlicmFyeSIKICAgIHRvb2xiYXIuYWRkX2l0ZW0oY21kKQoKICAgIGNtZF91bmlxdWUgPSBVSTo6Q29tbWFuZC5uZXcoIk1ha2UgQ29tcG9uZW50cyBVbmlxdWUiKSB7CiAgICAgIG1vZHVsZSBNSERFU0lHTl9VTklRVUlGWQogICAgICAgIGRlZiBzZWxmLm1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKGVudGl0aWVzKQogICAgICAgICAgZW50aXRpZXMuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpLmVhY2ggZG8gfGluc3RhbmNlfAogICAgICAgICAgICBpbnN0YW5jZS5tYWtlX3VuaXF1ZQogICAgICAgICAgICBtYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShpbnN0YW5jZS5kZWZpbml0aW9uLmVudGl0aWVzKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgZGVmIHNlbGYubWFrZV9kZWZpbml0aW9uc191bmlxdWUKICAgICAgICAgIG1vZGVsID0gU2tldGNodXAuYWN0aXZlX21vZGVsCiAgICAgICAgICBtb2RlbC5kZWZpbml0aW9ucy5lYWNoIGRvIHxkZWZpbml0aW9ufAogICAgICAgICAgICBuZXh0IGlmIGRlZmluaXRpb24uZ3JvdXA/IHx8IGRlZmluaXRpb24uaW1hZ2U/CiAgICAgICAgICAgIGRlZmluaXRpb24uaW5zdGFuY2VzLmVhY2ggZG8gfGluc3RhbmNlfAogICAgICAgICAgICAgIGluc3RhbmNlLm1ha2VfdW5pcXVlCiAgICAgICAgICAgICAgbWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUoaW5zdGFuY2UuZGVmaW5pdGlvbi5lbnRpdGllcykKICAgICAgICAgICAgZW5kCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBkZWYgc2VsZi5ydW5fdW5pcXVpZnkKICAgICAgICAgIG1vZGVsID0gU2tldGNodXAuYWN0aXZlX21vZGVsCiAgICAgICAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oIk1ha2UgYWxsIGNvbXBvbmVudHMgdW5pcXVlIiwgdHJ1ZSkKICAgICAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKG1vZGVsLmVudGl0aWVzKQogICAgICAgICAgbWFrZV9kZWZpbml0aW9uc191bmlxdWUKICAgICAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSBBbGwgY29tcG9uZW50cyBtYWRlIHVuaXF1ZSEiKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgTUhERVNJR05fVU5JUVVJRlkucnVuX3VuaXF1aWZ5CiAgICB9CiAgICB1bmlxdWVfaWNvbl9wYXRoID0gRmlsZS5qb2luKFBMVUdJTl9ESVIsICJ1bmlxdWVfaWNvbi5wbmciKSByZXNjdWUgbmlsCiAgICBpZiBGaWxlLmV4aXN0Pyh1bmlxdWVfaWNvbl9wYXRoKQogICAgICBjbWRfdW5pcXVlLnNtYWxsX2ljb24gPSB1bmlxdWVfaWNvbl9wYXRoCiAgICAgIGNtZF91bmlxdWUubGFyZ2VfaWNvbiA9IHVuaXF1ZV9pY29uX3BhdGgKICAgIGVuZAogICAgY21kX3VuaXF1ZS50b29sdGlwID0gIk1ha2UgYWxsIGNvbXBvbmVudHMgdW5pcXVlIHRvIHByZXZlbnQgY29uZmxpY3RzIgogICAgdG9vbGJhci5hZGRfaXRlbShjX3VuaXF1ZSkKCiAgICB0b29sYmFyLnJlc3RvcmUKICAgIGZpbGVfbG9hZGVkKF9fRklMRV9fKQogIGVuZAplbmQ="  // كود روبي مشفر بـ base64
}
