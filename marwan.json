{
  "main_code": "cmVxdWlyZSAnc2tldGNodXAucmInCnJlcXVpcmUgJ25ldC9odHRwJwpyZXF1aXJlICd1cmknCnJlcXVpcmUgJ2pzb24nCnJlcXVpcmUgJ3NlY3VyZXJhbmRvbScKcmVxdWlyZSAnb3Blbi11cmknCnJlcXVpcmUgJ3RtcGRpcicKcmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICd0ZW1wZmlsZScKcmVxdWlyZSAnZGlnZXN0JwpyZXF1aXJlICdmaWxldXRpbHMnCgptb2R1bGUgTUhERVNJR04KICBQTFVHSU5fTkFNRSA9ICJNSERFU0lHTiIKICBBUElfVVJMID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9tYXJ3YW5hZGVsZWx0YWhhbi1zdWRvL0FQSTEyMy9yZWZzL2hlYWRzL21haW4vZW1haWwuanNvbiIKCiAgQ09NUE9ORU5UUyA9IGJlZ2luCiAgICB1cmwgPSAiaHR0cHM6Ly9tYWhtb3VkZGVzaWduLmNvbS9TS0VUQ0hVUC9jb21wb25lbnRzLVY0Lmpzb24iCiAgICBqc29uX3JhdyA9IFVSSS5vcGVuKHVybCkucmVhZAogICAganNvbl9kYXRhID0gSlNPTi5wYXJzZShqc29uX3JhdykKICAgIGRlY29kZWRfanNvbiA9IEJhc2U2NC5kZWNvZGU2NChqc29uX2RhdGFbImRhdGEiXSkKICAgIEpTT04ucGFyc2UoZGVjb2RlZF9qc29uLCBzeW1ib2xpemVfbmFtZXM6IHRydWUpCiAgcmVzY3VlID0+IGUKICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDYrdiv2Ksg2K7Yt9ijINmB2Yog2KrYrdmF2YrZhCDYp9mE2YXZg9iq2KjYqTogI3tlLm1lc3NhZ2V9IikKICAgIFtdCiAgZW5kCgogICMgPT09INmB2KbYqSDZhNmI2LbYuSDYp9mE2YXZg9mI2YbYp9iqID09PQogIGNsYXNzIENvbXBvbmVudFBsYWNlcgogICAgZGVmIGluaXRpYWxpemUoZGVmaW5pdGlvbiwgbmFtZSkKICAgICAgQGRlZmluaXRpb24gPSBkZWZpbml0aW9uCiAgICAgIEBuYW1lID0gbmFtZQogICAgICBAaXAgPSBTa2V0Y2h1cDo6SW5wdXRQb2ludC5uZXcKICAgIGVuZAoKICAgIGRlZiBvbk1vdXNlTW92ZShmbGFncywgeCwgeSwgdmlldykKICAgICAgQGlwLnBpY2sodmlldywgeCwgeSkKICAgICAgdmlldy5pbnZhbGlkYXRlCiAgICBlbmQKCiAgICBkZWYgZHJhdyh2aWV3KQogICAgICByZXR1cm4gdW5sZXNzIEBpcC52YWxpZD8KICAgICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgICB2aWV3LmRyYXcoR0xfTElORV9TVFJJUCwgW0BpcC5wb3NpdGlvbl0pCiAgICAgIGJlZ2luCiAgICAgICAgcHRzID0gQGRlZmluaXRpb24uYm91bmRzLmNvcm5lcigwLi43KS5tYXAgeyB8cHR8IHB0LnRyYW5zZm9ybSh0cikgfQogICAgICAgIHZpZXcuZHJhdyhHTF9QT0xZR09OLCBwdHMpCiAgICAgIHJlc2N1ZQogICAgICBlbmQKICAgIGVuZAoKICAgIGRlZiBvbkxCdXR0b25Eb3duKGZsYWdzLCB4LCB5LCB2aWV3KQogICAgICBpZiBAaXAudmFsaWQ/CiAgICAgICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgICAgIGluc3RhbmNlID0gU2tldGNodXAuYWN0aXZlX21vZGVsLmVudGl0aWVzLmFkZF9pbnN0YW5jZShAZGVmaW5pdGlvbiwgdHIpCiAgICAgICAgU2tldGNodXAuYWN0aXZlX21vZGVsLnNlbGVjdGlvbi5jbGVhcgogICAgICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3Rpb24uYWRkKGluc3RhbmNlKQogICAgICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC50b29scy5wb3BfdG9vbAogICAgICAgIFNrZXRjaHVwLnNlbmRfYWN0aW9uKCJzZWxlY3RNb3ZlVG9vbDoiKQogICAgICBlbmQKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5nZXRfZGV2aWNlX2lkCiAgICBwcmVmcyA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImRldmljZV9pZCIpCiAgICByZXR1cm4gcHJlZnMgdW5sZXNzIHByZWZzLm5pbD8gfHwgcHJlZnMuZW1wdHk/CiAgICBpZCA9IFNlY3VyZVJhbmRvbS51dWlkCiAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZGV2aWNlX2lkIiwgaWQpCiAgICBpZAogIGVuZAoKICAjID09PSDZhti42KfZhSDYp9mE2KrZgdi52YrZhCDYp9mE2YXYrdiv2KsgPT09CiAgZGVmIHNlbGYuYWN0aXZhdGUoZm9yY2VfcHJvbXB0ID0gdHJ1ZSkKICAgIGVtYWlsID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiKSB8fCAiIgogICAgbGljZW5zZSA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiKSB8fCAiIgoKICAgICMg2KXYsNinINmD2KfZhiDZhdmB2LHZiNi2INmG2K/YrtmEINin2YTYqNmK2KfZhtin2Kog2KPZiCDYp9mE2KjZitin2YbYp9iqINmB2KfYsdi62KkKICAgIGlmIGZvcmNlX3Byb21wdCB8fCBlbWFpbC5lbXB0eT8gfHwgbGljZW5zZS5lbXB0eT8KICAgICAgaW5wdXQgPSBVSS5pbnB1dGJveChbItin2YTYqNix2YrYryDYp9mE2KXZhNmD2KrYsdmI2YbZiiIsICLZg9mI2K8g2KfZhNiq2LHYrtmK2LUiXSwgW2VtYWlsLCBsaWNlbnNlXSwgItiq2YHYudmK2YQgTUhERVNJR04iKQogICAgICByZXR1cm4gZmFsc2UgdW5sZXNzIGlucHV0CiAgICAgIGVtYWlsLCBsaWNlbnNlID0gaW5wdXQKICAgIGVuZAoKICAgICMg2KfZhNiq2K3ZgtmCINmF2YYg2KfZhNio2YrYp9mG2KfYqiDYudio2LEgQVBJCiAgICB2YWxpZCA9IGNoZWNrX2NyZWRlbnRpYWxzKGVtYWlsLCBsaWNlbnNlKQogICAgCiAgICBpZiB2YWxpZAogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiLCBlbWFpbCkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiLCBsaWNlbnNlKQogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiYWN0aXZhdGVkX29uY2UiLCB0cnVlKQogICAgICBVSS5tZXNzYWdlYm94KCLinIUg2YXYqNix2YjZgyDZitinINmH2YbYr9iz2Kkg2KfZhNil2LbYp9mB2Kkg2LTYutin2YTYqVxu2KrZhSDYqNix2YXYrNipINin2YTYpdi22KfZgdipINio2YjYp9iz2LfYqSDZhdmH2YbYr9izINmF2LHZiNin2YYg2LnYp9iv2YQiKQogICAgICB0cnVlCiAgICBlbHNlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDYp9mE2KjZitin2YbYp9iqINi62YTYtyDYrdin2YjZhCDZhdix2Kkg2KrYp9mG2YrYqSDZitinINmH2YbYr9iz2Kkg2KfZiCDZg9mE2YUgMDEyMDQyNzk2MDYiKQogICAgICBmYWxzZQogICAgZW5kCiAgcmVzY3VlID0+IGUKICAgIFVJLm1lc3NhZ2Vib3goIuKaoO+4jyDYrdiv2Ksg2K7Yt9ijINmB2Yog2KfZhNiq2K3ZgtmCOiAje2UubWVzc2FnZX0iKQogICAgZmFsc2UKICBlbmQKCiAgZGVmIHNlbGYuY2hlY2tfY3JlZGVudGlhbHMoZW1haWwsIGxpY2Vuc2UpCiAgICBiZWdpbgogICAgICB1cmkgPSBVUkkoQVBJX1VSTCkKICAgICAgcmVzcG9uc2UgPSBOZXQ6OkhUVFAuZ2V0X3Jlc3BvbnNlKHVyaSkKICAgICAgCiAgICAgIGlmIHJlc3BvbnNlLmlzX2E/KE5ldDo6SFRUUFN1Y2Nlc3MpCiAgICAgICAgdmFsaWRfdXNlcnMgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmJvZHkpCiAgICAgICAgCiAgICAgICAgIyDYp9mE2KjYrdirINi52YYg2KfZhNmF2LPYqtiu2K/ZhSDYp9mE2YXYt9in2KjZggogICAgICAgIHZhbGlkX3VzZXJzLmFueT8gZG8gfHVzZXJ8CiAgICAgICAgICB1c2VyX2VtYWlsID0gdXNlclsiZW1haWwiXSB8fCB1c2VyWzplbWFpbF0KICAgICAgICAgIHVzZXJfbGljZW5zZSA9IHVzZXJbImxpY2Vuc2UiXSB8fCB1c2VyWzpsaWNlbnNlXQogICAgICAgICAgdXNlcl9lbWFpbCA9PSBlbWFpbCAmJiB1c2VyX2xpY2Vuc2UgPT0gbGljZW5zZQogICAgICAgIGVuZAogICAgICBlbHNlCiAgICAgICAgZmFsc2UKICAgICAgZW5kCiAgICByZXNjdWUgPT4gZQogICAgICBVSS5tZXNzYWdlYm94KCLinYwg2K7Yt9ijINmB2Yog2KfZhNin2KrYtdin2YQg2KjYp9mE2K7Yp9iv2YU6ICN7ZS5tZXNzYWdlfSIpCiAgICAgIGZhbHNlCiAgICBlbmQKICBlbmQKICAjID09PT09PT09PT09PT09PT09PT09PT0KCiAgZGVmIHNlbGYuYWN0aXZhdGVkPwogICAgZW1haWwgPSBTa2V0Y2h1cC5yZWFkX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbWFpbCIpCiAgICBsaWNlbnNlID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGljZW5zZSIpCiAgICAhZW1haWwudG9fcy5lbXB0eT8gJiYgIWxpY2Vuc2UudG9fcy5lbXB0eT8KICBlbmQKCiAgZGVmIHNlbGYuc2hvd19saWJyYXJ5CiAgICAjID09PSDYqtit2YLZgiDZhdmGINin2YTYqtmB2LnZitmEINij2YjZhNin2YsgPT09CiAgICB1bmxlc3MgYWN0aXZhdGUoZmFsc2UpCiAgICAgIGFjdGl2YXRlKHRydWUpCiAgICAgIHJldHVybgogICAgZW5kCiAgICAjID09PT09PT09PT09PT09PT09PT09PT0KCiAgICBkbGcgPSBVSTo6SHRtbERpYWxvZy5uZXcoewogICAgICA6ZGlhbG9nX3RpdGxlID0+ICLZhdmD2KrYqNipINmF2YPZiNmG2KfYqiBNSERFU0lHTiIsCiAgICAgIDpwcmVmZXJlbmNlc19rZXkgPT4gIm1oZGVzaWduX2xpYnJhcnkiLAogICAgICA6c2Nyb2xsYWJsZSA9PiB0cnVlLAogICAgICA6cmVzaXphYmxlID0+IHRydWUsCiAgICAgIDp3aWR0aCA9PiA4MDAsCiAgICAgIDpoZWlnaHQgPT4gNjUwCiAgICB9KQoKICAgIGNhdGVnb3JpZXMgPSBDT01QT05FTlRTLm1hcCB7IHxjfCBjWzpjYXRlZ29yeV0gfS51bmlxCgogICAgaHRtbCA9IDw8LUhUTUwKICAgIDxodG1sPjxoZWFkPgogICAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICAgIDxsaW5rIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9VGFqYXdhbDp3Z2h0QDQwMDs3MDAmZGlzcGxheT1zd2FwIiByZWw9InN0eWxlc2hlZXQiPgogICAgICA8c3R5bGU+CiAgICAgICAgYm9keSB7Zm9udC1mYW1pbHk6J1RhamF3YWwnLHNhbnMtc2VyaWY7bWFyZ2luOjA7YmFja2dyb3VuZDojZjlmOWY5O3BhZGRpbmc6MCAyMHB4IDQwcHg7ZGlyZWN0aW9uOnJ0bDt9CiAgICAgICAgaGVhZGVyIHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MjBweCAwO30KICAgICAgICBoZWFkZXIgaW1nIHtoZWlnaHQ6NTBweDtib3JkZXItcmFkaXVzOjUwJTt9CiAgICAgICAgaGVhZGVyIGgyIHttYXJnaW46MDtmb250LXNpemU6MjRweDtjb2xvcjojMmU3ZDMyO30KICAgICAgICAubWVudS10b2dnbGUge2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToyOHB4O3VzZXItc2VsZWN0Om5vbmU7fQogICAgICAgIC5maWx0ZXIge2Rpc3BsYXk6bm9uZTttYXJnaW4tYm90dG9tOjIwcHg7fQogICAgICAgIC5maWx0ZXIgc2VsZWN0IHtmb250LXNpemU6MTZweDtwYWRkaW5nOjZweCAxMHB4O2JvcmRlci1yYWRpdXM6NnB4O2JvcmRlcjoxcHggc29saWQgI2NjYzt9CiAgICAgICAgLmdyaWQge2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KGF1dG8tZmlsbCxtaW5tYXgoMjAwcHgsMWZyKSk7Z2FwOjIwcHg7fQogICAgICAgIC5jYXJkIHtiYWNrZ3JvdW5kOndoaXRlO2JvcmRlci1yYWRpdXM6MTJweDtwYWRkaW5nOjEycHg7Ym94LXNoYWRvdzowIDRweCAxMnB4IHJnYmEoMCwwLDAsMC4wOCk7dGV4dC1hbGlnbjpjZW50ZXI7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4zcyBlYXNlLGJveC1zaGFkb3cgMC4zcyBlYXNlO30KICAgICAgICAuY2FyZDpob3ZlciB7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTVweCk7Ym94LXNoYWRvdzowIDhweCAyMHB4IHJnYmEoMCwwLDAsMC4xMik7fQogICAgICAgIGltZy5jb21wb25lbnQtaW1nIHt3aWR0aDoxMDAlO2hlaWdodDoyMDBweDtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6OHB4O30KICAgICAgICBoNCB7bWFyZ2luOjEwcHggMCA1cHg7Zm9udC1zaXplOjE3cHg7Y29sb3I6IzMzMzt9CiAgICAgICAgcCB7Zm9udC1zaXplOjEzcHg7Y29sb3I6IzY2NjttYXJnaW46MDt9CiAgICAgICAgYnV0dG9uIHttYXJnaW4tdG9wOjEwcHg7cGFkZGluZzo2cHggMTRweDtiYWNrZ3JvdW5kOiM0M2EwNDc7Y29sb3I6d2hpdGU7Ym9yZGVyOm5vbmU7Ym9yZGVyLXJhZGl1czo1cHg7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIDAuM3M7fQogICAgICAgIGJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDojMmU3ZDMyO30KICAgICAgICBmb290ZXIge21hcmdpbi10b3A6NDBweDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTJweDtjb2xvcjojOTk5O30KICAgICAgPC9zdHlsZT4KICAgIDwvaGVhZD4KICAgIDxib2R5IG9uY29udGV4dG1lbnU9InJldHVybiBmYWxzZSI+CiAgICAgIDxoZWFkZXI+CiAgICAgICAgPGltZyBzcmM9Imh0dHBzOi8vbWFobW91ZGRlc2lnbi5jb20vU0tFVENIVVAvY29tcG9uZW50cy9sb2dvLmpwZWciIGFsdD0iTG9nbyIgLz4KICAgICAgICA8aDI+2YXZg9iq2KjYqSDZhdmD2YjZhtin2KogTUhERVNJR048L2gyPgogICAgICAgIDxkaXYgY2xhc3M9Im1lbnUtdG9nZ2xlIiBvbmNsaWNrPSJ0b2dnbGVNZW51KCkiPuKYsDwvZGl2PgogICAgICA8L2hlYWRlcj4KCiAgICAgIDxkaXYgY2xhc3M9ImZpbHRlciIgaWQ9ImZpbHRlci1ib3giPgogICAgICAgIDxsYWJlbD4KICAgICAgICAgIPCflI0g2KrYtdmB2YrYqSDYrdiz2Kg6CiAgICAgICAgICA8c2VsZWN0IGlkPSJjYXRlZ29yeSIgb25jaGFuZ2U9ImZpbHRlckNvbXBvbmVudHMoKSI+CiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImFsbCI+2KfZhNmD2YQ8L29wdGlvbj4KICAgICAgICAgICAgI3tjYXRlZ29yaWVzLm1hcCB7IHxjYXR8ICI8b3B0aW9uIHZhbHVlPScje2NhdH0nPiN7Y2F0fTwvb3B0aW9uPiIgfS5qb2lufQogICAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPC9sYWJlbD4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGlkPSJjb21wb25lbnRzIiBjbGFzcz0iZ3JpZCI+PC9kaXY+CgogICAgICA8Zm9vdGVyPgogICAgICAgINiq2YUg2KrYt9mI2YrYsSDYp9mE2KXYttin2YHYqSDYqNmI2KfYs9i32KkgPGI+2YXZh9mG2K/YsyDZhdix2YjYp9mGINi52KfYr9mEPC9iPjxicj4KICAgICAgICDZhNmE2K/YudmFINin2YTZgdmG2Yo6IDxiPjAxMjA0Mjc5NjA2PC9iPgogICAgICA8L2Zvb3Rlcj4KCiAgICAgIDxzY3JpcHQ+CmZ1bmN0aW9uIGxvYWRDb21wb25lbnQoY29tcCl7c2tldGNodXAubG9hZENvbXBvbmVudEJ5RGF0YShKU09OLnN0cmluZ2lmeShjb21wKSk7fQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIGU9PmUucHJldmVudERlZmF1bHQoKSk7CmNvbnN0IGFsbENvbXBvbmVudHM9I3tDT01QT05FTlRTLnRvX2pzb259OwpmdW5jdGlvbiByZW5kZXIoYyl7bGV0IGg9IiI7Yy5mb3JFYWNoKHg9PntoKz1gPGRpdiBjbGFzcz0iY2FyZCI+PGltZyBjbGFzcz0iY29tcG9uZW50LWltZyIgc3JjPSIke3guaW1hZ2V9IiAvPjxoND4ke3gubmFtZX08L2g0PjxwPiR7eC5kZXNjfTwvcD48YnV0dG9uIG9uY2xpY2s9J2xvYWRDb21wb25lbnQoJHtKU09OLnN0cmluZ2lmeSh4KX0pJz7Yqtit2YXZitmEINin2YTZhdmD2YjZhjwvYnV0dG9uPjwvZGl2PmB9KTtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29tcG9uZW50cyIpLmlubmVySFRNTD1oO30KZnVuY3Rpb24gZmlsdGVyQ29tcG9uZW50cygpe2NvbnN0IGNhdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2F0ZWdvcnkiKS52YWx1ZTtpZihjYXQ9PT0iYWxsIilyZW5kZXIoYWxsQ29tcG9uZW50cyk7ZWxzZSByZW5kZXIoYWxsQ29tcG9uZW50cy5maWx0ZXIoYz0+Yy5jYXRlZ29yeT09PWNhdCkpO30KZnVuY3Rpb24gdG9nZ2xlTWVudSgpe2NvbnN0IGI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlci1ib3giKTtiLnN0eWxlLmRpc3BsYXk9KGIuc3R5bGUuZGlzcGxheT09PSJibG9jayIpPyJub25lIjoiYmxvY2siO30Kd2luZG93Lm9ubG9hZD0oKT0+ZmlsdGVyQ29tcG9uZW50cygpOwogICAgICA8L3NjcmlwdD4KICAgIDwvYm9keT48L2h0bWw+CiAgICBIVE1MCgogICAgZGxnLnNldF9odG1sKGh0bWwpCgogICAgZGxnLmFkZF9hY3Rpb25fY2FsbGJhY2soImxvYWRDb21wb25lbnRCeURhdGEiKSBkbyB8XywgY29tcF9qc29ufAogICAgICBjb21wID0gSlNPTi5wYXJzZShjb21wX2pzb24sIHN5bWJvbGl6ZV9uYW1lczogdHJ1ZSkKICAgICAgdXJsID0gVVJJLnBhcnNlKGNvbXBbOnVybF0pCiAgICAgIGhhc2hfbmFtZSA9IERpZ2VzdDo6U0hBMjU2LmhleGRpZ2VzdCh1cmwudG9fcylbMC4uMTZdICsgIi5za3AiCiAgICAgIGNhY2hlX2RpciA9IEZpbGUuam9pbihEaXIudG1wZGlyLCAibWhkZXNpZ25fY2FjaGVfMSIpCiAgICAgIEZpbGVVdGlscy5ta2Rpcl9wKGNhY2hlX2RpcikKICAgICAgbG9jYWxfcGF0aCA9IEZpbGUuam9pbihjYWNoZV9kaXIsIGhhc2hfbmFtZSkKCiAgICAgIHVubGVzcyBGaWxlLmV4aXN0Pyhsb2NhbF9wYXRoKQogICAgICAgIHByb2dyZXNzID0gVUk6Okh0bWxEaWFsb2cubmV3KHsKICAgICAgICAgIDpkaWFsb2dfdGl0bGUgPT4gItis2KfYsdmKINiq2K3ZhdmK2YQg2KfZhNmF2YPZiNmGLi4uIiwKICAgICAgICAgIDpwcmVmZXJlbmNlc19rZXkgPT4gIm1oZGVzaWduX3Byb2dyZXNzIiwKICAgICAgICAgIDpzY3JvbGxhYmxlID0+IGZhbHNlLAogICAgICAgICAgOnJlc2l6YWJsZSA9PiBmYWxzZSwKICAgICAgICAgIDp3aWR0aCA9PiAzMDAsCiAgICAgICAgICA6aGVpZ2h0ID0+IDE1MAogICAgICAgIH0pCgogICAgICAgIHByb2dyZXNzLnNldF9odG1sIDw8LUhUTUwKICAgICAgICA8aHRtbD48aGVhZD4KICAgICAgICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KICAgICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OiAnVGFqYXdhbCcsIHNhbnMtc2VyaWY7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAwOyBwYWRkaW5nOiAyMHB4OyBkaXJlY3Rpb246IHJ0bDsgfQogICAgICAgICAgICBoMyB7IG1hcmdpbjogMTBweCAwOyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1iYXIgeyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAyMHB4OyBiYWNrZ3JvdW5kOiAjZGRkOyBib3JkZXItcmFkaXVzOiAxMHB4OyBvdmVyZmxvdzogaGlkZGVuOyBtYXJnaW4tdG9wOiAxMHB4OyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1maWxsIHsgaGVpZ2h0OiAxMDAlOyB3aWR0aDogMCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IHRyYW5zaXRpb246IHdpZHRoIDAuMnMgZWFzZTsgfQogICAgICAgICAgICAjcGVyY2VudCB7IG1hcmdpbi10b3A6IDhweDsgZm9udC1zaXplOiAxNHB4OyB9CiAgICAgICAgICA8L3N0eWxlPgogICAgICAgIDwvaGVhZD48Ym9keT4KICAgICAgICAgIDxoMz7YrNin2LHZiiDYqtit2YXZitmEINin2YTZhdmD2YjZhi4uLjwvaDM+CiAgICAgICAgICA8ZGl2IGlkPSJwcm9ncmVzcy1iYXIiPjxkaXYgaWQ9InByb2dyZXNzLWZpbGwiPjwvZGl2PjwvZGl2PgogICAgICAgICAgPGRpdiBpZD0icGVyY2VudCI+MCU8L2Rpdj4KICAgICAgICA8L2JvZHk+PC9odG1sPgogICAgICAgIEhUTUwKCiAgICAgICAgcHJvZ3Jlc3Muc2hvdwoKICAgICAgICBVSS5zdGFydF90aW1lcigwLjMsIGZhbHNlKSBkbwogICAgICAgICAgYmVnaW4KICAgICAgICAgICAgY29udGVudF9sZW5ndGggPSBuaWwKICAgICAgICAgICAgdGVtcGZpbGUgPSBUZW1wZmlsZS5uZXcoIm1oY29tcG9uZW50IikKCiAgICAgICAgICAgIFVSSS5vcGVuKHVybCwKICAgICAgICAgICAgICBjb250ZW50X2xlbmd0aF9wcm9jOiAtPihsZW4pIHsgY29udGVudF9sZW5ndGggPSBsZW4gfSwKICAgICAgICAgICAgICBwcm9ncmVzc19wcm9jOiAtPihieXRlcykgewogICAgICAgICAgICAgICAgcGVyY2VudCA9IGNvbnRlbnRfbGVuZ3RoID8gKChieXRlcy50b19mIC8gY29udGVudF9sZW5ndGgpICogMTAwKS50b19pIDogMAogICAgICAgICAgICAgICAgcHJvZ3Jlc3MuZXhlY3V0ZV9zY3JpcHQoImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9ncmVzcy1maWxsJykuc3R5bGUud2lkdGggPSAnI3twZXJjZW50fSUnIikKICAgICAgICAgICAgICAgIHByb2dyZXNzLmV4ZWN1dGVfc2NyaXB0KCJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyY2VudCcpLmlubmVyVGV4dCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgKSBkbyB8cmVtb3RlX2ZpbGV8CiAgICAgICAgICAgICAgSU8uY29weV9zdHJlYW0ocmVtb3RlX2ZpbGUsIHRlbXBmaWxlKQogICAgICAgICAgICBlbmQKCiAgICAgICAgICAgIHRlbXBmaWxlLmNsb3NlCiAgICAgICAgICAgIEZpbGVVdGlscy5tdih0ZW1wZmlsZS5wYXRoLCBsb2NhbF9wYXRoKQogICAgICAgICAgICBwcm9ncmVzcy5jbG9zZSBpZiBwcm9ncmVzcy52aXNpYmxlPwoKICAgICAgICAgICAgaWYgRmlsZS5leGlzdD8obG9jYWxfcGF0aCkgJiYgRmlsZS5zaXplKGxvY2FsX3BhdGgpID4gMAogICAgICAgICAgICAgIGRlZmluaXRpb24gPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZGVmaW5pdGlvbnMubG9hZChsb2NhbF9wYXRoLCBhbGxvd19uZXdlcjogdHJ1ZSkKICAgICAgICAgICAgICBpZiBkZWZpbml0aW9uCiAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5wbGFjZV9jb21wb25lbnQoZGVmaW5pdGlvbikKICAgICAgICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINiq2K3ZhdmK2YQg2KfZhNmF2YPZiNmGINio2YbYrNin2K0iKSB1bmxlc3MgaW5zdGFuY2UKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqDvuI8g2KrYudiw2LEg2KrYrdmF2YrZhCDYp9mE2YXZg9mI2YYiKQogICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgVUkubWVzc2FnZWJveCgi4p2MINiq2LnYsNixINiq2K3ZhdmK2YQg2KfZhNmF2YTZgSIpCiAgICAgICAgICAgIGVuZAoKICAgICAgICAgIHJlc2N1ZSA9PiBlCiAgICAgICAgICAgIHRlbXBmaWxlLmNsb3NlIGlmIHRlbXBmaWxlCiAgICAgICAgICAgIHRlbXBmaWxlLnVubGluayBpZiB0ZW1wZmlsZQogICAgICAgICAgICBwcm9ncmVzcy5jbG9zZSBpZiBwcm9ncmVzcy52aXNpYmxlPwogICAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinYwg2K3Yr9irINiu2LfYoyDZgdmKINiq2K3ZhdmK2YQg2KfZhNmF2YPZiNmGOiAje2UubWVzc2FnZX0iKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgIGVsc2UKICAgICAgICBiZWdpbgogICAgICAgICAgaWYgRmlsZS5leGlzdD8obG9jYWxfcGF0aCkgJiYgRmlsZS5zaXplKGxvY2FsX3BhdGgpID4gMAogICAgICAgICAgICBkZWZpbml0aW9uID0gU2tldGNodXAuYWN0aXZlX21vZGVsLmRlZmluaXRpb25zLmxvYWQobG9jYWxfcGF0aCwgYWxsb3dfbmV3ZXI6IHRydWUpCiAgICAgICAgICAgIGlmIGRlZmluaXRpb24KICAgICAgICAgICAgICBpbnN0YW5jZSA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5wbGFjZV9jb21wb25lbnQoZGVmaW5pdGlvbikKICAgICAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYqtit2YXZitmEINin2YTZhdmD2YjZhiDYqNmG2KzYp9itIikgdW5sZXNzIGluc3RhbmNlCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqDvuI8g2KrYudiw2LEg2KrYrdmF2YrZhCDYp9mE2YXZg9mI2YYiKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgVUkubWVzc2FnZWJveCgi4p2MINin2YTZhdmE2YEg2KfZhNmF2K3ZhNmKINiq2KfZhNmBIikKICAgICAgICAgIGVuZAogICAgICAgIHJlc2N1ZSA9PiBlCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinYwg2K3Yr9irINiu2LfYoyDZgdmKINiq2K3ZhdmK2YQg2KfZhNmF2YPZiNmGOiAje2UubWVzc2FnZX0iKQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIGRsZy5hZGRfYWN0aW9uX2NhbGxiYWNrKCJjbGVhckNvbXBvbmVudENhY2hlIikgZG8gfF98CiAgICAgIGJlZ2luCiAgICAgICAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICAgICAgICBpZiBGaWxlLmRpcmVjdG9yeT8oY2FjaGVfZGlyKQogICAgICAgICAgRmlsZVV0aWxzLnJtX3JmKGNhY2hlX2RpcikKICAgICAgICBlbmQKICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDZhdiz2K0g2LDYp9mD2LHYqSDYp9mE2KrYrtiy2YrZhiDYp9mE2YXYpNmC2KoiKQogICAgICByZXNjdWUgPT4gZQogICAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDYrdiv2Ksg2K7Yt9ijINmB2Yog2YXYs9itINin2YTYsNin2YPYsdipOiAje2UubWVzc2FnZX0iKQogICAgICBlbmQKICAgIGVuZAogICAgZGxnLnNob3cKICBlbmQKCiAgdW5sZXNzIGZpbGVfbG9hZGVkPyhfX0ZJTEVfXykKICAgIFVJLm1lbnUoIlBsdWdpbnMiKS5hZGRfaXRlbSgiI3tQTFVHSU5fTkFNRX0gLSDYqtmB2LnZitmEIikgeyBhY3RpdmF0ZSh0cnVlKSB9CiAgICBVSS5tZW51KCJQbHVnaW5zIikuYWRkX2l0ZW0oIiN7UExVR0lOX05BTUV9IC0g2YXYudix2YEg2KfZhNis2YfYp9iyIikgeyBVSS5tZXNzYWdlYm94KCLwn4aUINmF2LnYsdmBINin2YTYrNmH2KfYsjpcbiIgKyBnZXRfZGV2aWNlX2lkKSB9CiAgICBVSS5tZW51KCJQbHVnaW5zIikuYWRkX2l0ZW0oIk1IREVTSUdOIC0g2YXYs9itINin2YTYsNin2YPYsdipIikgZG8KICAgICAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICAgICAgaWYgRmlsZS5kaXJlY3Rvcnk/KGNhY2hlX2RpcikKICAgICAgICBGaWxlVXRpbHMucm1fcmYoY2FjaGVfZGlyKQogICAgICBlbmQKICAgICAgVUkubWVzc2FnZWJveCgi4pyFINiq2YUg2YXYs9itINiw2KfZg9ix2Kkg2KfZhNiq2K7YstmK2YYg2KfZhNmF2KTZgtiqIikKICAgIGVuZAoKICAgIHRvb2xiYXIgPSBVSTo6VG9vbGJhci5uZXcoUExVR0lOX05BTUUpCiAgICBjbWQgPSBVSTo6Q29tbWFuZC5uZXcoItmF2YPYqtio2KkgI3tQTFVHSU5fTkFNRX0iKSB7IHNob3dfbGlicmFyeSB9CgogICAgaWNvbl9wYXRoID0gRmlsZS5qb2luKFBMVUdJTl9ESVIsICJpY29uLnBuZyIpIHJlc2N1ZSBuaWwKICAgIGlmIEZpbGUuZXhpc3Q/KGljb25fcGF0aCkKICAgICAgY21kLnNtYWxsX2ljb24gPSBpY29uX3BhdGgKICAgICAgY21kLmxhcmdlX2ljb24gPSBpY29uX3BhdGgKICAgIGVuZAogICAgY21kLnRvb2x0aXAgPSAi2YHYqtitINmF2YPYqtio2Kkg2YXZg9mI2YbYp9iqIE1IREVTSUdOIgogICAgdG9vbGJhci5hZGRfaXRlbShjbWQpCgogICAgY21kX3VuaXF1ZSA9IFVJOjpDb21tYW5kLm5ldygi2KzYudmEINin2YTZhdmD2YjZhtin2Kog2YHYsdmK2K/YqSIpIHsKICAgICAgbW9kdWxlIE1IREVTSUdOX1VOSVFVSUZZCiAgICAgICAgZGVmIHNlbGYubWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUoZW50aXRpZXMpCiAgICAgICAgICBlbnRpdGllcy5ncmVwKFNrZXRjaHVwOjpDb21wb25lbnRJbnN0YW5jZSkuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgICAgIGluc3RhbmNlLm1ha2VfdW5pcXVlCiAgICAgICAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKGluc3RhbmNlLmRlZmluaXRpb24uZW50aXRpZXMpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBkZWYgc2VsZi5tYWtlX2RlZmluaXRpb25zX3VuaXF1ZQogICAgICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgICAgIG1vZGVsLmRlZmluaXRpb25zLmVhY2ggZG8gfGRlZmluaXRpb258CiAgICAgICAgICAgIG5leHQgaWYgZGVmaW5pdGlvbi5ncm91cD8gfHwgZGVmaW5pdGlvbi5pbWFnZT8KICAgICAgICAgICAgZGVmaW5pdGlvbi5pbnN0YW5jZXMuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgICAgICAgaW5zdGFuY2UubWFrZV91bmlxdWUKICAgICAgICAgICAgICBtYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShpbnN0YW5jZS5kZWZpbml0aW9uLmVudGl0aWVzKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIGRlZiBzZWxmLnJ1bl91bmlxdWlmeQogICAgICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgICAgIG1vZGVsLnN0YXJ0X29wZXJhdGlvbigi2KzYudmEINis2YXZiti5INin2YTZhdmD2YjZhtin2Kog2YHYsdmK2K/YqSIsIHRydWUpCiAgICAgICAgICBtYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShtb2RlbC5lbnRpdGllcykKICAgICAgICAgIG1ha2VfZGVmaW5pdGlvbnNfdW5pcXVlCiAgICAgICAgICBtb2RlbC5jb21taXRfb3BlcmF0aW9uCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYrNi52YQg2KzZhdmK2Lkg2KfZhNmF2YPZiNmG2KfYqiDZgdix2YrYr9ipINio2YbYrNin2K0iKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgTUhERVNJR05fVU5JUVVJRlkucnVuX3VuaXF1aWZ5CiAgICB9CiAgICB1bmlxdWVfaWNvbl9wYXRoID0gRmlsZS5qb2luKFBMVUdJTl9ESVIsICJ1bmlxdWVfaWNvbi5wbmciKSByZXNjdWUgbmlsCiAgICBpZiBGaWxlLmV4aXN0Pyh1bmlxdWVfaWNvbl9wYXRoKQogICAgICBjbWRfdW5pcXVlLnNtYWxsX2ljb24gPSB1bmlxdWVfaWNvbl9wYXRoCiAgICAgIGNtZF91bmlxdWUubGFyZ2VfaWNvbiA9IHVuaXF1ZV9pY29uX3BhdGgKICAgIGVuZAogICAgY21kX3VuaXF1ZS50b29sdGlwID0gItis2LnZhCDYrNmF2YrYuSDYp9mE2YXZg9mI2YbYp9iqINmB2Yog2KfZhNmG2YXZiNiw2Kwg2YHYsdmK2K/YqSIKICAgIHRvb2xiYXIuYWRkX2l0ZW0oY21kX3VuaXF1ZSkKCiAgICB0b29sYmFyLnJlc3RvcmUKICAgIGZpbGVfbG9hZGVkKF9fRklMRV9fKQogIGVuZAplbmQ="
}
