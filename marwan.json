{
  "main_code": "IyBlbmNvZGluZzogVVRGLTgKcmVxdWlyZSAnc2tldGNodXAucmInCnJlcXVpcmUgJ25ldC9odHRwJwpyZXF1aXJlICd1cmknCnJlcXVpcmUgJ2pzb24nCnJlcXVpcmUgJ3NlY3VyZXJhbmRvbScKcmVxdWlyZSAnb3Blbi11cmknCnJlcXVpcmUgJ3RtcGRpcicKcmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICd0ZW1wZmlsZScKcmVxdWlyZSAnZGlnZXN0JwpyZXF1aXJlICdmaWxldXRpbHMnCnJlcXVpcmUgJ3psaWInCgptb2R1bGUgTUhERVNJR04KICBQTFVHSU5fTkFNRSA9ICJNSERFU0lHTiIKICBBQ0NPVU5UU19BUElfVVJMID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9tYXJ3YW5hZGVsZWx0YWhhbi1zdWRvL0FQSTEyMy9yZWZzL2hlYWRzL21haW4vZW1haWwuanNvbiIKICBWQUxJREFUSU9OX0FQSV9VUkwgPSAiaHR0cHM6Ly9tYWhtb3VkZGVzaWduLmNvbS93cC1qc29uL21oZGVzaWduL1Y0L3ZhbGlkYXRlIgoKICBPUEVOX1RJTUVPVVQgPSA4CiAgUkVBRF9USU1FT1VUID0gMTIKCiAgIyDYpdmE2LrYp9ihINin2YTYqtit2YLZgiDYqNix2YLZhSDYp9mE2KzZh9in2LIg2YjYp9iz2KrYrtiv2KfZhSDZhdi52LHZkdmBINmF2KTZgtiqCiAgZGVmIHNlbGYuZ2V0X2RldmljZV9pZAogICAgIyDYp9iz2KrYrtiv2KfZhSDZhdi52LHZkdmBINmF2KTZgtiqINmE2YTYrNmE2LPYqSDZgdmC2LcKICAgICJ0ZW1wX3Nlc3Npb25fI3tUaW1lLm5vdy50b19pfSIKICBlbmQKCiAgZGVmIHNlbGYuaHVtYW5pemVfc2Vjb25kcyh0b3RhbCkKICAgIHRvdGFsID0gdG90YWwudG9faQogICAgbSwgcyA9IHRvdGFsLmRpdm1vZCg2MCkKICAgIGgsIG0gPSBtLmRpdm1vZCg2MCkKICAgIHBhcnRzID0gW10KICAgIHBhcnRzIDw8ICIje2h9INiz2KfYudipIiAgIGlmIGggPiAwCiAgICBwYXJ0cyA8PCAiI3ttfSDYr9mC2YrZgtipIiAgaWYgbSA+IDAKICAgIHBhcnRzIDw8ICIje3N9INir2KfZhtmK2KkiICBpZiBzID4gMCB8fCBwYXJ0cy5lbXB0eT8KICAgIHBhcnRzLmpvaW4oJyDZiCAnKQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g2KfZhNiq2K3ZgtmCINmF2YYg2K3Ys9in2KjYp9iqIEdpdEh1YiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgZGVmIHNlbGYuZmV0Y2hfZ2l0aHViX2FjY291bnRzCiAgICBiZWdpbgogICAgICB1cmkgPSBVUkkucGFyc2UoQUNDT1VOVFNfQVBJX1VSTCkKICAgICAgaHR0cCA9IE5ldDo6SFRUUC5uZXcodXJpLmhvc3QsIHVyaS5wb3J0KQogICAgICBodHRwLnVzZV9zc2wgPSAodXJpLnNjaGVtZSA9PSAnaHR0cHMnKQogICAgICBodHRwLm9wZW5fdGltZW91dCA9IE9QRU5fVElNRU9VVAogICAgICBodHRwLnJlYWRfdGltZW91dCA9IFJFQURfVElNRU9VVAoKICAgICAgcmVxID0gTmV0OjpIVFRQOjpHZXQubmV3KHVyaS5yZXF1ZXN0X3VyaSkKICAgICAgcmVxWydVc2VyLUFnZW50J10gPSAiU2tldGNoVXAvI3tTa2V0Y2h1cC52ZXJzaW9ufSBSdWJ5LyN7UlVCWV9WRVJTSU9OfSIKICAgICAgCiAgICAgIHJlcyA9IGh0dHAucmVxdWVzdChyZXEpCiAgICAgIAogICAgICBpZiByZXMuY29kZS50b19pID09IDIwMAogICAgICAgIEpTT04ucGFyc2UocmVzLmJvZHkpCiAgICAgIGVsc2UKICAgICAgICBbXQogICAgICBlbmQKICAgIHJlc2N1ZSA9PiBlCiAgICAgIHB1dHMgIkVycm9yIGZldGNoaW5nIEdpdEh1YiBhY2NvdW50czogI3tlLm1lc3NhZ2V9IgogICAgICBbXQogICAgZW5kCiAgZW5kCgogIGRlZiBzZWxmLnZhbGlkYXRlX3dpdGhfZ2l0aHViX2FjY291bnRzKGVtYWlsLCBsaWNlbnNlKQogICAgYWNjb3VudHMgPSBmZXRjaF9naXRodWJfYWNjb3VudHMKICAgIAogICAgIyDYp9mE2KrYrdmC2YIg2YXZhiDZiNis2YjYryDYp9mE2K3Ys9in2Kgg2YHZiiDYp9mE2YLYp9im2YXYqQogICAgdmFsaWRfYWNjb3VudCA9IGFjY291bnRzLmZpbmQgZG8gfGFjY291bnR8CiAgICAgIGFjY291bnRbImVtYWlsIl0gPT0gZW1haWwgJiYgYWNjb3VudFsicGFzc3dvcmQiXSA9PSBsaWNlbnNlCiAgICBlbmQKICAgIAogICAgdmFsaWRfYWNjb3VudCA/IHRydWUgOiBmYWxzZQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g2KrZgdi52YrZhCDYp9mE2YXZg9iq2KjYqSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLmFjdGl2YXRlKGZvcmNlX3Byb21wdCA9IHRydWUpCiAgICBlbWFpbCAgID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiKSAgIHx8ICIiCiAgICBsaWNlbnNlID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGljZW5zZSIpIHx8ICIiCgogICAgaWYgZm9yY2VfcHJvbXB0IHx8IGVtYWlsLmVtcHR5PyB8fCBsaWNlbnNlLmVtcHR5PwogICAgICBpbnB1dCA9IFVJLmlucHV0Ym94KFsi2KPYr9iu2YQg2KfZhNio2LHZitivINin2YTYpdmE2YPYqtix2YjZhtmKIiwgItij2K/YrtmEINmF2YHYqtin2K0g2KfZhNiq2LHYrtmK2LUiXSwgW2VtYWlsLCBsaWNlbnNlXSwgItiq2YHYudmK2YQgTUhERVNJR04iKQogICAgICByZXR1cm4gZmFsc2UgdW5sZXNzIGlucHV0CiAgICAgIGVtYWlsLCBsaWNlbnNlID0gaW5wdXQKICAgIGVuZAoKICAgICMg2KfZhNmF2K3Yp9mI2YTYqSDYp9mE2KPZiNmE2Yk6INin2YTYqtit2YLZgiDZhdmGINit2LPYp9io2KfYqiBHaXRIdWIKICAgIGlmIHZhbGlkYXRlX3dpdGhfZ2l0aHViX2FjY291bnRzKGVtYWlsLCBsaWNlbnNlKQogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiLCBlbWFpbCkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiLCBsaWNlbnNlKQogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiYWN0aXZhdGVkX29uY2UiLCB0cnVlKQogICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZ2l0aHViX2FjdGl2YXRlZCIsIHRydWUpCiAgICAgIAogICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYp9mE2KrZgdi52YrZhCDYqNmG2KzYp9itIChHaXRIdWIgQWNjb3VudCkiKSBpZiBmb3JjZV9wcm9tcHQKICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAoKICAgICMg2KfZhNmF2K3Yp9mI2YTYqSDYp9mE2KvYp9mG2YrYqTog2KfZhNiq2K3ZgtmCINmF2YYgQVBJINin2YTYo9i12YTZiiAo2KfYrtiq2YrYp9ix2YopCiAgICBiZWdpbgogICAgICBkZXZpY2UgPSBnZXRfZGV2aWNlX2lkCiAgICAgIHVyaSAgICA9IFVSSShWQUxJREFUSU9OX0FQSV9VUkwpCgogICAgICBodHRwID0gTmV0OjpIVFRQLm5ldyh1cmkuaG9zdCwgdXJpLnBvcnQpCiAgICAgIGh0dHAudXNlX3NzbCAgICAgPSAodXJpLnNjaGVtZSA9PSAnaHR0cHMnKQogICAgICBodHRwLm9wZW5fdGltZW91dCA9IE9QRU5fVElNRU9VVAogICAgICBodHRwLnJlYWRfdGltZW91dCA9IFJFQURfVElNRU9VVAoKICAgICAgcmVxID0gTmV0OjpIVFRQOjpQb3N0Lm5ldyh1cmkucmVxdWVzdF91cmkpCiAgICAgIHJlcVsnQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbicKICAgICAgcmVxWydVc2VyLUFnZW50J10gICAgPSAiU2tldGNoVXAvI3tTa2V0Y2h1cC52ZXJzaW9ufSBSdWJ5LyN7UlVCWV9WRVJTSU9OfSAje1BMVUdJTl9OQU1FfSIKICAgICAgcmVxLmJvZHkgPSB7IGVtYWlsOiBlbWFpbCwgbGljZW5zZTogbGljZW5zZSwgZGV2aWNlX2lkOiBkZXZpY2UgfS50b19qc29uCgogICAgICByZXMgID0gaHR0cC5yZXF1ZXN0KHJlcSkKICAgICAgY29kZSA9IHJlcy5jb2RlLnRvX2kKICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVzLmJvZHkpIHJlc2N1ZSB7fQoKICAgICAgaWYgY29kZSA9PSAyMDAgJiYgZGF0YVsndmFsaWQnXQogICAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbWFpbCIsIGVtYWlsKQogICAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJsaWNlbnNlIiwgbGljZW5zZSkKICAgICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiYWN0aXZhdGVkX29uY2UiLCB0cnVlKQoKICAgICAgICBpZiBkYXRhLmtleT8oJ2VuZHNfYXQnKSAmJiAhZGF0YVsnZW5kc19hdCddLnRvX3Muc3RyaXAuZW1wdHk/CiAgICAgICAgICBTa2V0Y2h1cC53cml0ZV9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW5kc19hdCIsIGRhdGFbJ2VuZHNfYXQnXS50b19zKQogICAgICAgIGVuZAoKICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYp9mE2KrZgdi52YrZhCDYqNmG2KzYp9itIikgaWYgZm9yY2VfcHJvbXB0CiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgZW5kCgogICAgcmVzY3VlID0+IGUKICAgICAgcHV0cyAiQVBJIHZhbGlkYXRpb24gZmFpbGVkOiAje2UubWVzc2FnZX0iCiAgICBlbmQKCiAgICAjINil2LDYpyDZgdi02YQg2YPZhNinINin2YTYqtit2YLZgtmK2YYKICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDYp9mE2KjYsdmK2K8g2KfZhNil2YTZg9iq2LHZiNmG2Yog2KPZiCDZhdmB2KrYp9itINin2YTYqtix2K7Ziti1INi62YrYsSDYtdit2YrYrS5cbtmK2LHYrNmJINin2YTYqtit2YLZgiDZhdmGINin2YTYqNmK2KfZhtin2Kog2YjYp9mE2YXYrdin2YjZhNipINmF2LHYqSDYo9iu2LHZiS4iKQogICAgZmFsc2UKICBlbmQKCiAgIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09INmF2LnZhNmI2YXYp9iqINin2YTZhdiz2KrYrtiv2YUgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLnNob3dfdXNlcl9pbmZvCiAgICBlbWFpbCAgID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiKS50b19zCiAgICBsaWNlbnNlID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAibGljZW5zZSIpLnRvX3MKICAgIGVuZHNfYXQgPSBTa2V0Y2h1cC5yZWFkX2RlZmF1bHQoUExVR0lOX05BTUUsICJlbmRzX2F0IikudG9fcwogICAgZ2l0aHViX2FjdGl2YXRlZCA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImdpdGh1Yl9hY3RpdmF0ZWQiKSB8fCBmYWxzZQoKICAgIGlmIGVtYWlsLmVtcHR5PyB8fCBsaWNlbnNlLmVtcHR5PwogICAgICBVSS5tZXNzYWdlYm94KCLinYwg2YTZhSDZitiq2YUg2KrZgdi52YrZhCDYp9mE2YXZg9iq2KjYqSDYqNi52K8uXG7Yp9mG2KrZgtmEINil2YTZiTogUGx1Z2lucyA+IE1IREVTSUdOIC0g2KrZgdi52YrZhCIpCiAgICAgIHJldHVybgogICAgZW5kCgogICAgZW5kc190eHQgPSBlbmRzX2F0LnN0cmlwLmVtcHR5PyA/ICLYqtmB2LnZitmEINiv2KfYptmFIiA6IGVuZHNfYXQKICAgIGFjdGl2YXRpb25fdHlwZSA9IGdpdGh1Yl9hY3RpdmF0ZWQgPyAiR2l0SHViIEFjY291bnQiIDogIk9mZmljaWFsIExpY2Vuc2UiCgogICAgVUkubWVzc2FnZWJveCgKICAgICAgIvCfkaQg2YXYudmE2YjZhdin2Kog2KfZhNmF2LTYqtix2YMgKE1IREVTSUdOKVxuXG4iIFwKICAgICAgIvCfk6cg2KfZhNio2LHZitivINin2YTYpdmE2YPYqtix2YjZhtmKOlxuI3tlbWFpbH1cblxuIiBcCiAgICAgICLwn5SRINmF2YHYqtin2K0g2KfZhNiq2LHYrtmK2LU6XG4je2xpY2Vuc2V9XG5cbiIgXAogICAgICAi8J+OryDZhtmI2Lkg2KfZhNiq2YHYudmK2YQ6XG4je2FjdGl2YXRpb25fdHlwZX1cblxuIiBcCiAgICAgICLij7Mg2YrZhtiq2YfZiiDYp9mE2KrZgdi52YrZhDpcbiN7ZW5kc190eHR9IgogICAgKQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0g2K3Yp9mE2Kkg2KfZhNiq2YHYudmK2YQgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIGRlZiBzZWxmLmFjdGl2YXRlZD8KICAgICMg2KfZhNiq2K3ZgtmCINil2LDYpyDZg9in2YYg2YXZgdi52YQg2LnYqNixIEdpdEh1YgogICAgZ2l0aHViX2FjdGl2YXRlZCA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImdpdGh1Yl9hY3RpdmF0ZWQiKSB8fCBmYWxzZQogICAgcmV0dXJuIHRydWUgaWYgZ2l0aHViX2FjdGl2YXRlZAogICAgCiAgICAjINij2Ygg2KfZhNiq2K3ZgtmCINmF2YYg2KfZhNiq2YHYudmK2YQg2KfZhNi52KfYr9mKCiAgICBlbWFpbCA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImVtYWlsIikudG9fcwogICAgbGljZW5zZSA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiKS50b19zCiAgICBhY3RpdmF0ZWRfb25jZSA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImFjdGl2YXRlZF9vbmNlIikgfHwgZmFsc2UKICAgIAogICAgIWVtYWlsLmVtcHR5PyAmJiAhbGljZW5zZS5lbXB0eT8gJiYgYWN0aXZhdGVkX29uY2UKICBlbmQKCiAgIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09INio2KfZgtmKINin2YTZg9mI2K8g2KjYr9mI2YYg2KrYutmK2YrYsSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgIyAo2YrYrdiq2YjZiiDYudmE2Ykg2KzZhdmK2Lkg2KfZhNiv2YjYp9mEINmI2KfZhNij2K/ZiNin2Kog2KfZhNij2K7YsdmJINmF2YYg2KfZhNmD2YjYryDYp9mE2KPYtdmE2YopCiAgCiAgUExVR0lOX0RJUiA9CiAgICBiZWdpbgogICAgICBpZiBPYmplY3QuY29uc3RfZGVmaW5lZD8oOlBMVUdJTl9ESVIpICYmIDo6UExVR0lOX0RJUiAmJiAhOjpQTFVHSU5fRElSLnRvX3Muc3RyaXAuZW1wdHk/CiAgICAgICAgOjpQTFVHSU5fRElSCiAgICAgIGVsc2UKICAgICAgICBGaWxlLmV4cGFuZF9wYXRoKEZpbGUuZGlybmFtZShfX0ZJTEVfXykpCiAgICAgIGVuZAogICAgcmVzY3VlCiAgICAgIG5pbAogICAgZW5kCgogIENPTVBPTkVOVFMgPSBiZWdpbgogICAgdXJsID0gImh0dHBzOi8vbWFobW91ZGRlc2lnbi5jb20vU0tFVENIVVAvY29tcG9uZW50cy1WNC5qc29uIgogICAganNvbl9yYXcgPSBVUkkub3Blbih1cmwpLnJlYWQKICAgIGpzb25fZGF0YSA9IEpTT04ucGFyc2UoanNvbl9yYXcpCiAgICBkZWNvZGVkX2pzb24gPSBCYXNlNjQuZGVjb2RlNjQoanNvbl9kYXRhWyJkYXRhIl0pCiAgICBKU09OLnBhcnNlKGRlY29kZWRfanNvbiwgc3ltYm9saXplX25hbWVzOiB0cnVlKQogIHJlc2N1ZSA9PiBlCiAgICBVSS5tZXNzYWdlYm94KCLimqAg2K7Yt9ijINmB2Yog2KrYrdmF2YrZhCDYp9mE2YXZg9iq2KjYqTogI3tlLm1lc3NhZ2V9IikKICAgIFtdCiAgZW5kCgogIGRlZiBzZWxmLmNsZWFyX2NhY2hlCiAgICBjYWNoZV9kaXIgPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZGVzaWduX2NhY2hlXzEiKQogICAgRmlsZVV0aWxzLnJtX3JmKGNhY2hlX2RpcikgaWYgRmlsZS5kaXJlY3Rvcnk/KGNhY2hlX2RpcikKICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINmF2LPYrSDYsNin2YPYsdipINin2YTYqtiu2LLZitmGINin2YTZhdik2YLYqi4iKQogIHJlc2N1ZSA9PiBlCiAgICBVSS5tZXNzYWdlYm94KCLimqAg2K3Yr9irINiu2LfYoyDYo9ir2YbYp9ihINmF2LPYrSDYp9mE2KrYrtiy2YrZhiDYp9mE2YXYpNmC2Ko6ICN7ZS5tZXNzYWdlfSIpCiAgZW5kCgogIGRlZiBzZWxmLmR5bmFtaWM/KGluc3RhbmNlKQogICAgcmV0dXJuIGZhbHNlIHVubGVzcyBpbnN0YW5jZS5pc19hPyhTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCiAgICAhIWluc3RhbmNlLmF0dHJpYnV0ZV9kaWN0aW9uYXJ5KCJkeW5hbWljX2F0dHJpYnV0ZXMiLCBmYWxzZSkKICByZXNjdWUKICAgIGZhbHNlCiAgZW5kCgogIGRlZiBzZWxmLnVud3JhcF90b19keW5hbWljIShpbnN0YW5jZSkKICAgIHJldHVybiBpbnN0YW5jZSBpZiBkeW5hbWljPyhpbnN0YW5jZSkKCiAgICBlbnRzID0gaW5zdGFuY2UuZGVmaW5pdGlvbi5lbnRpdGllcy50b19hCiAgICBjaGlsZHJlbiA9IGVudHMuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCiAgICBkeW5fY2hpbGRyZW4gPSBjaGlsZHJlbi5zZWxlY3Qge3xjfCBkeW5hbWljPyhjKSB9CiAgICByZXR1cm4gaW5zdGFuY2UgaWYgZHluX2NoaWxkcmVuLmVtcHR5PwoKICAgIG1vZGVsID0gU2tldGNodXAuYWN0aXZlX21vZGVsCiAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oIlVud3JhcCBEeW5hbWljIENvbXBvbmVudCIsIHRydWUpCiAgICBiZWdpbgogICAgICBwYXJlbnRfZW50cyA9IGluc3RhbmNlLnBhcmVudC5lbnRpdGllcwogICAgICBiZWZvcmVfaWRzID0gcGFyZW50X2VudHMudG9fYS5tYXAoJjplbnRpdHlJRCkKCiAgICAgIGluc3RhbmNlLmV4cGxvZGUKCiAgICAgIGFmdGVyID0gcGFyZW50X2VudHMudG9fYS5yZWplY3QgeyB8ZXwgYmVmb3JlX2lkcy5pbmNsdWRlPyhlLmVudGl0eUlEKSB9CiAgICAgIGFmdGVyX2luc3RzID0gYWZ0ZXIuZ3JlcChTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpCgogICAgICBkeW4gPSBhZnRlcl9pbnN0cy5maW5kIHsgfHh8IGR5bmFtaWM/KHgpIH0gfHwgYWZ0ZXJfaW5zdHMuZmlyc3QKICAgICAgbW9kZWwuc2VsZWN0aW9uLmNsZWFyCiAgICAgIG1vZGVsLnNlbGVjdGlvbi5hZGQoZHluKSBpZiBkeW4KICAgICAgbW9kZWwuY29tbWl0X29wZXJhdGlvbgogICAgICBkeW4gfHwgaW5zdGFuY2UKICAgIHJlc2N1ZQogICAgICBtb2RlbC5hYm9ydF9vcGVyYXRpb24gcmVzY3VlIG5pbAogICAgICBpbnN0YW5jZQogICAgZW5kCiAgZW5kCgogIGNsYXNzIFBsYWNlQW5kVW53cmFwT2JzZXJ2ZXIgPCBTa2V0Y2h1cDo6RW50aXRpZXNPYnNlcnZlcgogICAgZGVmIGluaXRpYWxpemUodGFyZ2V0X2RlZikKICAgICAgQHRhcmdldF9kZWYgPSB0YXJnZXRfZGVmCiAgICAgIEBkb25lID0gZmFsc2UKICAgIGVuZAoKICAgIGRlZiBvbkVsZW1lbnRBZGRlZChlbnRpdGllcywgZW50aXR5KQogICAgICByZXR1cm4gaWYgQGRvbmUKICAgICAgcmV0dXJuIHVubGVzcyBlbnRpdHkuaXNfYT8oU2tldGNodXA6OkNvbXBvbmVudEluc3RhbmNlKQogICAgICByZXR1cm4gdW5sZXNzIGVudGl0eS5kZWZpbml0aW9uID09IEB0YXJnZXRfZGVmCgogICAgICBAZG9uZSA9IHRydWUKICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKCiAgICAgIFVJLnN0YXJ0X3RpbWVyKDAuMCwgZmFsc2UpIGRvCiAgICAgICAgYmVnaW4KICAgICAgICAgIGluc3QyID0gTUhERVNJR04udW53cmFwX3RvX2R5bmFtaWMhKGVudGl0eSkKICAgICAgICAgIG1vZGVsLnNlbGVjdGlvbi5jbGVhcgogICAgICAgICAgbW9kZWwuc2VsZWN0aW9uLmFkZChpbnN0MikgaWYgaW5zdDIKICAgICAgICByZXNjdWUKICAgICAgICBlbnN1cmUKICAgICAgICAgIGJlZ2luCiAgICAgICAgICAgIGVudGl0aWVzLnJlbW92ZV9vYnNlcnZlcihzZWxmKQogICAgICAgICAgcmVzY3VlCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuaW5zdGFsbF9wbGFjZV9vYnNlcnZlcl9mb3IoZGVmaW5pdGlvbikKICAgIGVudHMgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZW50aXRpZXMKICAgIG9icyA9IFBsYWNlQW5kVW53cmFwT2JzZXJ2ZXIubmV3KGRlZmluaXRpb24pCiAgICBlbnRzLmFkZF9vYnNlcnZlcihvYnMpCgogICAgVUkuc3RhcnRfdGltZXIoMjAuMCwgZmFsc2UpIGRvCiAgICAgIGJlZ2luCiAgICAgICAgZW50cy5yZW1vdmVfb2JzZXJ2ZXIob2JzKQogICAgICByZXNjdWUKICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuZmV0Y2hfZGVmaW5pdGlvbl9hc3luYyhjb21wLCAmYmxvY2spCiAgICBiZWdpbgogICAgICB1cmwgPSBVUkkucGFyc2UoY29tcFs6dXJsXS50b19zKQogICAgICBjYWNoZV9kaXIgPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZGVzaWduX2NhY2hlXzEiKQogICAgICBGaWxlVXRpbHMubWtkaXJfcChjYWNoZV9kaXIpCgogICAgICBoYXNoX25hbWUgID0gRGlnZXN0OjpTSEEyNTYuaGV4ZGlnZXN0KHVybC50b19zKVswLi4xNl0gKyAiLnNrcCIKICAgICAgbG9jYWxfcGF0aCA9IEZpbGUuam9pbihjYWNoZV9kaXIsIGhhc2hfbmFtZSkKICAgICAgbW9kZWwgICAgICA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbAoKICAgICAgaWYgRmlsZS5leGlzdD8obG9jYWxfcGF0aCkgJiYgRmlsZS5zaXplKGxvY2FsX3BhdGgpID4gMAogICAgICAgIGRlZmluaXRpb24gPSBtb2RlbC5kZWZpbml0aW9ucy5sb2FkKGxvY2FsX3BhdGgsIGFsbG93X25ld2VyOiB0cnVlKQogICAgICAgIGJsb2NrLmNhbGwoZGVmaW5pdGlvbikgaWYgYmxvY2sKICAgICAgICByZXR1cm4KICAgICAgZW5kCgogICAgICBwcm9ncmVzcyA9IFVJOjpIdG1sRGlhbG9nLm5ldyh7CiAgICAgICAgOmRpYWxvZ190aXRsZSA9PiAi2KzYp9ixINin2YTYqtit2YXZitmELi4uIiwKICAgICAgICA6cHJlZmVyZW5jZXNfa2V5ID0+ICJtaGRlc2lnbl9wcm9ncmVzcyIsCiAgICAgICAgOnNjcm9sbGFibGUgPT4gZmFsc2UsCiAgICAgICAgOnJlc2l6YWJsZSA9PiBmYWxzZSwKICAgICAgICA6d2lkdGggPT4gMzAwLAogICAgICAgIDpoZWlnaHQgPT4gMTUwCiAgICAgIH0pCgogICAgICBwcm9ncmVzcy5zZXRfaHRtbCA8PC1IVE1MCiAgICAgICAgPGh0bWw+PGhlYWQ+CiAgICAgICAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICAgICAgICA8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVRhamF3YWw6d2dodEA0MDA7NzAwJmRpc3BsYXk9c3dhcCIgcmVsPSJzdHlsZXNoZWV0Ij4KICAgICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OidUYWphd2FsJyxzYW5zLXNlcmlmOyB0ZXh0LWFsaWduOmNlbnRlcjsgbWFyZ2luOjA7IHBhZGRpbmc6MjBweDsgZGlyZWN0aW9uOnJ0bDsgfQogICAgICAgICAgICBoMyB7IG1hcmdpbjogMTBweCAwOyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1iYXIgeyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAyMHB4OyBiYWNrZ3JvdW5kOiAjZGRkOyBib3JkZXItcmFkaXVzOiAxMHB4OyBvdmVyZmxvdzogaGlkZGVuOyBtYXJnaW4tdG9wOiAxMHB4OyB9CiAgICAgICAgICAgICNwcm9ncmVzcy1maWxsIHsgaGVpZ2h0OiAxMDAlOyB3aWR0aDogMCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IHRyYW5zaXRpb246IHdpZHRoIDAuMnMgZWFzZTsgfQogICAgICAgICAgICAjcGVyY2VudCB7IG1hcmdpbi10b3A6IDhweDsgZm9udC1zaXplOiAxNHB4OyB9CiAgICAgICAgICA8L3N0eWxlPgogICAgICAgIDwvaGVhZD48Ym9keT4KICAgICAgICAgIDxoMz7YrNin2LEg2KrYrdmF2YrZhCDYp9mE2LnZhti12LEuLi48L2gzPgogICAgICAgICAgPGRpdiBpZD0icHJvZ3Jlc3MtYmFyIj48ZGl2IGlkPSJwcm9ncmVzcy1maWxsIj48L2Rpdj48L2Rpdj4KICAgICAgICAgIDxkaXYgaWQ9InBlcmNlbnQiPjAlPC9kaXY+CiAgICAgICAgPC9ib2R5PjwvaHRtbD4KICAgICAgSFRNTAoKICAgICAgcHJvZ3Jlc3Muc2hvdwoKICAgICAgVUkuc3RhcnRfdGltZXIoMC4xLCBmYWxzZSkgZG8KICAgICAgICB0ZW1wZmlsZSA9IG5pbAogICAgICAgIGJlZ2luCiAgICAgICAgICBjb250ZW50X2xlbmd0aCA9IG5pbAogICAgICAgICAgdGVtcGZpbGUgPSBUZW1wZmlsZS5uZXcoIm1oY29tcG9uZW50IikKCiAgICAgICAgICBVUkkub3Blbih1cmwsCiAgICAgICAgICAgIGNvbnRlbnRfbGVuZ3RoX3Byb2M6IC0+KGxlbikgeyBjb250ZW50X2xlbmd0aCA9IGxlbiB9LAogICAgICAgICAgICBwcm9ncmVzc19wcm9jOiAtPihieXRlcykgewogICAgICAgICAgICAgIHBlcmNlbnQgPSBjb250ZW50X2xlbmd0aCA/ICgoYnl0ZXMudG9fZiAvIGNvbnRlbnRfbGVuZ3RoKSAqIDEwMCkudG9faSA6IDAKICAgICAgICAgICAgICBwcm9ncmVzcy5leGVjdXRlX3NjcmlwdCgiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzLWZpbGwnKS5zdHlsZS53aWR0aCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICAgIHByb2dyZXNzLmV4ZWN1dGVfc2NyaXB0KCJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVyY2VudCcpLmlubmVyVGV4dCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICB9CiAgICAgICAgICApIGRvIHxyZW1vdGVfZmlsZXwKICAgICAgICAgICAgSU8uY29weV9zdHJlYW0ocmVtb3RlX2ZpbGUsIHRlbXBmaWxlKQogICAgICAgICAgZW5kCgogICAgICAgICAgdGVtcGZpbGUuY2xvc2UKICAgICAgICAgIEZpbGVVdGlscy5tdih0ZW1wZmlsZS5wYXRoLCBsb2NhbF9wYXRoKQogICAgICAgICAgcHJvZ3Jlc3MuY2xvc2UgaWYgcHJvZ3Jlc3MudmlzaWJsZT8KCiAgICAgICAgICBpZiBGaWxlLmV4aXN0Pyhsb2NhbF9wYXRoKSAmJiBGaWxlLnNpemUobG9jYWxfcGF0aCkgPiAwCiAgICAgICAgICAgIGRlZmluaXRpb24gPSBtb2RlbC5kZWZpbml0aW9ucy5sb2FkKGxvY2FsX3BhdGgsIGFsbG93X25ld2VyOiB0cnVlKQogICAgICAgICAgICBibG9jay5jYWxsKGRlZmluaXRpb24pIGlmIGJsb2NrCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDZgdi02YQg2KrYrdmF2YrZhCDYp9mE2YXZhNmBINmF2YYg2KfZhNiz2YrYsdmB2LEuIikKICAgICAgICAgICAgYmxvY2suY2FsbChuaWwpIGlmIGJsb2NrCiAgICAgICAgICBlbmQKCiAgICAgICAgcmVzY3VlID0+IGUKICAgICAgICAgIGJlZ2luCiAgICAgICAgICAgIHRlbXBmaWxlLmNsb3NlIGlmIHRlbXBmaWxlCiAgICAgICAgICAgIHRlbXBmaWxlLnVubGluayBpZiB0ZW1wZmlsZQogICAgICAgICAgcmVzY3VlCiAgICAgICAgICBlbmQKICAgICAgICAgIHByb2dyZXNzLmNsb3NlIGlmIHByb2dyZXNzLnZpc2libGU/CiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqAg2K3Yr9irINiu2LfYoyDYo9ir2YbYp9ihINiq2K3ZhdmK2YQg2KfZhNi52YbYtdixOiAje2UubWVzc2FnZX0iKQogICAgICAgICAgYmxvY2suY2FsbChuaWwpIGlmIGJsb2NrCiAgICAgICAgZW5kCiAgICAgIGVuZAoKICAgIHJlc2N1ZSA9PiBlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKaoCDYrdiv2Ksg2K7Yt9ijOiAje2UubWVzc2FnZX0iKQogICAgICBibG9jay5jYWxsKG5pbCkgaWYgYmxvY2sKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5zYWZlX2xvYWRfbG9jYWwoZmlsZV9uYW1lKQogICAgcmV0dXJuIGZhbHNlIHVubGVzcyBQTFVHSU5fRElSICYmIEZpbGUuZGlyZWN0b3J5PyhQTFVHSU5fRElSKQogICAgcGF0aCA9IEZpbGUuam9pbihQTFVHSU5fRElSLCBmaWxlX25hbWUpCiAgICByZXR1cm4gZmFsc2UgdW5sZXNzIEZpbGUuZXhpc3Q/KHBhdGgpCiAgICBiZWdpbgogICAgICBsb2FkIHBhdGgKICAgICAgdHJ1ZQogICAgcmVzY3VlID0+IGUKICAgICAgVUkubWVzc2FnZWJveCgi4pqgINiu2LfYoyDZgdmKINiq2K3ZhdmK2YQgI3tmaWxlX25hbWV9OlxuI3tlLm1lc3NhZ2V9IikKICAgICAgZmFsc2UKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5jYWxsX2ludm9pY2VfcGx1Z2luCiAgICB1bmxlc3Mgc2FmZV9sb2FkX2xvY2FsKCJpbnZvaWNlLnJiIikKICAgICAgVUkubWVzc2FnZWJveCgi4p2MINmF2YTZgSBpbnZvaWNlLnJiINi62YrYsSDZhdmI2KzZiNivINij2Ygg2KjZhyDYrti32KMuIikKICAgICAgcmV0dXJuCiAgICBlbmQKICAgIGlmIGRlZmluZWQ/KE1IRGVzaWduKSAmJiBNSERlc2lnbi5jb25zdF9kZWZpbmVkPyg6TUhJbnZvaWNlKQogICAgICBtb2QgPSBNSERlc2lnbi5jb25zdF9nZXQoOk1ISW52b2ljZSkKICAgICAgaWYgbW9kLnJlc3BvbmRfdG8/KDpvcGVuX2ludm9pY2VfZGlhbG9nKQogICAgICAgIG1vZC5vcGVuX2ludm9pY2VfZGlhbG9nCiAgICAgIGVsc2UKICAgICAgICBVSS5tZXNzYWdlYm94KCLinYwgaW52b2ljZS5yYiDZhNinINmK2K3YqtmI2Yog2LnZhNmJIG9wZW5faW52b2ljZV9kaWFsb2cg2YHZiiBNSERlc2lnbjo6TUhJbnZvaWNlLiIpCiAgICAgIGVuZAogICAgZWxzZQogICAgICBVSS5tZXNzYWdlYm94KCLinYwgaW52b2ljZS5yYiDZhNinINmK2K3YqtmI2Yog2LnZhNmJIE1IRGVzaWduOjpNSEludm9pY2UuIikKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5jYWxsX3JlcG9ydHNfcGx1Z2luCiAgICB1bmxlc3Mgc2FmZV9sb2FkX2xvY2FsKCJyZXBvcnRfdW5pdHMucmIiKQogICAgICBVSS5tZXNzYWdlYm94KCLinYwg2YXZhNmBIHJlcG9ydF91bml0cy5yYiDYutmK2LEg2YXZiNis2YjYryDYo9mIINio2Ycg2K7Yt9ijLiIpCiAgICAgIHJldHVybgogICAgZW5kCiAgICBpZiBkZWZpbmVkPyhNSERFU0lHTikgJiYgTUhERVNJR04uY29uc3RfZGVmaW5lZD8oOlJlcG9ydFVuaXRzKQogICAgICBtb2QgPSBNSERFU0lHTi5jb25zdF9nZXQoOlJlcG9ydFVuaXRzKQogICAgICBbOnJ1biwgOnN0YXJ0LCA6b3Blbl9kaWFsb2csIDpzaG93X2RpYWxvZywgOm9wZW4sIDpzaG93LCA6bWFpbiwgOmdlbmVyYXRlXS5lYWNoIGRvIHxtfAogICAgICAgIGJlZ2luCiAgICAgICAgICBpZiBtb2QucmVzcG9uZF90bz8obSkKICAgICAgICAgICAgbW9kLnNlbmQobSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICBlbmQKICAgICAgICByZXNjdWUKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIGxpc3QgPSAobW9kLm1ldGhvZHMoZmFsc2UpLm1hcCgmOnRvX3MpLnNvcnQgcmVzY3VlIFtdKQogICAgICBVSS5tZXNzYWdlYm94KCLinYwgcmVwb3J0X3VuaXRzLnJiINmE2Kcg2YrYrdiq2YjZiiDYudmE2Ykg2KfZhNmI2LjYp9im2YEg2KfZhNmF2KrZiNmC2LnYqS5cbtin2YTZiNi42KfYptmBINin2YTZhdmI2KzZiNiv2Kkg2YHZiiBNSERFU0lHTjo6UmVwb3J0VW5pdHM6XG4tICIgKyBsaXN0LmZpcnN0KDQwKS5qb2luKCJcbi0gIikpCiAgICBlbHNlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCByZXBvcnRfdW5pdHMucmIg2YTYpyDZitit2KrZiNmKINi52YTZiSBNSERFU0lHTjo6UmVwb3J0VW5pdHMuIikKICAgIGVuZAogIGVuZAoKICBtb2R1bGUgTUhERVNJR05fVU5JUVVJRlkKICAgIGRlZiBzZWxmLm1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKGVudGl0aWVzKQogICAgICBlbnRpdGllcy5ncmVwKFNrZXRjaHVwOjpDb21wb25lbnRJbnN0YW5jZSkuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgaW5zdGFuY2UubWFrZV91bmlxdWUKICAgICAgICBtYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShpbnN0YW5jZS5kZWZpbml0aW9uLmVudGl0aWVzKQogICAgICBlbmQKICAgIGVuZAogICAgZGVmIHNlbGYubWFrZV9kZWZpbml0aW9uc191bmlxdWUKICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgbW9kZWwuZGVmaW5pdGlvbnMuZWFjaCBkbyB8ZGVmaW5pdGlvbnwKICAgICAgICBuZXh0IGlmIGRlZmluaXRpb24uZ3JvdXA/IHx8IGRlZmluaXRpb24uaW1hZ2U/CiAgICAgICAgZGVmaW5pdGlvbi5pbnN0YW5jZXMuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgICBpbnN0YW5jZS5tYWtlX3VuaXF1ZQogICAgICAgICAgbWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUoaW5zdGFuY2UuZGVmaW5pdGlvbi5lbnRpdGllcykKICAgICAgICBlbmQKICAgICAgZW5kCiAgICBlbmQKICAgIGRlZiBzZWxmLnJ1bl91bmlxdWlmeQogICAgICBtb2RlbCA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbAogICAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oItis2LnZhCDYrNmF2YrYuSDYp9mE2LnZhtin2LXYsSDZgdix2YrYr9ipIiwgdHJ1ZSkKICAgICAgbWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUobW9kZWwuZW50aXRpZXMpCiAgICAgIG1ha2VfZGVmaW5pdGlvbnNfdW5pcXVlCiAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgVUkubWVzc2FnZWJveCgi4pyFINiq2YUg2KzYudmEINis2YXZiti5INin2YTYudmG2KfYtdixINmB2LHZitiv2KkuIikKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5fYmxhbmtfcmdiYSh3LCBoKQogICAgQXJyYXkubmV3KHcgKiBoICogNCwgMCkKICBlbmQKCiAgZGVmIHNlbGYuX3NldF9weChwaXhlbHMsIHcsIHgsIHksIHI9MCwgZz0wLCBiPTAsIGE9MjU1KQogICAgcmV0dXJuIGlmIHggPCAwIHx8IHkgPCAwIHx8IHggPj0gdwogICAgaWR4ID0gKHkgKiB3ICsgeCkgKiA0CiAgICBwaXhlbHNbaWR4XSAgICAgPSByCiAgICBwaXhlbHNbaWR4ICsgMV0gPSBnCiAgICBwaXhlbHNbaWR4ICsgMl0gPSBiCiAgICBwaXhlbHNbaWR4ICsgM10gPSBhCiAgZW5kCgogIGRlZiBzZWxmLl9kcmF3X2xpbmUocGl4ZWxzLCB3LCB4MCwgeTAsIHgxLCB5MSwgcj0wLCBnPTAsIGI9MCwgYT0yNTUpCiAgICBkeCA9ICh4MSAtIHgwKS5hYnMKICAgIHN4ID0geDAgPCB4MSA/IDEgOiAtMQogICAgZHkgPSAtKHkxIC0geTApLmFicwogICAgc3kgPSB5MCA8IHkxID8gMSA6IC0xCiAgICBlcnIgPSBkeCArIGR5CiAgICBsb29wIGRvCiAgICAgIF9zZXRfcHgocGl4ZWxzLCB3LCB4MCwgeTAsIHIsIGcsIGIsIGEpCiAgICAgIGJyZWFrIGlmIHgwID09IHgxICYmIHkwID09IHkxCiAgICAgIGUyID0gMiAqIGVycgogICAgICBpZiBlMiA+PSBkeQogICAgICAgIGVyciArPSBkeQogICAgICAgIHgwICs9IHN4CiAgICAgIGVuZAogICAgICBpZiBlMiA8PSBkeAogICAgICAgIGVyciArPSBkeAogICAgICAgIHkwICs9IHN5CiAgICAgIGVuZAogICAgZW5kCiAgZW5kCgogIGRlZiBzZWxmLl9kcmF3X2Fycm93X2hlYWQocGl4ZWxzLCB3LCB0aXB4LCB0aXB5LCBkaXIpCiAgICBjYXNlIGRpcgogICAgd2hlbiA6bGVmdAogICAgICBfZHJhd19saW5lKHBpeGVscywgdywgdGlweCwgdGlweSwgdGlweCArIDYsIHRpcHkgLSA0KQogICAgICBfZHJhd19saW5lKHBpeGVscywgdywgdGlweCwgdGlweSwgdGlweCArIDYsIHRpcHkgKyA0KQogICAgd2hlbiA6cmlnaHQKICAgICAgX2RyYXdfbGluZShwaXhlbHMsIHcsIHRpcHgsIHRpcHksIHRpcHggLSA2LCB0aXB5IC0gNCkKICAgICAgX2RyYXdfbGluZShwaXhlbHMsIHcsIHRpcHgsIHRpcHksIHRpcHggLSA2LCB0aXB5ICsgNCkKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5fd3JpdGVfY3VyKHBhdGgsIHcsIGgsIGhvdHgsIGhvdHksIHBpeGVsc19yZ2JhKQogICAgcmFpc2UgImJhZCBzaXplIiB1bmxlc3MgdyA+IDAgJiYgaCA+IDAKICAgIHhvcl9yb3dfYnl0ZXMgPSB3ICogNAogICAgeG9yX2J5dGVzID0geG9yX3Jvd19ieXRlcyAqIGgKCiAgICBtYXNrX3Jvd19ieXRlcyA9ICgodyArIDMxKSAvIDMyKSAqIDQKICAgIG1hc2tfYnl0ZXMgPSBtYXNrX3Jvd19ieXRlcyAqIGgKCiAgICBiaV9zaXplID0gNDAKICAgIGJpX3dpZHRoID0gdwogICAgYmlfaGVpZ2h0ID0gaCAqIDIKICAgIGJpX3BsYW5lcyA9IDEKICAgIGJpX2JpdGNvdW50ID0gMzIKICAgIGJpX2NvbXByZXNzaW9uID0gMAogICAgYmlfc2l6ZWltYWdlID0geG9yX2J5dGVzICsgbWFza19ieXRlcwogICAgYmlfeHBwbSA9IDAKICAgIGJpX3lwcG0gPSAwCiAgICBiaV9jbHJ1c2VkID0gMAogICAgYmlfY2xyaW1wID0gMAoKICAgIGhlYWRlciA9IFsKICAgICAgYmlfc2l6ZSwKICAgICAgYmlfd2lkdGgsCiAgICAgIGJpX2hlaWdodCwKICAgICAgYmlfcGxhbmVzLAogICAgICBiaV9iaXRjb3VudCwKICAgICAgYmlfY29tcHJlc3Npb24sCiAgICAgIGJpX3NpemVpbWFnZSwKICAgICAgYmlfeHBwbSwKICAgICAgYmlfeXBwbSwKICAgICAgYmlfY2xydXNlZCwKICAgICAgYmlfY2xyaW1wCiAgICBdLnBhY2soIlYzdjJWNiIpCgogICAgeG9yID0gIiIKICAgIChoLTEpLmRvd250bygwKSBkbyB8eXwKICAgICAgKDAuLi53KS5lYWNoIGRvIHx4fAogICAgICAgIGlkeCA9ICh5ICogdyArIHgpICogNAogICAgICAgIHIgPSBwaXhlbHNfcmdiYVtpZHhdCiAgICAgICAgZyA9IHBpeGVsc19yZ2JhW2lkeCArIDFdCiAgICAgICAgYiA9IHBpeGVsc19yZ2JhW2lkeCArIDJdCiAgICAgICAgYSA9IHBpeGVsc19yZ2JhW2lkeCArIDNdCiAgICAgICAgeG9yIDw8IGIuY2hyIDw8IGcuY2hyIDw8IHIuY2hyIDw8IGEuY2hyCiAgICAgIGVuZAogICAgZW5kCgogICAgYW5kX21hc2sgPSAiXHgwMCIgKiBtYXNrX2J5dGVzCiAgICBpbWFnZV9kYXRhID0gaGVhZGVyICsgeG9yICsgYW5kX21hc2sKCiAgICBpY29uZGlyID0gWzAsIDIsIDFdLnBhY2soInYzIikKCiAgICB3aWR0aF9ieXRlICA9ICh3ID09IDI1NiA/IDAgOiB3KQogICAgaGVpZ2h0X2J5dGUgPSAoaCA9PSAyNTYgPyAwIDogaCkKICAgIGJ5dGVzX2luX3JlcyA9IGltYWdlX2RhdGEuYnl0ZXNpemUKICAgIGltYWdlX29mZnNldCA9IDYgKyAxNgoKICAgIGVudHJ5ID0gWwogICAgICB3aWR0aF9ieXRlLAogICAgICBoZWlnaHRfYnl0ZSwKICAgICAgMCwKICAgICAgMCwKICAgICAgaG90eCwKICAgICAgaG90eSwKICAgICAgYnl0ZXNfaW5fcmVzLAogICAgICBpbWFnZV9vZmZzZXQKICAgIF0ucGFjaygiQzR2MlYyIikKCiAgICBGaWxlLmJpbndyaXRlKHBhdGgsIGljb25kaXIgKyBlbnRyeSArIGltYWdlX2RhdGEpCiAgICB0cnVlCiAgcmVzY3VlCiAgICBmYWxzZQogIGVuZAoKICBkZWYgc2VsZi5fbWFrZV9yb3RhdGVfcGl4ZWxzKHc9MzIsIGg9MzIpCiAgICBweCA9IF9ibGFua19yZ2JhKHcsIGgpCiAgICBwdHMgPSBbCiAgICAgIFsxMCwgMTBdLFsxMywgOF0sWzE2LCA3XSxbMTksIDhdLFsyMiwgMTBdLFsyNCwgMTNdLFsyNSwgMTZdLFsyNCwgMTldLFsyMiwgMjJdLFsxOSwgMjRdLFsxNiwgMjVdLFsxMywgMjRdLFsxMSwgMjJdCiAgICBdCiAgICAoMC4uLnB0cy5sZW5ndGgtMSkuZWFjaCB7IHxpfCBfZHJhd19saW5lKHB4LCB3LCBwdHNbaV1bMF0sIHB0c1tpXVsxXSwgcHRzW2krMV1bMF0sIHB0c1tpKzFdWzFdLCAwLDAsMCwyNTUpIH0KICAgIF9kcmF3X2Fycm93X2hlYWQocHgsIHcsIDEwLCAxMCwgOmxlZnQpCiAgICBweAogIGVuZAoKICBkZWYgc2VsZi5fbWFrZV9mbGlwX3BpeGVscyh3PTMyLCBoPTMyKQogICAgcHggPSBfYmxhbmtfcmdiYSh3LCBoKQogICAgX2RyYXdfbGluZShweCwgdywgNywgMTYsIDI1LCAxNiwgMCwwLDAsMjU1KQogICAgX2RyYXdfYXJyb3dfaGVhZChweCwgdywgNywgMTYsIDpsZWZ0KQogICAgX2RyYXdfYXJyb3dfaGVhZChweCwgdywgMjUsIDE2LCA6cmlnaHQpCiAgICBweAogIGVuZAoKICBkZWYgc2VsZi5fY3Vyc29yX2Zyb21fdGVtcF9jdXIobmFtZSkKICAgIHBhdGggPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZF9jdXJzb3JfI3tuYW1lfS5jdXIiKQogICAgdyA9IDMyOyBoID0gMzIKICAgIGhvdHggPSA4OyBob3R5ID0gOAoKICAgIHBpeGVscyA9CiAgICAgIGNhc2UgbmFtZQogICAgICB3aGVuIDpyb3RhdGUgdGhlbiBfbWFrZV9yb3RhdGVfcGl4ZWxzKHcsIGgpCiAgICAgIHdoZW4gOmZsaXAgICB0aGVuIF9tYWtlX2ZsaXBfcGl4ZWxzKHcsIGgpCiAgICAgIGVsc2UgbmlsCiAgICAgIGVuZAogICAgcmV0dXJuIG5pbCB1bmxlc3MgcGl4ZWxzCgogICAgb2sgPSBfd3JpdGVfY3VyKHBhdGgsIHcsIGgsIGhvdHgsIGhvdHksIHBpeGVscykKICAgIHJldHVybiBuaWwgdW5sZXNzIG9rICYmIEZpbGUuZXhpc3Q/KHBhdGgpICYmIEZpbGUuc2l6ZShwYXRoKSA+IDAKCiAgICBpZCA9IFVJLmNyZWF0ZV9jdXJzb3IocGF0aCwgaG90eCwgaG90eSkKICAgIHJldHVybiBuaWwgaWYgaWQubmlsPyB8fCBpZC50b19pID09IDAKICAgIGlkCiAgcmVzY3VlCiAgICBuaWwKICBlbmQKCiAgUk9UQVRFX0NVUlNPUl9JRCA9IF9jdXJzb3JfZnJvbV90ZW1wX2N1cig6cm90YXRlKQogIEZMSVBfQ1VSU09SX0lEICAgPSBfY3Vyc29yX2Zyb21fdGVtcF9jdXIoOmZsaXApCgogIGNsYXNzIE1IRF9Sb3RhdGU5MFRvb2wKICAgIGRlZiBfYXBwbHlfY3Vyc29yCiAgICAgIHJldHVybiBmYWxzZSB1bmxlc3MgUk9UQVRFX0NVUlNPUl9JRCAmJiBST1RBVEVfQ1VSU09SX0lELnRvX2kgIT0gMAogICAgICBVSS5zZXRfY3Vyc29yKFJPVEFURV9DVVJTT1JfSUQpCiAgICAgIHRydWUKICAgIHJlc2N1ZQogICAgICBmYWxzZQogICAgZW5kCgogICAgZGVmIG9uU2V0Q3Vyc29yOyBfYXBwbHlfY3Vyc29yOyBlbmQKICAgIGRlZiBvbk1vdXNlTW92ZShmbGFncywgeCwgeSwgdmlldyk7IF9hcHBseV9jdXJzb3I7IGVuZAogICAgZGVmIG9uS2V5RG93bihrZXksIHJlcGVhdCwgZmxhZ3MsIHZpZXcpOyBfYXBwbHlfY3Vyc29yOyBlbmQKCiAgICBkZWYgb25MQnV0dG9uRG93bihmbGFncywgeCwgeSwgdmlldykKICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgcGggPSB2aWV3LnBpY2tfaGVscGVyCiAgICAgIHBoLmRvX3BpY2soeCwgeSkKICAgICAgZW50ID0gcGguYmVzdF9waWNrZWQKICAgICAgcmV0dXJuIHVubGVzcyBlbnQuaXNfYT8oU2tldGNodXA6OkNvbXBvbmVudEluc3RhbmNlKSB8fCBlbnQuaXNfYT8oU2tldGNodXA6Okdyb3VwKQoKICAgICAgbW9kZWwuc3RhcnRfb3BlcmF0aW9uKCJNSEQgUm90YXRlIDkwIiwgdHJ1ZSkKICAgICAgYmVnaW4KICAgICAgICBjZW50ZXIgPSBlbnQuYm91bmRzLmNlbnRlcgogICAgICAgIGF4aXMgICA9IEdlb206OlZlY3RvcjNkLm5ldygwLCAwLCAxKQogICAgICAgIGFuZ2xlICA9IDQ1LmRlZ3JlZXMKICAgICAgICB0ciA9IEdlb206OlRyYW5zZm9ybWF0aW9uLnJvdGF0aW9uKGNlbnRlciwgYXhpcywgYW5nbGUpCiAgICAgICAgZW50LnRyYW5zZm9ybSEodHIpCiAgICAgIGVuc3VyZQogICAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuYWN0aXZhdGVfcm90YXRlX3Rvb2wKICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3RfdG9vbChNSERfUm90YXRlOTBUb29sLm5ldykKICBlbmQKCiAgY2xhc3MgTUhERmxpcExSVG9vbAogICAgZGVmIF9hcHBseV9jdXJzb3IKICAgICAgcmV0dXJuIGZhbHNlIHVubGVzcyBGTElQX0NVUlNPUl9JRCAmJiBGTElQX0NVUlNPUl9JRC50b19pICE9IDAKICAgICAgVUkuc2V0X2N1cnNvcihGTElQX0NVUlNPUl9JRCkKICAgICAgdHJ1ZQogICAgcmVzY3VlCiAgICAgIGZhbHNlCiAgICBlbmQKCiAgICBkZWYgb25TZXRDdXJzb3I7IF9hcHBseV9jdXJzb3I7IGVuZAogICAgZGVmIG9uTW91c2VNb3ZlKGZsYWdzLCB4LCB5LCB2aWV3KTsgX2FwcGx5X2N1cnNvcjsgZW5kCiAgICBkZWYgb25LZXlEb3duKGtleSwgcmVwZWF0LCBmbGFncywgdmlldyk7IF9hcHBseV9jdXJzb3I7IGVuZAoKICAgIGRlZiBvbkxCdXR0b25Eb3duKGZsYWdzLCB4LCB5LCB2aWV3KQogICAgICBtb2RlbCA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbAogICAgICBwaCA9IHZpZXcucGlja19oZWxwZXIKICAgICAgcGguZG9fcGljayh4LCB5KQogICAgICBlbnQgPSBwaC5iZXN0X3BpY2tlZAogICAgICByZXR1cm4gdW5sZXNzIGVudC5pc19hPyhTa2V0Y2h1cDo6Q29tcG9uZW50SW5zdGFuY2UpIHx8IGVudC5pc19hPyhTa2V0Y2h1cDo6R3JvdXApCgogICAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oIk1IRCBGbGlwIEwvUiIsIHRydWUpCiAgICAgIGJlZ2luCiAgICAgICAgdHIgPSBlbnQudHJhbnNmb3JtYXRpb24KICAgICAgICBvcmlnaW4gPSB0ci5vcmlnaW4KICAgICAgICB4YXhpcyAgPSB0ci54YXhpcwogICAgICAgIHlheGlzICA9IHRyLnlheGlzCiAgICAgICAgemF4aXMgID0gdHIuemF4aXMKCiAgICAgICAgYmFzaXMgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5heGVzKG9yaWdpbiwgeGF4aXMsIHlheGlzLCB6YXhpcykKICAgICAgICBtaXJyb3JfbG9jYWwgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5zY2FsaW5nKC0xLCAxLCAxKQogICAgICAgIG1pcnJvcl93b3JsZCA9IGJhc2lzICogbWlycm9yX2xvY2FsICogYmFzaXMuaW52ZXJzZQoKICAgICAgICBlbnQudHJhbnNmb3JtIShtaXJyb3Jfd29ybGQpCiAgICAgIGVuc3VyZQogICAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgZW5kCiAgICBlbmQKICBlbmQKCiAgZGVmIHNlbGYuYWN0aXZhdGVfZmxpcF9scl90b29sCiAgICBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuc2VsZWN0X3Rvb2woTUhERmxpcExSVG9vbC5uZXcpCiAgZW5kCgogIGNsYXNzIENsaWNrU2lkZVNuYXBUb29sX1Zpc2libGVCb3VuZHMKICAgIGRlZiBhY3RpdmF0ZQogICAgICBAbW92aW5nID0gbmlsCiAgICAgIFNrZXRjaHVwLnN0YXR1c190ZXh0ID0gIjEpINin2K7YqtixINin2YTYudmG2LXYsSDYp9mE2YXYsdin2K8g2YbZgtmE2YciCiAgICBlbmQKCiAgICBkZWYgcGlja19pbnN0YW5jZSh2aWV3LCB4LCB5KQogICAgICBpcCA9IFNrZXRjaHVwOjpJbnB1dFBvaW50Lm5ldwogICAgICBpcC5waWNrKHZpZXcsIHgsIHkpCiAgICAgIHJldHVybiBbbmlsLCBuaWxdIHVubGVzcyBpcC52YWxpZD8KCiAgICAgIHBoID0gdmlldy5waWNrX2hlbHBlcgogICAgICBwaC5kb19waWNrKHgsIHkpCiAgICAgIGJlc3QgPSBwaC5iZXN0X3BpY2tlZAoKICAgICAgcGF0aCA9IG5pbAogICAgICBiZWdpbgogICAgICAgIHBhdGggPSBwaC5wYXRoX2F0KDApCiAgICAgIHJlc2N1ZQogICAgICAgIHBhdGggPSBuaWwKICAgICAgZW5kCgogICAgICBpbnN0ID0gbmlsCiAgICAgIGlmIGJlc3QuaXNfYT8oU2tldGNodXA6OkNvbXBvbmVudEluc3RhbmNlKSB8fCBiZXN0LmlzX2E/KFNrZXRjaHVwOjpHcm91cCkKICAgICAgICBpbnN0ID0gYmVzdAogICAgICBlbHNpZiBwYXRoCiAgICAgICAgcGF0aC5yZXZlcnNlX2VhY2ggZG8gfGV8CiAgICAgICAgICBpZiBlLmlzX2E/KFNrZXRjaHVwOjpDb21wb25lbnRJbnN0YW5jZSkgfHwgZS5pc19hPyhTa2V0Y2h1cDo6R3JvdXApCiAgICAgICAgICAgIGluc3QgPSBlCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgZW5kCgogICAgICBbaW5zdCwgaXAucG9zaXRpb25dCiAgICBlbmQKCiAgICBkZWYgbGF5ZXJfdmlzaWJsZT8oZW50KQogICAgICBiZWdpbgogICAgICAgIGwgPSBlbnQubGF5ZXIKICAgICAgICByZXR1cm4gdHJ1ZSBpZiBsLm5pbD8KICAgICAgICByZXR1cm4gbC52aXNpYmxlPwogICAgICByZXNjdWUKICAgICAgICB0cnVlCiAgICAgIGVuZAogICAgZW5kCgogICAgZGVmIGVudGl0eV92aXNpYmxlPyhlbnQpCiAgICAgIHJldHVybiBmYWxzZSBpZiBlbnQuZGVsZXRlZD8KICAgICAgcmV0dXJuIGZhbHNlIGlmIGVudC5oaWRkZW4/CiAgICAgIHJldHVybiBmYWxzZSB1bmxlc3MgbGF5ZXJfdmlzaWJsZT8oZW50KQogICAgICB0cnVlCiAgICBlbmQKCiAgICBkZWYgcm9vdF9lbnRpdGllc19vZihpbnN0KQogICAgICBpZiBpbnN0LmlzX2E/KFNrZXRjaHVwOjpDb21wb25lbnRJbnN0YW5jZSkKICAgICAgICBpbnN0LmRlZmluaXRpb24uZW50aXRpZXMKICAgICAgZWxzZQogICAgICAgIGluc3QuZW50aXRpZXMKICAgICAgZW5kCiAgICBlbmQKCiAgICBkZWYgY29sbGVjdF92aXNpYmxlX3BvaW50cyhlbnRpdGllcywgdHJfYWNjdW0sIHB0cykKICAgICAgZW50aXRpZXMuZWFjaCBkbyB8ZXwKICAgICAgICBuZXh0IHVubGVzcyBlbnRpdHlfdmlzaWJsZT8oZSkKCiAgICAgICAgY2FzZSBlCiAgICAgICAgd2hlbiBTa2V0Y2h1cDo6RmFjZQogICAgICAgICAgZS52ZXJ0aWNlcy5lYWNoIGRvIHx2eHwKICAgICAgICAgICAgcHRzIDw8IHZ4LnBvc2l0aW9uLnRyYW5zZm9ybSh0cl9hY2N1bSkKICAgICAgICAgIGVuZAogICAgICAgIHdoZW4gU2tldGNodXA6Okdyb3VwCiAgICAgICAgICBjb2xsZWN0X3Zpc2libGVfcG9pbnRzKGUuZW50aXRpZXMsIHRyX2FjY3VtICogZS50cmFuc2Zvcm1hdGlvbiwgcHRzKQogICAgICAgIHdoZW4gU2tldGNodXA6OkNvbXBvbmVudEluc3RhbmNlCiAgICAgICAgICBjb2xsZWN0X3Zpc2libGVfcG9pbnRzKGUuZGVmaW5pdGlvbi5lbnRpdGllcywgdHJfYWNjdW0gKiBlLnRyYW5zZm9ybWF0aW9uLCBwdHMpCiAgICAgICAgZWxzZQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZAoKICAgIGRlZiB2aXNpYmxlX2JvdW5kc193b3JsZChpbnN0KQogICAgICBwdHMgPSBbXQogICAgICBiYXNlX3RyID0gaW5zdC50cmFuc2Zvcm1hdGlvbgogICAgICBjb2xsZWN0X3Zpc2libGVfcG9pbnRzKHJvb3RfZW50aXRpZXNfb2YoaW5zdCksIGJhc2VfdHIsIHB0cykKCiAgICAgIGlmIHB0cy5lbXB0eT8KICAgICAgICByZXR1cm4gaW5zdC5ib3VuZHMKICAgICAgZW5kCgogICAgICBiYiA9IEdlb206OkJvdW5kaW5nQm94Lm5ldwogICAgICBwdHMuZWFjaCB7IHxwfCBiYi5hZGQocCkgfQogICAgICBiYgogICAgZW5kCgogICAgZGVmIGRlY2lkZV9zaWRlKHRhcmdldF9iYiwgY2xpY2tfcHQpCiAgICAgIGR4X21pbiA9IChjbGlja19wdC54IC0gdGFyZ2V0X2JiLm1pbi54KS5hYnMKICAgICAgZHhfbWF4ID0gKHRhcmdldF9iYi5tYXgueCAtIGNsaWNrX3B0LngpLmFicwogICAgICBkeV9taW4gPSAoY2xpY2tfcHQueSAtIHRhcmdldF9iYi5taW4ueSkuYWJzCiAgICAgIGR5X21heCA9ICh0YXJnZXRfYmIubWF4LnkgLSBjbGlja19wdC55KS5hYnMKCiAgICAgIFsKICAgICAgICBbOmxlZnQsICBkeF9taW5dLAogICAgICAgIFs6cmlnaHQsIGR4X21heF0sCiAgICAgICAgWzpiYWNrLCAgZHlfbWluXSwKICAgICAgICBbOmZyb250LCBkeV9tYXhdCiAgICAgIF0ubWluX2J5IHsgfF8sIHZ8IHYgfVswXQogICAgZW5kCgogICAgZGVmIG9uTEJ1dHRvbkRvd24oZmxhZ3MsIHgsIHksIHZpZXcpCiAgICAgIGVudCwgY2xpY2tfcHQgPSBwaWNrX2luc3RhbmNlKHZpZXcsIHgsIHkpCiAgICAgIHJldHVybiB1bmxlc3MgZW50CgogICAgICBpZiBAbW92aW5nLm5pbD8KICAgICAgICBAbW92aW5nID0gZW50CiAgICAgICAgU2tldGNodXAuc3RhdHVzX3RleHQgPSAiMikg2KfYrtiq2LEg2KfZhNmI2KzZhyDYp9mE2YXYsdin2K8g2KfZhNil2YTYtdin2YIg2KjZhyAo2KfYtti62Lcg2LnZhNmJINmI2KzZhyDYp9mE2LnZhti12LEg2KfZhNmH2K/ZgSkiCiAgICAgICAgcmV0dXJuCiAgICAgIGVuZAoKICAgICAgbW92aW5nID0gQG1vdmluZwogICAgICB0YXJnZXQgPSBlbnQKICAgICAgQG1vdmluZyA9IG5pbAoKICAgICAgaWYgbW92aW5nID09IHRhcmdldAogICAgICAgIFNrZXRjaHVwLnN0YXR1c190ZXh0ID0gItin2K7YqtixINmI2KzZhyDZhdiu2KrZhNmBLiIKICAgICAgICByZXR1cm4KICAgICAgZW5kCgogICAgICBtb2RlbCA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbAogICAgICBtb2RlbC5zdGFydF9vcGVyYXRpb24oIkNsaWNrIFNpZGUgU25hcCAoVmlzaWJsZSBCb3VuZHMpIiwgdHJ1ZSkKCiAgICAgIGJlZ2luCiAgICAgICAgYm0gPSB2aXNpYmxlX2JvdW5kc193b3JsZChtb3ZpbmcpCiAgICAgICAgYnQgPSB2aXNpYmxlX2JvdW5kc193b3JsZCh0YXJnZXQpCgogICAgICAgIHNpZGUgPSBkZWNpZGVfc2lkZShidCwgY2xpY2tfcHQpCgogICAgICAgIGR6ID0gYnQubWluLnogLSBibS5taW4uegoKICAgICAgICBjYXNlIHNpZGUKICAgICAgICB3aGVuIDpyaWdodAogICAgICAgICAgZHggPSBidC5tYXgueCAtIGJtLm1pbi54CiAgICAgICAgICBkeSA9IGJ0LmNlbnRlci55IC0gYm0uY2VudGVyLnkKICAgICAgICAgIHYgID0gR2VvbTo6VmVjdG9yM2QubmV3KGR4LCBkeSwgZHopCgogICAgICAgIHdoZW4gOmxlZnQKICAgICAgICAgIGR4ID0gYnQubWluLnggLSBibS5tYXgueAogICAgICAgICAgZHkgPSBidC5jZW50ZXIueSAtIGJtLmNlbnRlci55CiAgICAgICAgICB2ICA9IEdlb206OlZlY3RvcjNkLm5ldyhkeCwgZHksIGR6KQoKICAgICAgICB3aGVuIDpmcm9udAogICAgICAgICAgZHkgPSBidC5tYXgueSAtIGJtLm1pbi55CiAgICAgICAgICBkeCA9IGJ0LmNlbnRlci54IC0gYm0uY2VudGVyLngKICAgICAgICAgIHYgID0gR2VvbTo6VmVjdG9yM2QubmV3KGR4LCBkeSwgZHopCgogICAgICAgIHdoZW4gOmJhY2sKICAgICAgICAgIGR5ID0gYnQubWluLnkgLSBibS5tYXgueQogICAgICAgICAgZHggPSBidC5jZW50ZXIueCAtIGJtLmNlbnRlci54CiAgICAgICAgICB2ICA9IEdlb206OlZlY3RvcjNkLm5ldyhkeCwgZHksIGR6KQogICAgICAgIGVuZAoKICAgICAgICBtb3ZpbmcudHJhbnNmb3JtIShHZW9tOjpUcmFuc2Zvcm1hdGlvbi50cmFuc2xhdGlvbih2KSkKCiAgICAgIGVuc3VyZQogICAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgICBTa2V0Y2h1cC5zdGF0dXNfdGV4dCA9ICIxKSDYp9iu2KrYsSDYp9mE2LnZhti12LEg2KfZhNmF2LHYp9ivINmG2YLZhNmHIgogICAgICBlbmQKICAgIGVuZAogIGVuZAoKICBkZWYgc2VsZi5hY3RpdmF0ZV9jbGlja19zaWRlX3NuYXBfdG9vbAogICAgU2tldGNodXAuYWN0aXZlX21vZGVsLnNlbGVjdF90b29sKENsaWNrU2lkZVNuYXBUb29sX1Zpc2libGVCb3VuZHMubmV3KQogIGVuZAoKICAjID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gTGlicmFyeSBVSSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgZGVmIHNlbGYuc2hvd19saWJyYXJ5CiAgICAjINin2YTYqtit2YLZgiDZhdmGINin2YTYqtmB2LnZitmEINmC2KjZhCDZgdiq2K0g2KfZhNmF2YPYqtio2KkKICAgIHVubGVzcyBhY3RpdmF0ZWQ/CiAgICAgIGFjdGl2YXRlKHRydWUpCiAgICAgIHJldHVybgogICAgZW5kCgogICAgZGxnID0gVUk6Okh0bWxEaWFsb2cubmV3KHsKICAgICAgOmRpYWxvZ190aXRsZSA9PiAiTUhERVNJR04gTGlicmFyeSIsCiAgICAgIDpwcmVmZXJlbmNlc19rZXkgPT4gIm1oZGVzaWduX2xpYnJhcnlfcHJvX2F1dG9leHBsb2RlIiwKICAgICAgOnNjcm9sbGFibGUgPT4gdHJ1ZSwKICAgICAgOnJlc2l6YWJsZSA9PiB0cnVlLAogICAgICA6d2lkdGggPT4gMTIwMCwKICAgICAgOmhlaWdodCA9PiA3MjAKICAgIH0pCgogICAgZm9vdGVyXzEgPSAi2KzZhdmK2Lkg2KfZhNit2YLZiNmCINmF2K3ZgdmI2LjYqSDCqSBtaGRlc2lnbi1lZy5jb20iCiAgICBmb290ZXJfMiA9ICIwMTAxMDAyMTEzNDAiCgogICAgaHRtbCA9IDw8LUhUTUwKICAgIDxodG1sPgogICAgPGhlYWQ+CiAgICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KICAgICAgPGxpbmsgaHJlZj0iaHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1UYWphd2FsOndnaHRANDAwOzcwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CiAgICAgIDxzdHlsZT4KICAgICAgICA6cm9vdHsKICAgICAgICAgIC0tYmx1ZTE6IzI2MzIzODstLWJsdWUyOiMzNDQ1NGQ7LS1ncmVlbjojMmU3ZDMyOy0tZ3JlZW4yOiM0M2EwNDc7CiAgICAgICAgICAtLWJnOiNmM2Y1Zjc7LS1jYXJkOiNmZmY7LS10ZXh0OiMxYjFmMjc7LS1tdXRlZDojN2M4Nzk4Oy0tbGluZTojZThlYmYwOwogICAgICAgICAgLS1yaWdodHc6IDI2MHB4OwogICAgICAgICAgLS1zYnc6IDc0cHg7CiAgICAgICAgICAtLXJpZ2h0TWluaTogNTRweDsKICAgICAgICB9CiAgICAgICAgKntib3gtc2l6aW5nOmJvcmRlci1ib3h9CiAgICAgICAgYm9keXttYXJnaW46MDtmb250LWZhbWlseTonVGFqYXdhbCcsc2Fucy1zZXJpZjtkaXJlY3Rpb246cnRsO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOnZhcigtLXRleHQpO292ZXJmbG93OmhpZGRlbjt9CgogICAgICAgIC5hcHB7aGVpZ2h0OjEwMHZoO2Rpc3BsYXk6Z3JpZDtncmlkLXRlbXBsYXRlLWNvbHVtbnM6dmFyKC0tc2J3KSAxZnIgdmFyKC0tcmlnaHR3KTt9CgogICAgICAgIC8qIOKckyDYqti52K/ZitmEINmE2YTZiNi22Lkg2KfZhNmF2LXYutixICovCiAgICAgICAgYm9keS5taW5pIC5hcHB7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnZhcigtLXNidyk7fQogICAgICAgIGJvZHkubWluaSAjbWFpbkNvbHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9CiAgICAgICAgYm9keS5taW5pICNyaWdodENvbHtkaXNwbGF5Om5vbmUgIWltcG9ydGFudDt9CiAgICAgICAgYm9keS5taW5pICNyZXNpemVye2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50O30KICAgICAgICBib2R5Lm1pbmkgLmNhdHNPcGVuQnRueyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDsgfQoKICAgICAgICAuc2lkZWJhcnsKICAgICAgICAgIGJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZyx2YXIoLS1ibHVlMiksdmFyKC0tYmx1ZTEpKTsKICAgICAgICAgIGNvbG9yOiNmZmY7CiAgICAgICAgICBwYWRkaW5nOjEwcHggOHB4OwogICAgICAgICAgZGlzcGxheTpmbGV4OwogICAgICAgICAgZmxleC1kaXJlY3Rpb246Y29sdW1uOwogICAgICAgICAgYWxpZ24taXRlbXM6Y2VudGVyOwogICAgICAgICAgZ2FwOjEwcHg7CiAgICAgICAgICBwb3NpdGlvbjpyZWxhdGl2ZTsKICAgICAgICB9CgogICAgICAgIC8qIOKckyDYstixINiq2LXYutmK2LEv2KrYtdi62YrYsSDZhNmE2LTYsdmK2Lcg2KfZhNis2KfZhtio2YogKi8KICAgICAgICAubWluaVRvZ2dsZXsKICAgICAgICAgIHdpZHRoOjU0cHg7CiAgICAgICAgICBoZWlnaHQ6MzRweDsKICAgICAgICAgIGJvcmRlci1yYWRpdXM6MTRweDsKICAgICAgICAgIGJhY2tncm91bmQ6cmc="
}
