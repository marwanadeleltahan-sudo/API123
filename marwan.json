{
  "main_code": "cmVxdWlyZSAnc2tldGNodXAucmInCnJlcXVpcmUgJ25ldC9odHRwJwpyZXF1aXJlICd1cmknCnJlcXVpcmUgJ2pzb24nCnJlcXVpcmUgJ3NlY3VyZXJhbmRvbScKcmVxdWlyZSAnb3Blbi11cmknCnJlcXVpcmUgJ3RtcGRpcicKcmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICd0ZW1wZmlsZScKcmVxdWlyZSAnZGlnZXN0JwpyZXF1aXJlICdmaWxldXRpbHMnCgptb2R1bGUgTUhERVNJR04KICBQTFVHSU5fTkFNRSA9ICJNSERFU0lHTiIKICBWQUxJREFUSU9OX1VSTCA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbWFyd2FuYWRlbGVsdGFoYW4tc3Vkby9BUEkxMjMvcmVmcy9oZWFkcy9tYWluL2VtYWlsLmpzb24iCgogIENPTVBPTkVOVFMgPSBiZWdpbgogIHVybCA9ICJodHRwczovL21haG1vdWRkZXNpZ24uY29tL1NLRVRDSFVQL2NvbXBvbmVudHMtVjQuanNvbiIKICBqc29uX3JhdyA9IFVSSS5vcGVuKHVybCkucmVhZAogIGpzb25fZGF0YSA9IEpTT04ucGFyc2UoanNvbl9yYXcpCiAgZGVjb2RlZF9qc29uID0gQmFzZTY0LmRlY29kZTY0KGpzb25fZGF0YVsiZGF0YSJdKQogIEpTT04ucGFyc2UoZGVjb2RlZF9qc29uLCBzeW1ib2xpemVfbmFtZXM6IHRydWUpCnJlc2N1ZSA9PiBlCiAgVUkubWVzc2FnZWJveCgi4p2MINmB2LTZhCDYqtit2YXZitmEINio2YrYp9mG2KfYqiDYp9mE2YXZg9iq2KjYqTogI3tlLm1lc3NhZ2V9IikKICBbXQplbmQKCiAgIyA9PT09PT09PT09INij2K/Yp9ipINiq2KrYqNi5INin2YTZhdin2YjYsyDYudmG2K8g2KfZhNil2K/Ysdin2KwgPT09PT09PT09PQogIGNsYXNzIENvbXBvbmVudFBsYWNlcgogICAgZGVmIGluaXRpYWxpemUoZGVmaW5pdGlvbiwgbmFtZSkKICAgICAgQGRlZmluaXRpb24gPSBkZWZpbml0aW9uCiAgICAgIEBuYW1lID0gbmFtZQogICAgICBAaXAgPSBTa2V0Y2h1cDo6SW5wdXRQb2ludC5uZXcKICAgIGVuZAoKICAgIGRlZiBvbk1vdXNlTW92ZShmbGFncywgeCwgeSwgdmlldykKICAgICAgQGlwLnBpY2sodmlldywgeCwgeSkKICAgICAgdmlldy5pbnZhbGlkYXRlCiAgICBlbmQKCiAgICBkZWYgZHJhdyh2aWV3KQogICAgICByZXR1cm4gdW5sZXNzIEBpcC52YWxpZD8KICAgICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgICB2aWV3LmRyYXcoR0xfTElORV9TVFJJUCwgW0BpcC5wb3NpdGlvbl0pCiAgICAgIGJlZ2luCiAgICAgICAgcHRzID0gQGRlZmluaXRpb24uYm91bmRzLmNvcm5lcigwLi43KS5tYXAgeyB8cHR8IHB0LnRyYW5zZm9ybSh0cikgfQogICAgICAgIHZpZXcuZHJhdyhHTF9QT0xZR09OLCBwdHMpCiAgICAgIHJlc2N1ZQogICAgICBlbmQKICAgIGVuZAoKZGVmIG9uTEJ1dHRvbkRvd24oZmxhZ3MsIHgsIHksIHZpZXcpCiAgaWYgQGlwLnZhbGlkPwogICAgdHIgPSBHZW9tOjpUcmFuc2Zvcm1hdGlvbi5uZXcoQGlwLnBvc2l0aW9uKQogICAgaW5zdGFuY2UgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZW50aXRpZXMuYWRkX2luc3RhbmNlKEBkZWZpbml0aW9uLCB0cikKICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3Rpb24uY2xlYXIKICAgIFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5zZWxlY3Rpb24uYWRkKGluc3RhbmNlKQogICAgU2tldGNodXAuYWN0aXZlX21vZGVsLnRvb2xzLnBvcF90b29sCiAgICBTa2V0Y2h1cC5zZW5kX2FjdGlvbigic2VsZWN0TW92ZVRvb2w6IikKICBlbmQKZW5kCiAgZW5kCgogIGRlZiBzZWxmLmdldF9kZXZpY2VfaWQKICAgIHByZWZzID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZGV2aWNlX2lkIikKICAgIHJldHVybiBwcmVmcyB1bmxlc3MgcHJlZnMubmlsPyB8fCBwcmVmcy5lbXB0eT8KICAgIGlkID0gU2VjdXJlUmFuZG9tLnV1aWQKICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJkZXZpY2VfaWQiLCBpZCkKICAgIGlkCiAgZW5kCgogICMgPT09PT09INiq2LnYr9mK2YQg2YfZhtinID09PT09PQogIGRlZiBzZWxmLmFjdGl2YXRlKGZvcmNlX3Byb21wdCA9IHRydWUpCiAgICBlbWFpbCA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImVtYWlsIikgfHwgIiIKICAgIGxpY2Vuc2UgPSBTa2V0Y2h1cC5yZWFkX2RlZmF1bHQoUExVR0lOX05BTUUsICJsaWNlbnNlIikgfHwgIiIKCiAgICAjINmE2Ygg2YXYt9mE2YjYqCDYr9in2YrZhdmL2Kcg2KPZiCDZhdmB2YrYtCDYqNmK2KfZhtin2KrYjCDZhti32YTYqNmH2Kcg2YXZhiDYp9mE2YXYs9iq2K7Yr9mFCiAgICBpZiBmb3JjZV9wcm9tcHQgfHwgZW1haWwuZW1wdHk/IHx8IGxpY2Vuc2UuZW1wdHk/CiAgICAgIGlucHV0ID0gVUkuaW5wdXRib3goWyLYp9mE2KjYsdmK2K8g2KfZhNil2YTZg9iq2LHZiNmG2YoiLCAi2YXZgdiq2KfYrSDYp9mE2KrYsdiu2YrYtSJdLCBbZW1haWwsIGxpY2Vuc2VdLCAi2KrZgdi52YrZhCBNSERFU0lHTiIpCiAgICAgIHJldHVybiB1bmxlc3MgaW5wdXQKICAgICAgZW1haWwsIGxpY2Vuc2UgPSBpbnB1dAogICAgZW5kCgogICAgIyDYp9mE2KrYrdmC2YIg2YXZhiDYp9mE2KjZitin2YbYp9iqINi52KjYsSBHaXRIdWIgQVBJCiAgICB2YWxpZF9kYXRhID0gZmFsc2UKICAgIGJlZ2luCiAgICAgIHVyaSA9IFVSSShWQUxJREFUSU9OX1VSTCkKICAgICAgcmVzcG9uc2UgPSBOZXQ6OkhUVFAuZ2V0KHVyaSkKICAgICAgdmFsaWRfdXNlcnMgPSBKU09OLnBhcnNlKHJlc3BvbnNlKQogICAgICAKICAgICAgdmFsaWRfZGF0YSA9IHZhbGlkX3VzZXJzLmFueT8geyB8dXNlcnwgCiAgICAgICAgdXNlclsiZW1haWwiXSA9PSBlbWFpbCAmJiB1c2VyWyJwYXNzd29yZCJdID09IGxpY2Vuc2UgCiAgICAgIH0KICAgIHJlc2N1ZSA9PiBlCiAgICAgIFVJLm1lc3NhZ2Vib3goIuKdjCDZgdi02YQg2KfZhNin2KrYtdin2YQg2KjYrtin2K/ZhSDYp9mE2KrYrdmC2YI6ICN7ZS5tZXNzYWdlfSIpIGlmIGZvcmNlX3Byb21wdAogICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIGlmIHZhbGlkX2RhdGEKICAgICAgIyDYp9mE2KjZitin2YbYp9iqINi12K3Zitit2KkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImVtYWlsIiwgZW1haWwpCiAgICAgIFNrZXRjaHVwLndyaXRlX2RlZmF1bHQoUExVR0lOX05BTUUsICJsaWNlbnNlIiwgbGljZW5zZSkKICAgICAgU2tldGNodXAud3JpdGVfZGVmYXVsdChQTFVHSU5fTkFNRSwgImFjdGl2YXRlZF9vbmNlIiwgdHJ1ZSkKICAgICAgVUkubWVzc2FnZWJveCgi2YXYqNix2YjZgyDZitinINmH2YbYr9iz2Kkg2KfZhNin2LbYp9mB2Kkg2LTYutin2YTYqVxu2KrZhSDYqNix2YXYrNipINin2YTYp9i22KfZgdipINio2YjYp9iz2LfYqSDZhdmH2YbYr9izINmF2LHZiNin2YYg2LnYp9iv2YRcbvCfk54gMDEyMDQyNzk2MDYiKQogICAgICByZXR1cm4gdHJ1ZQogICAgZWxzZQogICAgICAjINin2YTYqNmK2KfZhtin2Kog2K7Yp9i32KbYqQogICAgICBVSS5tZXNzYWdlYm94KCLYp9mE2KjZitin2YbYp9iqINi62YTYtyDYrdin2YjZhCDZhdix2Kkg2KrYp9mG2YrYqSDZitinINmH2YbYr9iz2Kkg2KfZiCDZg9mE2YUgMDEyMDQyNzk2MDZcbtmI2KrYo9mD2K8g2YXZhiDYp9mE2KjZitin2YbYp9iqINmF2YYg2K7ZhNin2YQg2KfZhNix2KfYqNi3OlxuI3tWQUxJREFUSU9OX1VSTH0iKSBpZiBmb3JjZV9wcm9tcHQKICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICBlbmQKICAjID09PT09PT09PT09PT09PT09PT09PT09CgogIGRlZiBzZWxmLmFjdGl2YXRlZD8KICAgIGVtYWlsID0gU2tldGNodXAucmVhZF9kZWZhdWx0KFBMVUdJTl9OQU1FLCAiZW1haWwiKQogICAgbGljZW5zZSA9IFNrZXRjaHVwLnJlYWRfZGVmYXVsdChQTFVHSU5fTkFNRSwgImxpY2Vuc2UiKQogICAgIWVtYWlsLnRvX3MuZW1wdHk/ICYmICFsaWNlbnNlLnRvX3MuZW1wdHk/CiAgZW5kCgogIGRlZiBzZWxmLnNob3dfbGlicmFyeQogICAgIyA9PT09PT0g2KrYrdmC2YIg2LXYp9mF2KogPT09PT09CiAgICB1bmxlc3MgYWN0aXZhdGUoZmFsc2UpCiAgICAgIGFjdGl2YXRlKHRydWUpCiAgICAgIHJldHVybgogICAgZW5kCiAgICAjID09PT09PT09PT09PT09PT09PT09PT09PQoKICAgIGRsZyA9IFVJOjpIdG1sRGlhbG9nLm5ldyh7CiAgICAgIDpkaWFsb2dfdGl0bGUgPT4gItmF2YPYqtio2Kkg2KfZhNmF2LfYp9io2K4iLAogICAgICA6cHJlZmVyZW5jZXNfa2V5ID0+ICJtaGRlc2lnbl9saWJyYXJ5IiwKICAgICAgOnNjcm9sbGFibGUgPT4gdHJ1ZSwKICAgICAgOnJlc2l6YWJsZSA9PiB0cnVlLAogICAgICA6d2lkdGggPT4gODAwLAogICAgICA6aGVpZ2h0ID0+IDY1MAogICAgfSkKCiAgICBjYXRlZ29yaWVzID0gQ09NUE9ORU5UUy5tYXAgeyB8Y3wgY1s6Y2F0ZWdvcnldIH0udW5pcQoKICAgIGh0bWwgPSA8PC1IVE1MCiAgICA8aHRtbD48aGVhZD4KICAgICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPgogICAgICA8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PVRhamF3YWw6d2dodEA0MDA7NzAwJmRpc3BsYXk9c3dhcCIgcmVsPSJzdHlsZXNoZWV0Ij4KICAgICAgPHN0eWxlPgogICAgICAgIGJvZHkge2ZvbnQtZmFtaWx5OidUYWphd2FsJyxzYW5zLXNlcmlmO21hcmdpbjowO2JhY2tncm91bmQ6I2Y5ZjlmOTtwYWRkaW5nOjAgMjBweCA0MHB4O2RpcmVjdGlvbjpydGw7fQogICAgICAgIGhlYWRlciB7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOjIwcHggMDt9CiAgICAgICAgaGVhZGVyIGltZyB7aGVpZ2h0OjUwcHg7Ym9yZGVyLXJhZGl1czo1MCU7fQogICAgICAgIGhlYWRlciBoMiB7bWFyZ2luOjA7Zm9udC1zaXplOjI0cHg7Y29sb3I6IzJlN2QzMjt9CiAgICAgICAgLm1lbnUtdG9nZ2xlIHtjdXJzb3I6cG9pbnRlcjtmb250LXNpemU6MjhweDt1c2VyLXNlbGVjdDpub25lO30KICAgICAgICAuZmlsdGVyIHtkaXNwbGF5Om5vbmU7bWFyZ2luLWJvdHRvbToyMHB4O30KICAgICAgICAuZmlsdGVyIHNlbGVjdCB7Zm9udC1zaXplOjE2cHg7cGFkZGluZzo2cHggMTBweDtib3JkZXItcmFkaXVzOjZweDtib3JkZXI6MXB4IHNvbGlkICNjY2M7fQogICAgICAgIC5ncmlkIHtkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdChhdXRvLWZpbGwsbWlubWF4KDIwMHB4LDFmcikpO2dhcDoyMHB4O30KICAgICAgICAuY2FyZCB7YmFja2dyb3VuZDp3aGl0ZTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoxMnB4O2JveC1zaGFkb3c6MCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMDgpO3RleHQtYWxpZ246Y2VudGVyO3RyYW5zaXRpb246dHJhbnNmb3JtIDAuM3MgZWFzZSxib3gtc2hhZG93IDAuM3MgZWFzZTt9CiAgICAgICAgLmNhcmQ6aG92ZXIge3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01cHgpO2JveC1zaGFkb3c6MCA4cHggMjBweCByZ2JhKDAsMCwwLDAuMTIpO30KICAgICAgICBpbWcuY29tcG9uZW50LWltZyB7d2lkdGg6MTAwJTtoZWlnaHQ6MjAwcHg7b2JqZWN0LWZpdDpjb3Zlcjtib3JkZXItcmFkaXVzOjhweDt9CiAgICAgICAgaDQge21hcmdpbjoxMHB4IDAgNXB4O2ZvbnQtc2l6ZToxN3B4O2NvbG9yOiMzMzM7fQogICAgICAgIHAge2ZvbnQtc2l6ZToxM3B4O2NvbG9yOiM2NjY7bWFyZ2luOjA7fQogICAgICAgIGJ1dHRvbiB7bWFyZ2luLXRvcDoxMHB4O3BhZGRpbmc6NnB4IDE0cHg7YmFja2dyb3VuZDojNDNhMDQ3O2NvbG9yOndoaXRlO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6NXB4O2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YmFja2dyb3VuZCAwLjNzO30KICAgICAgICBidXR0b246aG92ZXIge2JhY2tncm91bmQ6IzJlN2QzMjt9CiAgICAgICAgZm9vdGVyIHttYXJnaW4tdG9wOjQwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjEycHg7Y29sb3I6Izk5OTt9CiAgICAgIDwvc3R5bGU+CiAgICA8L2hlYWQ+CiAgICA8Ym9keSBvbmNvbnRleHRtZW51PSJyZXR1cm4gZmFsc2UiPgogICAgICA8aGVhZGVyPgogICAgICAgIDxpbWcgc3JjPSJodHRwczovL21haG1vdWRkZXNpZ24uY29tL1NLRVRDSFVQL2NvbXBvbmVudHMvbG9nby5qcGVnIiBhbHQ9IkxvZ28iIC8+CiAgICAgICAgPGgyPtmF2YPYqtio2Kkg2KrYtdmF2YrZhSDYp9mE2YXYt9in2KjYrjwvaDI+CiAgICAgICAgPGRpdiBjbGFzcz0ibWVudS10b2dnbGUiIG9uY2xpY2s9InRvZ2dsZU1lbnUoKSI+4piwPC9kaXY+CiAgICAgIDwvaGVhZGVyPgoKICAgICAgPGRpdiBjbGFzcz0iZmlsdGVyIiBpZD0iZmlsdGVyLWJveCI+CiAgICAgICAgPGxhYmVsPgogICAgICAgICAg8J+UvSDYqti12YbZitmBOgogICAgICAgICAgPHNlbGVjdCBpZD0iY2F0ZWdvcnkiIG9uY2hhbmdlPSJmaWx0ZXJDb21wb25lbnRzKCkiPgogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPtin2YTZg9mEPC9vcHRpb24+CiAgICAgICAgICAgICN7Y2F0ZWdvcmllcy5tYXAgeyB8Y2F0fCAiPG9wdGlvbiB2YWx1ZT0nI3tjYXR9Jz4je2NhdH08L29wdGlvbj4iIH0uam9pbn0KICAgICAgICAgIDwvc2VsZWN0PgogICAgICAgIDwvbGFiZWw+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBpZD0iY29tcG9uZW50cyIgY2xhc3M9ImdyaWQiPjwvZGl2PgoKICAgICAgPGZvb3Rlcj4KICAgICAgICDYqtmFINiq2LXZhdmK2YUg2YfYsNmHINin2YTZhdmD2KrYqNipINio2YjYp9iz2LfYqSA8Yj5taGRlc2lnbi1lZy5jb208L2I+INmI2KPZiiDYqti12LHZgSDZgdmK2YfYpyDYqNiv2YjZhiDYpdiw2YYg2YrYudiq2KjYsSDYp9mG2KrZh9in2YPZi9inINmE2K3ZgtmI2YIg2KfZhNmF2YTZg9mK2KkgKNiz2KfZg9mI2YYg2K7YtdmK2YXZgyDYp9mF2KfZhSDYp9mE2YTZhykuPGJyPgogICAgICAgIPCfk54g2YTZhNiq2YjYp9i12YQ6IDxiPjAxMTAwMjExMzQwPC9iPjxicj4KICAgICAgICDYqtmFINio2LHZhdis2Kkg2KfZhNil2LbYp9mB2Kkg2KjZiNin2LPYt9ipINmF2YfZhtiv2LMg2YXYsdmI2KfZhiDYudin2K/ZhCAtIDAxMjA0Mjc5NjA2CiAgICAgIDwvZm9vdGVyPgoKICAgICAgPHNjcmlwdD4KZnVuY3Rpb24gbG9hZENvbXBvbmVudChjb21wKXtza2V0Y2h1cC5sb2FkQ29tcG9uZW50QnlEYXRhKEpTT04uc3RyaW5naWZ5KGNvbXApKTt9CmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgZT0+ZS5wcmV2ZW50RGVmYXVsdCgpKTsKY29uc3QgYWxsQ29tcG9uZW50cz0je0NPTVBPTkVOVFMudG9fanNvbn07CmZ1bmN0aW9uIHJlbmRlcihjKXtsZXQgaD0iIjtjLmZvckVhY2goeD0+e2grPWA8ZGl2IGNsYXNzPSJjYXJkIj48aW1nIGNsYXNzPSJjb21wb25lbnQtaW1nIiBzcmM9IiR7eC5pbWFnZX0iIC8+PGg0PiR7eC5uYW1lfTwvaDQ+PHA+JHt4LmRlc2N9PC9wPjxidXR0b24gb25jbGljaz0nbG9hZENvbXBvbmVudCgke0pTT04uc3RyaW5naWZ5KHgpfSknPtil2K/Ysdin2Kw8L2J1dHRvbj48L2Rpdj5gfSk7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNvbXBvbmVudHMiKS5pbm5lckhUTUw9aDt9CmZ1bmN0aW9uIGZpbHRlckNvbXBvbmVudHMoKXtjb25zdCBjYXQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImNhdGVnb3J5IikudmFsdWU7aWYoY2F0PT09ImFsbCIpcmVuZGVyKGFsbENvbXBvbmVudHMpO2Vsc2UgcmVuZGVyKGFsbENvbXBvbmVudHMuZmlsdGVyKGM9PmMuY2F0ZWdvcnk9PT1jYXQpKTt9CmZ1bmN0aW9uIHRvZ2dsZU1lbnUoKXtjb25zdCBiPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXItYm94Iik7Yi5zdHlsZS5kaXNwbGF5PShiLnN0eWxlLmRpc3BsYXk9PT0iYmxvY2siKT8ibm9uZSI6ImJsb2NrIjt9CndpbmRvdy5vbmxvYWQ9KCk9PmZpbHRlckNvbXBvbmVudHMoKTsKICAgICAgPC9zY3JpcHQ+CiAgICA8L2JvZHk+PC9odG1sPgogICAgSFRNTAoKICAgIGRsZy5zZXRfaHRtbChodG1sKQoKZGxnLmFkZF9hY3Rpb25fY2FsbGJhY2soImxvYWRDb21wb25lbnRCeURhdGEiKSBkbyB8XywgY29tcF9qc29ufAogIGNvbXAgPSBKU09OLnBhcnNlKGNvbXBfanNvbiwgc3ltYm9saXplX25hbWVzOiB0cnVlKQogIHVybCA9IFVSSS5wYXJzZShjb21wWzp1cmxdKQogIGhhc2hfbmFtZSA9IERpZ2VzdDo6U0hBMjU2LmhleGRpZ2VzdCh1cmwudG9fcylbMC4uMTZdICsgIi5za3AiCiAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICBGaWxlVXRpbHMubWtkaXJfcChjYWNoZV9kaXIpCiAgbG9jYWxfcGF0aCA9IEZpbGUuam9pbihjYWNoZV9kaXIsIGhhc2hfbmFtZSkKCiAgdW5sZXNzIEZpbGUuZXhpc3Q/KGxvY2FsX3BhdGgpCiAgICBwcm9ncmVzcyA9IFVJOjpIdG1sRGlhbG9nLm5ldyh7CiAgICAgIDpkaWFsb2dfdGl0bGUgPT4gItiq2K3ZhdmK2YQg2KfZhNmF2YPZiNmGLi4uIiwKICAgICAgOnByZWZlcmVuY2VzX2tleSA9PiAibWhkZXNpZ25fcHJvZ3Jlc3MiLAogICAgICA6c2Nyb2xsYWJsZSA9PiBmYWxzZSwKICAgICAgOnJlc2l6YWJsZSA9PiBmYWxzZSwKICAgICAgOndpZHRoID0+IDMwMCwKICAgICAgOmhlaWdodCA9PiAxNTAKICAgIH0pCgogICAgcHJvZ3Jlc3Muc2V0X2h0bWwgPDwtSFRNTAogICAgICA8aHRtbD48aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICAgICAgPHN0eWxlPgogICAgICAgICAgYm9keSB7IGZvbnQtZmFtaWx5OiAnVGFqYXdhbCcsIHNhbnMtc2VyaWY7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAwOyBwYWRkaW5nOiAyMHB4OyBkaXJlY3Rpb246IHJ0bDsgfQogICAgICAgICAgaDMgeyBtYXJnaW46IDEwcHggMDsgfQogICAgICAgICAgI3Byb2dyZXNzLWJhciB7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDIwcHg7IGJhY2tncm91bmQ6ICNkZGQ7IGJvcmRlci1yYWRpdXM6IDEwcHg7IG92ZXJmbG93OiBoaWRkZW47IG1hcmdpbi10b3A6IDEwcHg7IH0KICAgICAgICAgICNwcm9ncmVzcy1maWxsIHsgaGVpZ2h0OiAxMDAlOyB3aWR0aDogMCU7IGJhY2tncm91bmQ6ICM0Y2FmNTA7IHRyYW5zaXRpb246IHdpZHRoIDAuMnMgZWFzZTsgfQogICAgICAgICAgI3BlcmNlbnQgeyBtYXJnaW4tdG9wOiA4cHg7IGZvbnQtc2l6ZTogMTRweDsgfQogICAgICAgIDwvc3R5bGU+CiAgICAgIDwvaGVhZD48Ym9keT4KICAgICAgICA8aDM+2KzYp9ix2Yog2KrYrdmF2YrZhCDYp9mE2YXZg9mI2YYuLi48L2gzPgogICAgICAgIDxkaXYgaWQ9InByb2dyZXNzLWJhciI+PGRpdiBpZD0icHJvZ3Jlc3MtZmlsbCI+PC9kaXY+PC9kaXY+CiAgICAgICAgPGRpdiBpZD0icGVyY2VudCI+MCU8L2Rpdj4KICAgICAgPC9ib2R5PjwvaHRtbD4KICAgIEhUTUwKCiAgICBwcm9ncmVzcy5zaG93CgogICAgVUkuc3RhcnRfdGltZXIoMC4zLCBmYWxzZSkgZG8KICAgICAgYmVnaW4KICAgICAgICBjb250ZW50X2xlbmd0aCA9IG5pbAogICAgICAgIHRlbXBmaWxlID0gVGVtcGZpbGUubmV3KCJtaGNvbXBvbmVudCIpCgogICAgICAgIFVSSS5vcGVuKHVybCwKICAgICAgICAgIGNvbnRlbnRfbGVuZ3RoX3Byb2M6IC0+KGxlbikgeyBjb250ZW50X2xlbmd0aCA9IGxlbiB9LAogICAgICAgICAgcHJvZ3Jlc3NfcHJvYzogLT4oYnl0ZXMpIHsKICAgICAgICAgICAgcGVyY2VudCA9IGNvbnRlbnRfbGVuZ3RoID8gKChieXRlcy50b19mIC8gY29udGVudF9sZW5ndGgpICogMTAwKS50b19pIDogMAogICAgICAgICAgICBwcm9ncmVzcy5leGVjdXRlX3NjcmlwdCgiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dyZXNzLWZpbGwnKS5zdHlsZS53aWR0aCA9ICcje3BlcmNlbnR9JSciKQogICAgICAgICAgICBwcm9ncmVzcy5leGVjdXRlX3NjcmlwdCgiZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlcmNlbnQnKS5pbm5lclRleHQgPSAnI3twZXJjZW50fSUnIikKICAgICAgICAgIH0KICAgICAgICApIGRvIHxyZW1vdGVfZmlsZXwKICAgICAgICAgIElPLmNvcHlfc3RyZWFtKHJlbW90ZV9maWxlLCB0ZW1wZmlsZSkKICAgICAgICBlbmQKCiAgICAgICAgdGVtcGZpbGUuY2xvc2UKICAgICAgICBGaWxlVXRpbHMubXYodGVtcGZpbGUucGF0aCwgbG9jYWxfcGF0aCkKICAgICAgICBwcm9ncmVzcy5jbG9zZSBpZiBwcm9ncmVzcy52aXNpYmxlPwoKICAgICAgICBpZiBGaWxlLmV4aXN0Pyhsb2NhbF9wYXRoKSAmJiBGaWxlLnNpemUobG9jYWxfcGF0aCkgPiAwCiAgICAgICAgICBkZWZpbml0aW9uID0gU2tldGNodXAuYWN0aXZlX21vZGVsLmRlZmluaXRpb25zLmxvYWQobG9jYWxfcGF0aCwgYWxsb3dfbmV3ZXI6IHRydWUpCiAgICAgICAgICBpZiBkZWZpbml0aW9uCiAgICAgICAgICAgIGluc3RhbmNlID0gU2tldGNodXAuYWN0aXZlX21vZGVsLnBsYWNlX2NvbXBvbmVudChkZWZpbml0aW9uKQogICAgICAgICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYpdiv2LHYp9isINin2YTZhdmD2YjZhiDYqNmG2KzYp9itIikgdW5sZXNzIGluc3RhbmNlCiAgICAgICAgICBlbHNlCiAgICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKaoO+4jyDZhNmFINmK2KrZhSDYqti52LHZitmBINin2YTZhdmD2YjZhiIpCiAgICAgICAgICBlbmQKICAgICAgICBlbHNlCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqDvuI8g2YTZhSDZitiq2YUg2K3Zgdi4INin2YTZhdmE2YEg2KjYtNmD2YQg2LXYrdmK2K0iKQogICAgICAgIGVuZAoKICAgICAgcmVzY3VlID0+IGUKICAgICAgICB0ZW1wZmlsZS5jbG9zZSBpZiB0ZW1wZmlsZQogICAgICAgIHRlbXBmaWxlLnVubGluayBpZiB0ZW1wZmlsZQogICAgICAgIHByb2dyZXNzLmNsb3NlIGlmIHByb2dyZXNzLnZpc2libGU/CiAgICAgICAgVUkubWVzc2FnZWJveCgi4p2MINiu2LfYoyDZgdmKINin2YTYqtit2YXZitmEINij2Ygg2KfZhNil2K/Ysdin2Kw6ICN7ZS5tZXNzYWdlfSIpCiAgICAgIGVuZAogICAgZW5kCiAgZWxzZQogICAgYmVnaW4KICAgICAgaWYgRmlsZS5leGlzdD8obG9jYWxfcGF0aCkgJiYgRmlsZS5zaXplKGxvY2FsX3BhdGgpID4gMAogICAgICAgIGRlZmluaXRpb24gPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwuZGVmaW5pdGlvbnMubG9hZChsb2NhbF9wYXRoLCBhbGxvd19uZXdlcjogdHJ1ZSkKICAgICAgICBpZiBkZWZpbml0aW9uCiAgICAgICAgICBpbnN0YW5jZSA9IFNrZXRjaHVwLmFjdGl2ZV9tb2RlbC5wbGFjZV9jb21wb25lbnQoZGVmaW5pdGlvbikKICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINil2K/Ysdin2Kwg2KfZhNmF2YPZiNmGINio2YbYrNin2K0iKSB1bmxlc3MgaW5zdGFuY2UKICAgICAgICBlbHNlCiAgICAgICAgICBVSS5tZXNzYWdlYm94KCLimqDvuI8g2YTZhSDZitiq2YUg2KrYudix2YrZgSDYp9mE2YXZg9mI2YYiKQogICAgICAgIGVuZAogICAgICBlbHNlCiAgICAgICAgVUkubWVzc2FnZWJveCgi4pqg77iPINin2YTZhdmE2YEg2KfZhNmF2YjYrNmI2K8g2KrYp9mE2YEg2KPZiCDZgdin2LHYuiIpCiAgICAgIGVuZAogICAgcmVzY3VlID0+IGUKICAgICAgVUkubWVzc2FnZWJveCgi4p2MINiu2LfYoyDYo9ir2YbYp9ihINin2YTYpdiv2LHYp9isOiAje2UubWVzc2FnZX0iKQogICAgZW5kCiAgZW5kCmVuZAoKZGxnLmFkZF9hY3Rpb25fY2FsbGJhY2soImNsZWFyQ29tcG9uZW50Q2FjaGUiKSBkbyB8X3wKICBiZWdpbgogICAgY2FjaGVfZGlyID0gRmlsZS5qb2luKERpci50bXBkaXIsICJtaGRlc2lnbl9jYWNoZV8xIikKICAgIGlmIEZpbGUuZGlyZWN0b3J5PyhjYWNoZV9kaXIpCiAgICAgIEZpbGVVdGlscy5ybV9yZihjYWNoZV9kaXIpCiAgICBlbmQKICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINin2YTYqtit2K/ZitirINio2YbYrNin2K0uIikKICByZXNjdWUgPT4gZQogICAgVUkubWVzc2FnZWJveCgi4p2MINmB2LTZhCDYrdiw2YEg2KfZhNmF2YTZgdin2Kog2KfZhNmF2KTZgtiq2Kk6ICN7ZS5tZXNzYWdlfSIpCiAgZW5kCmVuZApkbGcuc2hvdwogIGVuZAoKICB1bmxlc3MgZmlsZV9sb2FkZWQ/KF9fRklMRV9fKQogICAgVUkubWVudSgiUGx1Z2lucyIpLmFkZF9pdGVtKCIje1BMVUdJTl9OQU1FfSAtINiq2YHYudmK2YQiKSB7IGFjdGl2YXRlKHRydWUpIH0KICAgIFVJLm1lbnUoIlBsdWdpbnMiKS5hZGRfaXRlbSgiI3tQTFVHSU5fTkFNRX0gLSDYsdmC2YUg2KfZhNis2YfYp9iyIikgeyBVSS5tZXNzYWdlYm94KCLwn5SRINix2YLZhSDYp9mE2KzZh9in2LI6XG4iICsgZ2V0X2RldmljZV9pZCkgfQogICAgVUkubWVudSgiUGx1Z2lucyIpLmFkZF9pdGVtKCJNSERFU0lHTiAtINiq2K3Yr9mK2Ksg2KfZhNmF2YPYqtio2KkiKSBkbwogICAgICBjYWNoZV9kaXIgPSBGaWxlLmpvaW4oRGlyLnRtcGRpciwgIm1oZGVzaWduX2NhY2hlXzEiKQogICAgICBpZiBGaWxlLmRpcmVjdG9yeT8oY2FjaGVfZGlyKQogICAgICAgIEZpbGVVdGlscy5ybV9yZihjYWNoZV9kaXIpCiAgICAgIGVuZAogICAgICBVSS5tZXNzYWdlYm94KCLinIUg2KrZhSDYp9mE2KrYrdiv2YrYqyDYqNmG2KzYp9itLiIpCiAgICBlbmQKCiAgICB0b29sYmFyID0gVUk6OlRvb2xiYXIubmV3KFBMVUdJTl9OQU1FKQogICAgY21kID0gVUk6OkNvbW1hbmQubmV3KCLZhdmD2KrYqNipICN7UExVR0lOX05BTUV9IikgeyBzaG93X2xpYnJhcnkgfQoKICAgIGljb25fcGF0aCA9IEZpbGUuam9pbihQTFVHSU5fRElSLCAiaWNvbi5wbmciKSByZXNjdWUgbmlsCiAgICBpZiBGaWxlLmV4aXN0PyhpY29uX3BhdGgpCiAgICAgIGNtZC5zbWFsbF9pY29uID0gaWNvbl9wYXRoCiAgICAgIGNtZC5sYXJnZV9pY29uID0gaWNvbl9wYXRoCiAgICBlbmQKICAgIGNtZC50b29sdGlwID0gItiq2LTYutmK2YQg2YXZg9iq2KjYqSBNSERFU0lHTiIKICAgIHRvb2xiYXIuYWRkX2l0ZW0oY21kKQoKICAgIGNtZF91bmlxdWUgPSBVSTo6Q29tbWFuZC5uZXcoItis2LnZhCDZg9mEINin2YTZhdmD2YjZhtin2Kog2YHYsdmK2K/YqSIpIHsKICAgICAgbW9kdWxlIE1IREVTSUdOX1VOSVFVSUZZCiAgICAgICAgZGVmIHNlbGYubWFrZV9hbGxfY29tcG9uZW50c191bmlxdWUoZW50aXRpZXMpCiAgICAgICAgICBlbnRpdGllcy5ncmVwKFNrZXRjaHVwOjpDb21wb25lbnRJbnN0YW5jZSkuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgICAgIGluc3RhbmNlLm1ha2VfdW5pcXVlCiAgICAgICAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKGluc3RhbmNlLmRlZmluaXRpb24uZW50aXRpZXMpCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBkZWYgc2VsZi5tYWtlX2RlZmluaXRpb25zX3VuaXF1ZQogICAgICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgICAgIG1vZGVsLmRlZmluaXRpb25zLmVhY2ggZG8gfGRlZmluaXRpb258CiAgICAgICAgICAgIG5leHQgaWYgZGVmaW5pdGlvbi5ncm91cD8gfHwgZGVmaW5pdGlvbi5pbWFnZT8KICAgICAgICAgICAgZGVmaW5pdGlvbi5pbnN0YW5jZXMuZWFjaCBkbyB8aW5zdGFuY2V8CiAgICAgICAgICAgICAgaW5zdGFuY2UubWFrZV91bmlxdWUKICAgICAgICAgICAgICBtYWtlX2FsbF9jb21wb25lbnRzX3VuaXF1ZShpbnN0YW5jZS5kZWZpbml0aW9uLmVudGl0aWVzKQogICAgICAgICAgICBlbmQKICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgICAgIGRlZiBzZWxmLnJ1bl91bmlxdWlmeQogICAgICAgICAgbW9kZWwgPSBTa2V0Y2h1cC5hY3RpdmVfbW9kZWwKICAgICAgICAgIG1vZGVsLnN0YXJ0X29wZXJhdGlvbigi2KzYudmEINmD2YQg2KfZhNmF2YPZiNmG2KfYqiDZgdix2YrYr9ipIiwgdHJ1ZSkKICAgICAgICAgIG1ha2VfYWxsX2NvbXBvbmVudHNfdW5pcXVlKG1vZGVsLmVudGl0aWVzKQogICAgICAgICAgbWFrZV9kZWZpbml0aW9uc191bmlxdWUKICAgICAgICAgIG1vZGVsLmNvbW1pdF9vcGVyYXRpb24KICAgICAgICAgIFVJLm1lc3NhZ2Vib3goIuKchSDYqtmFINis2LnZhCDZg9mEINin2YTZg9mF2KjZiNmG2YbYqtin2Kog2YHYsdmK2K/YqS4iKQogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgTUhERVNJR05fVU5JUVVJRlkucnVuX3VuaXF1aWZ5CiAgICB9CiAgICB1bmlxdWVfaWNvbl9wYXRoID0gRmlsZS5qb2luKFBMVUdJTl9ESVIsICJ1bmlxdWVfaWNvbi5wbmciKSByZXNjdWUgbmlsCiAgICBpZiBGaWxlLmV4aXN0Pyh1bmlxdWVfaWNvbl9wYXRoKQogICAgICBjbWRfdW5pcXVlLnNtYWxsX2ljb24gPSB1bmlxdWVfaWNvbl9wYXRoCiAgICAgIGNtZF91bmlxdWUubGFyZ2VfaWNvbiA9IHVuaXF1ZV9pY29uX3BhdGgKICAgIGVuZAogICAgY21kX3VuaXF1ZS50b29sdGlwID0gItin2KzYudmEINin2YTZhdmD2YjZhtin2Kog2KfZhNmB2LHYudmK2Kkg2YHYsdmK2K/YqSIKICAgIHRvb2xiYXIuYWRkX2l0ZW0oY21kX3VuaXF1ZSkKCiAgICB0b29sYmFyLnJlc3RvcmUKICAgIGZpbGVfbG9hZGVkKF9fRklMRV9fKQogIGVuZAplbmQ="
}
